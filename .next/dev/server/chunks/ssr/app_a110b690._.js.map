{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/components/PaymentWorkspace.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport {\n  CreditCard,\n  DollarSign,\n  Smartphone,\n  Calculator,\n  Check,\n  X,\n  Percent,\n  Users,\n  ArrowLeft,\n  Trash2,\n  CheckCircle2,\n  Receipt,\n  Banknote,\n  Wallet,\n  Clock\n} from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport toast from 'react-hot-toast';\n\ninterface PaymentWorkspaceProps {\n  mode?: 'embedded' | 'modal';\n  groupedItems: any[];\n  calculateSubtotal: () => number;\n  calculateTotal: () => number;\n  calculateTotalWithDiscount: () => number;\n  serviceTaxPercentage: number;\n  serviceTaxValue: number;\n  discountType: 'percentage' | 'value';\n  setDiscountType: (type: 'percentage' | 'value') => void;\n  discountValue: number;\n  setDiscountValue: (value: number) => void;\n  splitCount: number;\n  setSplitCount: (count: number) => void;\n  calculatorDisplay: string;\n  setCalculatorDisplay: (value: string | ((prev: string) => string)) => void;\n  payments: any[];\n  addPayment: (payment: any) => void;\n  removePayment: (id: string) => void;\n  handleCompletePayment: () => void;\n  reopenTable?: () => void;\n  selectedTable?: any;\n  loading?: boolean;\n}\n\nexport default function PaymentWorkspace({\n  mode = 'embedded',\n  groupedItems,\n  calculateSubtotal,\n  calculateTotal,\n  calculateTotalWithDiscount,\n  serviceTaxPercentage,\n  serviceTaxValue,\n  discountType,\n  setDiscountType,\n  discountValue,\n  setDiscountValue,\n  splitCount,\n  setSplitCount,\n  calculatorDisplay,\n  setCalculatorDisplay,\n  payments,\n  addPayment,\n  removePayment,\n  handleCompletePayment,\n  reopenTable,\n  selectedTable,\n  loading = false\n}: PaymentWorkspaceProps) {\n  const [selectedPaymentMethod, setSelectedPaymentMethod] = useState<string>('cash');\n  \n  // Função para formatar valores monetários\n  const formatCurrency = (value: number, isRodizioItem: boolean = false) => {\n    if (value === 0 && isRodizioItem) {\n      return 'Incluso';\n    }\n    return new Intl.NumberFormat('pt-BR', {\n      style: 'currency',\n      currency: 'BRL'\n    }).format(value);\n  };\n  \n  const totalWithDiscount = calculateTotalWithDiscount();\n  const totalPaid = payments.reduce((sum, p) => sum + p.amount, 0);\n  const remaining = Math.max(0, totalWithDiscount - totalPaid);\n  const perPersonAmount = totalWithDiscount / splitCount;\n\n  // Função para processar entrada da calculadora\n  const handleCalculatorInput = (value: string) => {\n    if (value === 'C') {\n      setCalculatorDisplay('0');\n    } else if (value === '⌫') {\n      setCalculatorDisplay(prev => prev.length > 1 ? prev.slice(0, -1) : '0');\n    } else if (value === '.') {\n      if (!calculatorDisplay.includes('.')) {\n        setCalculatorDisplay(prev => prev + '.');\n      }\n    } else {\n      setCalculatorDisplay(prev => prev === '0' ? value : prev + value);\n    }\n  };\n\n  // Função para adicionar pagamento\n  const handleAddPayment = () => {\n    const amount = parseFloat(calculatorDisplay) || 0;\n    if (amount <= 0) {\n      toast.error('Digite um valor válido');\n      return;\n    }\n\n    if (amount > remaining + 0.01) {\n      toast.error('Valor excede o restante a pagar');\n      return;\n    }\n\n    addPayment({\n      id: Date.now().toString(),\n      method: selectedPaymentMethod,\n      amount: amount,\n      timestamp: new Date()\n    });\n\n    setCalculatorDisplay('0');\n    \n    if (amount >= remaining - 0.01) {\n      toast.success('Pagamento completo! Clique em Finalizar.');\n    }\n  };\n\n  const paymentMethods = [\n    { id: 'cash', name: 'Dinheiro', icon: Banknote, color: 'bg-green-500' },\n    { id: 'credit', name: 'Crédito', icon: CreditCard, color: 'bg-blue-500' },\n    { id: 'debit', name: 'Débito', icon: CreditCard, color: 'bg-purple-500' },\n    { id: 'pix', name: 'PIX', icon: Smartphone, color: 'bg-orange-500' }\n  ];\n\n  return (\n    <div className=\"h-full flex flex-col bg-gray-900\">\n      {/* Header com Totais - Fixo no topo */}\n      <div className=\"bg-gradient-to-r from-orange-600 to-orange-500 p-3 rounded-t-lg\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <Receipt className=\"h-5 w-5 text-white\" />\n            <h2 className=\"text-lg font-bold text-white\">Mesa {selectedTable?.number}</h2>\n          </div>\n          \n          {/* Totais principais */}\n          <div className=\"flex items-center gap-6 text-white\">\n            <div className=\"text-right\">\n              <p className=\"text-xs opacity-80\">Total</p>\n              <p className=\"font-bold\">{formatCurrency(totalWithDiscount)}</p>\n            </div>\n            <div className=\"text-right\">\n              <p className=\"text-xs opacity-80\">Pago</p>\n              <p className=\"font-bold text-green-300\">{formatCurrency(totalPaid)}</p>\n            </div>\n            <div className=\"text-right\">\n              <p className=\"text-xs opacity-80\">Restante</p>\n              <p className=\"font-bold text-yellow-300\">{formatCurrency(remaining)}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Grid de 3 colunas */}\n      <div className=\"flex-1 grid grid-cols-[1.4fr_0.8fr_0.8fr] gap-4 p-4 overflow-hidden\">\n        \n        {/* Coluna Esquerda - Resumo dos Itens */}\n        <div className=\"flex flex-col h-full\">\n          <Card className=\"bg-gray-800 border-gray-700 flex flex-col rounded-lg\" style={{ maxHeight: 'calc(100vh - 250px)' }}>\n            <CardHeader className=\"py-3 flex-shrink-0\">\n              <CardTitle className=\"text-sm flex items-center justify-between\">\n                <span>Itens da Conta</span>\n                <span className=\"text-orange-400\">{groupedItems.length} itens</span>\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"py-2 overflow-hidden\" style={{ height: 'calc(100vh - 320px)' }}>\n              <ScrollArea className=\"h-full pr-2\">\n                <div className=\"space-y-1 pr-1\">\n                  {groupedItems.map((item, idx) => (\n                    <div \n                      key={idx} \n                      className={`flex justify-between items-center py-1 px-2 rounded transition-colors ${\n                        item.status === 'cancelled' \n                          ? 'bg-red-900/30 border border-red-800/50 opacity-75' \n                          : 'bg-gray-700/50 hover:bg-gray-700/70'\n                      }`}\n                    >\n                      <div className=\"flex-1\">\n                        <div className={`font-medium text-sm ${\n                          item.status === 'cancelled' ? 'text-red-400 line-through' : 'text-white'\n                        }`}>\n                          {item.item?.name || 'Produto'}\n                        </div>\n                        <div className=\"text-xs text-gray-400\">\n                          {formatCurrency(item.unit_price, true)} × {item.quantity}\n                          {item.status === 'cancelled' && (\n                            <span className=\"ml-2 text-red-400\">(Cancelado)</span>\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <div className={`font-bold text-sm ${\n                          item.status === 'cancelled' ? 'text-red-400 line-through' : 'text-orange-400'\n                        }`}>\n                          {formatCurrency(item.total_price, true)}\n                        </div>\n                        {item.launched_at && (\n                          <div className={`text-[10px] ${\n                            item.status === 'cancelled' ? 'text-red-400' : 'text-green-400'\n                          } opacity-70`}>\n                            {(() => {\n                              const date = new Date(item.launched_at);\n                              const hours = date.getHours().toString().padStart(2, '0');\n                              const minutes = date.getMinutes().toString().padStart(2, '0');\n                              const seconds = date.getSeconds().toString().padStart(2, '0');\n                              return `${hours}:${minutes}:${seconds}`;\n                            })()}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </ScrollArea>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Coluna Central - Ajustes e Calculadora */}\n        <div className=\"flex flex-col gap-3\">\n          {/* Desconto e Divisão */}\n          <Card className=\"bg-gray-800 border-gray-700 rounded-lg\">\n            <CardContent className=\"py-3\">\n              <div className=\"space-y-3\">\n                {/* Desconto */}\n                <div>\n                  <Label className=\"text-xs text-gray-400\">Desconto</Label>\n                  <div className=\"flex gap-1 mt-1\">\n                    <Button\n                      size=\"sm\"\n                      onClick={() => setDiscountType('percentage')}\n                      className={cn(\n                        \"h-7 px-2\",\n                        discountType === 'percentage' ? \"bg-orange-600\" : \"bg-gray-700\"\n                      )}\n                    >\n                      %\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      onClick={() => setDiscountType('value')}\n                      className={cn(\n                        \"h-7 px-2\",\n                        discountType === 'value' ? \"bg-orange-600\" : \"bg-gray-700\"\n                      )}\n                    >\n                      R$\n                    </Button>\n                    <Input\n                      type=\"number\"\n                      value={discountValue}\n                      onChange={(e) => setDiscountValue(parseFloat(e.target.value) || 0)}\n                      className=\"h-7 flex-1 bg-gray-700 border-gray-600 text-white text-sm\"\n                      placeholder=\"0\"\n                    />\n                  </div>\n                  {discountValue > 0 && (\n                    <p className=\"text-xs text-green-400 mt-1\">\n                      Desconto: {formatCurrency(\n                        discountType === 'percentage'\n                          ? (calculateTotal() * discountValue / 100)\n                          : discountValue\n                      )}\n                    </p>\n                  )}\n                </div>\n\n                {/* Divisão */}\n                <div>\n                  <Label className=\"text-xs text-gray-400\">Dividir em</Label>\n                  <div className=\"flex items-center gap-2 mt-1\">\n                    <Input\n                      type=\"number\"\n                      min=\"1\"\n                      value={splitCount}\n                      onChange={(e) => setSplitCount(Math.max(1, parseInt(e.target.value) || 1))}\n                      className=\"h-7 w-20 bg-gray-700 border-gray-600 text-white text-sm\"\n                    />\n                    <span className=\"text-xs text-gray-400\">pessoas</span>\n                    {splitCount > 1 && (\n                      <span className=\"text-xs text-orange-400 ml-auto\">\n                        {formatCurrency(perPersonAmount)} cada\n                      </span>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Calculadora */}\n          <Card className=\"bg-gray-800 border-gray-700 flex-1\">\n            <CardHeader className=\"py-2\">\n              <CardTitle className=\"text-sm\">Calculadora</CardTitle>\n            </CardHeader>\n            <CardContent className=\"py-2\">\n              {/* Display */}\n              <div className=\"bg-black rounded p-2 mb-2\">\n                <p className=\"text-xl font-mono text-green-400 text-right\">\n                  R$ {calculatorDisplay}\n                </p>\n              </div>\n\n              {/* Valores Rápidos */}\n              <div className=\"grid grid-cols-3 gap-1 mb-2\">\n                <Button\n                  size=\"sm\"\n                  onClick={() => setCalculatorDisplay(remaining.toFixed(2))}\n                  className=\"h-7 text-xs bg-gray-700 hover:bg-gray-600\"\n                  disabled={remaining <= 0}\n                >\n                  Restante\n                </Button>\n                <Button\n                  size=\"sm\"\n                  onClick={() => setCalculatorDisplay('50.00')}\n                  className=\"h-7 text-xs bg-gray-700 hover:bg-gray-600\"\n                >\n                  R$ 50\n                </Button>\n                <Button\n                  size=\"sm\"\n                  onClick={() => setCalculatorDisplay('100.00')}\n                  className=\"h-7 text-xs bg-gray-700 hover:bg-gray-600\"\n                >\n                  R$ 100\n                </Button>\n              </div>\n\n              {/* Teclado Numérico */}\n              <div className=\"grid grid-cols-3 gap-1\">\n                {['7', '8', '9', '4', '5', '6', '1', '2', '3', '0', '.', '⌫'].map((btn) => (\n                  <Button\n                    key={btn}\n                    size=\"sm\"\n                    onClick={() => handleCalculatorInput(btn)}\n                    className={cn(\n                      \"h-8 text-sm font-bold\",\n                      btn === '⌫' ? \"bg-red-600 hover:bg-red-700\" : \"bg-gray-700 hover:bg-gray-600\"\n                    )}\n                  >\n                    {btn}\n                  </Button>\n                ))}\n              </div>\n\n              {/* Limpar */}\n              <Button\n                size=\"sm\"\n                onClick={() => handleCalculatorInput('C')}\n                className=\"w-full h-7 mt-1 bg-gray-700 hover:bg-gray-600 text-xs\"\n              >\n                Limpar\n              </Button>\n            </CardContent>\n          </Card>\n\n          {/* Métodos de Pagamento */}\n          <div className=\"grid grid-cols-2 gap-1\">\n            {paymentMethods.map((method) => {\n              const Icon = method.icon;\n              return (\n                <Button\n                  key={method.id}\n                  size=\"sm\"\n                  onClick={() => setSelectedPaymentMethod(method.id)}\n                  className={cn(\n                    \"h-10 flex flex-col gap-0 py-1\",\n                    selectedPaymentMethod === method.id\n                      ? method.color\n                      : \"bg-gray-700 hover:bg-gray-600\"\n                  )}\n                >\n                  <Icon className=\"h-4 w-4\" />\n                  <span className=\"text-xs\">{method.name}</span>\n                </Button>\n              );\n            })}\n          </div>\n\n          {/* Botão Adicionar Pagamento */}\n          <Button\n            onClick={handleAddPayment}\n            disabled={parseFloat(calculatorDisplay) <= 0 || remaining <= 0}\n            className=\"h-10 bg-green-600 hover:bg-green-700 font-bold\"\n          >\n            <Check className=\"h-4 w-4 mr-1\" />\n            Adicionar Pagamento\n          </Button>\n        </div>\n\n        {/* Coluna Direita - Histórico e Finalizar */}\n        <div className=\"flex flex-col gap-3\">\n          {/* Histórico de Pagamentos */}\n          <Card className=\"bg-gray-800 border-gray-700 flex-1 flex flex-col\">\n            <CardHeader className=\"py-3\">\n              <CardTitle className=\"text-sm\">Pagamentos</CardTitle>\n            </CardHeader>\n            <CardContent className=\"flex-1 py-2 overflow-hidden\">\n              <ScrollArea className=\"h-full pr-2\">\n                <div className=\"space-y-2\">\n                  {payments.length === 0 ? (\n                    <div className=\"text-center py-8\">\n                      <Wallet className=\"h-8 w-8 mx-auto mb-2 text-gray-600\" />\n                      <p className=\"text-xs text-gray-400\">Nenhum pagamento</p>\n                    </div>\n                  ) : (\n                    payments.map((payment) => {\n                      const method = paymentMethods.find(m => m.id === payment.method);\n                      const Icon = method?.icon || Wallet;\n                      \n                      return (\n                        <div\n                          key={payment.id}\n                          className=\"flex items-center justify-between p-2 bg-gray-700 rounded\"\n                        >\n                          <div className=\"flex items-center gap-2\">\n                            <div className={cn(\"p-1.5 rounded\", method?.color || 'bg-gray-600')}>\n                              <Icon className=\"h-3 w-3 text-white\" />\n                            </div>\n                            <div>\n                              <p className=\"text-xs text-white\">{method?.name}</p>\n                              <p className=\"text-xs text-gray-400\">\n                                {formatCurrency(payment.amount)}\n                              </p>\n                            </div>\n                          </div>\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => removePayment(payment.id)}\n                            className=\"h-6 w-6 p-0 text-red-400 hover:bg-red-900/20\"\n                          >\n                            <Trash2 className=\"h-3 w-3\" />\n                          </Button>\n                        </div>\n                      );\n                    })\n                  )}\n                </div>\n              </ScrollArea>\n            </CardContent>\n          </Card>\n\n          {/* Resumo Final */}\n          {payments.length > 0 && (\n            <Card className=\"bg-gray-800 border-gray-700 rounded-lg\">\n              <CardContent className=\"py-3\">\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-gray-400\">Total Pago</span>\n                    <span className=\"font-bold text-green-400\">{formatCurrency(totalPaid)}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-gray-400\">Restante</span>\n                    <span className={cn(\n                      \"font-bold\",\n                      remaining > 0 ? \"text-red-400\" : \"text-green-400\"\n                    )}>\n                      {formatCurrency(remaining)}\n                    </span>\n                  </div>\n                  {remaining <= 0 && totalPaid > totalWithDiscount && (\n                    <div className=\"flex justify-between pt-2 border-t border-gray-600\">\n                      <span className=\"text-gray-400\">Troco</span>\n                      <span className=\"font-bold text-yellow-400\">\n                        {formatCurrency(totalPaid - totalWithDiscount)}\n                      </span>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Botão Finalizar - Sempre visível no final */}\n          <Button\n            onClick={handleCompletePayment}\n            disabled={remaining > 0.01 || loading}\n            className={cn(\n              \"h-12 font-bold text-base\",\n              remaining > 0.01 \n                ? \"bg-gray-600 cursor-not-allowed\" \n                : \"bg-green-600 hover:bg-green-700 animate-pulse\"\n            )}\n          >\n            {loading ? (\n              <>Processando...</>\n            ) : remaining > 0.01 ? (\n              <>\n                <X className=\"h-4 w-4 mr-2\" />\n                Falta {formatCurrency(remaining)}\n              </>\n            ) : (\n              <>\n                <CheckCircle2 className=\"h-5 w-5 mr-2\" />\n                Finalizar Conta\n              </>\n            )}\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1046, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/pos/page.tsx"],"sourcesContent":["\"use client\";\n\n// Funções utilitárias para cálculos decimais precisos\nconst toDecimal = (value: number): number => {\n  return Math.round(value * 100) / 100;\n};\n\nconst calculateItemTotal = (quantity: number, price: number): number => {\n  return toDecimal(quantity * price);\n};\n\nconst sumTotals = (values: number[]): number => {\n  const sum = values.reduce((acc, val) => acc + val * 100, 0);\n  return sum / 100;\n};\n\nimport { useState, useEffect, useRef, useCallback, useMemo } from \"react\";\nimport { createPortal } from 'react-dom';\nimport { createClient } from \"@/lib/supabase/client\";\nimport { getIconByName } from \"@/lib/menu-icons-library\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { \n  Dialog, \n  DialogContent, \n  DialogHeader, \n  DialogTitle, \n  DialogFooter,\n  DialogDescription\n} from \"@/components/ui/dialog\";\nimport { toast } from \"sonner\";\nimport { \n  Home,\n  ShoppingCart,\n  X,\n  Check,\n  ArrowLeft,\n  CreditCard,\n  DollarSign,\n  Smartphone,\n  Users,\n  User,\n  Plus,\n  Minus,\n  Receipt,\n  Clock,\n  AlertCircle,\n  RefreshCw,\n  Search,\n  Coffee,\n  Pizza,\n  Beef,\n  Fish,\n  Salad,\n  IceCream,\n  Wine,\n  Beer,\n  Package,\n  TrendingUp,\n  History,\n  Printer,\n  FileText,\n  Settings,\n  ChevronRight,\n  ChevronLeft,\n  ChevronUp,\n  ChevronDown,\n  Zap,\n  Star,\n  ShoppingBag,\n  Calculator,\n  Keyboard,\n  UtensilsCrossed,\n  Armchair,\n  Soup,\n  Send,\n  CheckCircle2,\n  XCircle,\n  ArrowRight\n} from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { ptBR } from \"date-fns/locale\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport PaymentWorkspace from \"@/app/components/PaymentWorkspace\";\n\nconst supabase = createClient();\n\n// Types\ninterface Group {\n  id: number;\n  name: string;\n  price: number | null;\n  half_price: number | null;\n  type: 'rodizio' | 'a_la_carte' | 'bebidas';\n  active: boolean;\n  sort_order: number;\n  icon?: string | null;\n}\n\ninterface Category {\n  id: number;\n  name: string;\n  active: boolean;\n  sort_order: number;\n  group_id: number | null;\n  icon?: string;\n}\n\ninterface Item {\n  id: number;\n  name: string;\n  description?: string | null;\n  price: number | null;\n  category_id: number;\n  group_id: number;\n  category?: Category;\n  group?: Group;\n  available: boolean;\n  active: boolean;\n  image?: string | null;\n  icon?: string | null;\n}\n\ninterface RestaurantTable {\n  id: number;\n  number: string;\n  capacity: number;\n  type: 'table' | 'counter';\n  status: 'available' | 'occupied' | 'reserved' | 'cleaning' | 'closed';\n  active: boolean;\n  current_session?: TableSession;\n}\n\ninterface TableSession {\n  id: number;\n  table_id: number;\n  status: 'open' | 'closed';\n  customer_count: number;\n  opened_at: string;\n  closed_at?: string | null;\n  total: number;\n  final_total?: number;\n  notes?: string | null;\n}\n\ninterface Order {\n  id: number;\n  order_number: string;\n  table_id: number | null;\n  session_id?: number;\n  status: 'pending' | 'confirmed' | 'preparing' | 'ready' | 'delivered' | 'completed' | 'cancelled';\n  payment_status: 'pending' | 'partial' | 'paid' | 'refunded';\n  payment_method: 'cash' | 'card' | 'pix' | 'mixed' | null;\n  type: 'dine_in' | 'takeout' | 'delivery';\n  subtotal: number;\n  total: number;\n  items: OrderItem[];\n  created_at?: string;\n}\n\ninterface OrderItem {\n  id?: number;\n  order_id?: number;\n  item_id: number;\n  item?: Item;\n  quantity: number;\n  unit_price: number;\n  total_price: number;\n  notes?: string | null;\n  status: 'pending' | 'preparing' | 'ready' | 'delivered' | 'cancelled';\n  cancelledQuantity?: number;\n  launched_at?: string; // Timestamp do momento do lançamento\n  lineId?: string; // ID único da linha no carrinho\n}\n\ninterface SalesStats {\n  totalSales: number;\n  totalOrders: number;\n  averageTicket: number;\n  topProducts: { name: string; quantity: number; total: number }[];\n}\n\ntype Screen = 'tables' | 'session' | 'payment' | 'history';\n\n// Category Icons Map\nconst categoryIcons: { [key: string]: any } = {\n  'Bebidas': Beer,\n  'Drinks': Beer,\n  'Vinhos': Wine,\n  'Sobremesas': IceCream,\n  'Saladas': Salad,\n  'Carnes': Beef,\n  'Peixes': Fish,\n  'Massas': Pizza,\n  'Lanches': Coffee,\n  'Entradas': Package\n};\n\nexport default function POSPage() {\n  // Estados principais\n  const [screen, setScreen] = useState<Screen>('tables');\n  const [loading, setLoading] = useState(false);\n  const [operationInProgress, setOperationInProgress] = useState<string | null>(null);\n  const [tables, setTables] = useState<RestaurantTable[]>([]);\n  const [items, setItems] = useState<Item[]>([]);\n  const [categories, setCategories] = useState<Category[]>([]);\n  const [searchOpen, setSearchOpen] = useState(false);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedGroup, setSelectedGroup] = useState<number | null>(null);\n  const [selectedCategory, setSelectedCategory] = useState<number | null>(null);\n  const [groups, setGroups] = useState<Group[]>([]);\n  const [todayOrders, setTodayOrders] = useState<Order[]>([]);\n  const [salesStats, setSalesStats] = useState<SalesStats>({\n    totalSales: 0,\n    totalOrders: 0,\n    averageTicket: 0,\n    topProducts: []\n  });\n  \n  // Estado da mesa/sessão atual\n  const [selectedTable, setSelectedTable] = useState<RestaurantTable | null>(null);\n  const [currentSession, setCurrentSession] = useState<TableSession | null>(null);\n  const [currentOrder, setCurrentOrder] = useState<Order | null>(null);\n  const [cart, setCart] = useState<OrderItem[]>([]);\n  const [serviceTaxPercentage, setServiceTaxPercentage] = useState<number>(0);\n  const [filterMode, setFilterMode] = useState<'all' | 'delivered' | 'cancelled'>('all');\n  \n  // Estados do numpad e entrada\n  const [inputValue, setInputValue] = useState(\"\");\n  const [quantity, setQuantity] = useState(\"1\");\n  const [activeInput, setActiveInput] = useState<\"code\" | \"quantity\">(\"code\");\n  \n  // Estados de diálogos\n  const [openTableDialog, setOpenTableDialog] = useState(false);\n  const [customerCount, setCustomerCount] = useState(1);\n  const [paymentDialog, setPaymentDialog] = useState(false);\n  const [paymentMethod, setPaymentMethod] = useState<'cash' | 'card' | 'pix'>('cash');\n  const [closeSessionDialog, setCloseSessionDialog] = useState(false);\n  const [printDialog, setPrintDialog] = useState(false);\n  const [transferTableDialog, setTransferTableDialog] = useState(false);\n  const [targetTableNumber, setTargetTableNumber] = useState('');\n  const [cancelTableDialog, setCancelTableDialog] = useState(false);\n  const [confirmCloseTableDialog, setConfirmCloseTableDialog] = useState(false);\n  \n  // Estados do modal de cancelamento parcial\n  const [cancelQuantityDialog, setCancelQuantityDialog] = useState(false);\n  const [itemToCancel, setItemToCancel] = useState<any>(null);\n  const [cancelQuantity, setCancelQuantity] = useState(1);\n  \n  // Ref para o ScrollArea dos itens do carrinho\n  const cartScrollRef = useRef<HTMLDivElement>(null);\n  const [scrollPosition, setScrollPosition] = useState<'top' | 'middle' | 'bottom'>('top');\n  const previousCartLengthRef = useRef(0);\n  \n  \n  // Removidas funções de scroll automático - os itens mais recentes aparecem em cima\n  \n  // Buscar a taxa de serviço do restaurante\n  useEffect(() => {\n    const fetchServiceTax = async () => {\n      try {\n        const response = await fetch('/api/restaurant');\n        if (response.ok) {\n          const data = await response.json();\n          setServiceTaxPercentage(data.service_tax_percentage || 0);\n        }\n      } catch (error) {\n        console.error('Erro ao buscar taxa de serviço:', error);\n      }\n    };\n    fetchServiceTax();\n  }, []);\n\n  // Monitora posição do scroll para mostrar/ocultar botões (otimizado com requestAnimationFrame)\n  useEffect(() => {\n    const scrollContainer = cartScrollRef.current?.querySelector('[data-radix-scroll-area-viewport]');\n    if (!scrollContainer) return;\n    \n    let ticking = false;\n    const handleScroll = () => {\n      if (!ticking) {\n        window.requestAnimationFrame(() => {\n          const { scrollTop, scrollHeight, clientHeight } = scrollContainer;\n          // Ajustado para ser mais preciso na detecção do final\n          const isAtBottom = scrollTop + clientHeight >= scrollHeight - 10; // Tolerância de 10px\n          const isAtTop = scrollTop <= 5;\n          \n          if (isAtTop) {\n            setScrollPosition('top');\n          } else if (isAtBottom) {\n            setScrollPosition('bottom');\n          } else {\n            setScrollPosition('middle');\n          }\n          ticking = false;\n        });\n        ticking = true;\n      }\n    };\n    \n    // Verificar posição inicial\n    setTimeout(handleScroll, 100);\n    \n    scrollContainer.addEventListener('scroll', handleScroll, { passive: true });\n    return () => scrollContainer.removeEventListener('scroll', handleScroll);\n  }, [cart.length]); // Adicionado cart.length para recalcular quando mudar\n  \n  \n  // Estados do checkout completo\n  const [checkoutDialog, setCheckoutDialog] = useState(false);\n  const [groupedItems, setGroupedItems] = useState<any[]>([]);\n  const [discountType, setDiscountType] = useState<'percentage' | 'value'>('percentage');\n  const [discountValue, setDiscountValue] = useState(0);\n  const [splitCount, setSplitCount] = useState(1);\n  const [payments, setPayments] = useState<any[]>([]);\n  const [calculatorValue, setCalculatorValue] = useState('');\n  const [calculatorDisplay, setCalculatorDisplay] = useState('0');\n  const [activePaymentInput, setActivePaymentInput] = useState<number | null>(null);\n  \n  // Função para agrupar itens do carrinho\n  const groupCartItems = (items: any[]) => {\n    const grouped = new Map();\n    \n    items.forEach(item => {\n      // Incluir todos os itens, inclusive cancelados\n      const key = `${item.item_id}_${item.unit_price}_${item.status}`;\n      \n      if (grouped.has(key)) {\n        const existing = grouped.get(key);\n        existing.quantity += item.quantity;\n        existing.total_price = existing.quantity * existing.unit_price;\n        // Manter o launched_at mais recente\n        if (item.launched_at && (!existing.launched_at || new Date(item.launched_at) > new Date(existing.launched_at))) {\n          existing.launched_at = item.launched_at;\n        }\n      } else {\n        grouped.set(key, {\n          item: item.item,\n          unit_price: item.unit_price,\n          quantity: item.quantity,\n          total_price: item.quantity * item.unit_price,\n          status: item.status, // Adicionar status para identificar cancelados\n          launched_at: item.launched_at // Adicionar horário de lançamento\n        });\n      }\n    });\n    \n    // Ordenar por launched_at, mais recentes primeiro\n    return Array.from(grouped.values()).sort((a, b) => {\n      if (!a.launched_at) return 1;\n      if (!b.launched_at) return -1;\n      return new Date(b.launched_at).getTime() - new Date(a.launched_at).getTime();\n    });\n  };\n  \n  // Atualizar groupedItems sempre que o carrinho mudar ou a mesa estiver fechada\n  useEffect(() => {\n    if (selectedTable?.status === 'closed' && cart.length > 0) {\n      const grouped = groupCartItems(cart);\n      setGroupedItems(grouped);\n    }\n  }, [cart, selectedTable?.status]);\n  \n  // Estado da aba ativa\n  const [activeTab, setActiveTab] = useState<string>('cart');\n  \n  \n  // Estados do modal de rodízio\n  const [rodizioModal, setRodizioModal] = useState(false);\n  const [selectedRodizioGroup, setSelectedRodizioGroup] = useState<any>(null);\n  const [rodizioInteiro, setRodizioInteiro] = useState(0);\n  const [rodizioMeio, setRodizioMeio] = useState(0);\n  \n  // Refs\n  const codeInputRef = useRef<HTMLInputElement>(null);\n\n  // Carregar dados iniciais\n  useEffect(() => {\n    loadInitialData();\n    // Atualizar a cada 30 segundos\n    const interval = setInterval(() => {\n      loadTables();\n      if (screen === 'history') loadTodayOrders();\n    }, 30000);\n    return () => clearInterval(interval);\n  }, [screen]);\n\n  // Atalhos de teclado\n  useEffect(() => {\n    const handleKeyPress = (e: KeyboardEvent) => {\n      // Atalhos globais\n      if (e.key === 'F1') {\n        e.preventDefault();\n        setScreen('tables');\n      } else if (e.key === 'F3' && cart.length > 0) {\n        e.preventDefault();\n        startCheckout();\n      } else if (e.key === 'F4') {\n        e.preventDefault();\n        setPrintDialog(true);\n      } else if (e.key === 'F5') {\n        e.preventDefault();\n        loadInitialData();\n        toast.success('Dados atualizados');\n      } else if (e.key === 'F9') {\n        e.preventDefault();\n        setScreen('history');\n      } else if (e.key === 'Escape') {\n        setSearchOpen(false);\n        setPaymentDialog(false);\n        setPrintDialog(false);\n        setOpenTableDialog(false);\n        setCloseSessionDialog(false);\n        setCheckoutDialog(false);\n      }\n      \n      // Atalhos da sessão\n      if (screen === 'session') {\n        if (e.key === '+' && !e.ctrlKey) {\n          e.preventDefault();\n          setQuantity(prev => (parseInt(prev) + 1).toString());\n        } else if (e.key === '-' && !e.ctrlKey) {\n          e.preventDefault();\n          setQuantity(prev => Math.max(1, parseInt(prev) - 1).toString());\n        }\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyPress);\n    return () => window.removeEventListener('keydown', handleKeyPress);\n  }, [selectedTable, cart, screen]);\n\n  // Focar no input quando voltar para sessão\n  useEffect(() => {\n    if (screen === 'session' && codeInputRef.current) {\n      setTimeout(() => codeInputRef.current?.focus(), 100);\n    }\n  }, [screen]);\n\n  // Função para carregar pedidos existentes de uma mesa\n  const loadExistingOrderItems = async (tableId: string) => {\n    try {\n      console.log('Carregando pedidos existentes para mesa:', tableId);\n      \n      // Buscar pedidos não finalizados da mesa\n      const { data: orders, error: ordersError } = await supabase\n        .from('orders')\n        .select('id, order_number, status, total')\n        .eq('table_id', tableId)\n        .not('status', 'in', '(completed,cancelled)')\n        .order('created_at', { ascending: false })\n        .limit(1)\n        .single();\n\n      if (ordersError) {\n        if (ordersError.code !== 'PGRST116') { // Ignorar se não encontrar pedido\n          console.error('Erro ao buscar pedidos:', ordersError);\n        }\n        return;\n      }\n\n      if (!orders) {\n        console.log('Nenhum pedido aberto encontrado para a mesa');\n        return;\n      }\n\n      console.log('Pedido encontrado:', orders);\n      setCurrentOrder(orders);\n\n      // Buscar itens do pedido - incluindo o status\n      const { data: orderItems, error: itemsError } = await supabase\n        .from('order_items')\n        .select(`\n          *,\n          items:item_id(\n            id,\n            name,\n            price,\n            category_id,\n            group_id,\n            description,\n            image\n          )\n        `)\n        .eq('order_id', orders.id)\n        .order('created_at', { ascending: true });\n\n      if (itemsError) {\n        console.error('Erro ao buscar itens do pedido:', itemsError);\n        toast.error('Erro ao carregar itens do pedido');\n        return;\n      }\n\n      if (orderItems && orderItems.length > 0) {\n        console.log(`Carregando ${orderItems.length} itens do pedido`);\n        \n        // Converter itens do banco para o formato do carrinho\n        const cartItems: OrderItem[] = orderItems.map((orderItem: any) => {\n          // Para rodízios (item_id null)\n          if (!orderItem.item_id && orderItem.metadata) {\n            const metadata = orderItem.metadata as any;\n            return {\n              id: metadata.id || Math.floor(Math.random() * -1000000),\n              order_id: orders.id,\n              item_id: metadata.id || Math.floor(Math.random() * -1000000),\n              item: {\n                id: metadata.id || Math.floor(Math.random() * -1000000),\n                name: metadata.name || 'Rodízio',\n                price: orderItem.unit_price || 0,\n                group_id: metadata.group_id,\n                category_id: metadata.category_id,\n                description: metadata.description,\n                icon: metadata.icon,\n                image: metadata.image\n              },\n              quantity: orderItem.quantity || 1,\n              unit_price: orderItem.unit_price || 0,\n              total_price: (orderItem.unit_price || 0) * (orderItem.quantity || 1),\n              notes: orderItem.observation || '',\n              status: orderItem.status === 'cancelled' ? ('cancelled' as const) : ('delivered' as const), // Manter status do banco\n              launched_at: orderItem.created_at // Usar created_at como horário de lançamento\n            };\n          }\n          \n          // Para itens normais\n          const item = orderItem.items as any;\n          return {\n            id: orderItem.id,\n            order_id: orders.id,\n            item_id: orderItem.item_id || 0,\n            item: item ? {\n              id: item.id,\n              name: item.name || `Item #${orderItem.item_id}`,\n              price: item.price || orderItem.unit_price || 0,\n              group_id: item.group_id,\n              category_id: item.category_id,\n              description: item.description,\n              image: item.image\n            } : {\n              id: orderItem.item_id,\n              name: `Item #${orderItem.item_id}`,\n              price: orderItem.unit_price || 0\n            },\n            quantity: orderItem.quantity || 1,\n            unit_price: orderItem.unit_price || 0,\n            total_price: (orderItem.unit_price || 0) * (orderItem.quantity || 1),\n            notes: orderItem.observation || '',\n            status: orderItem.status === 'cancelled' ? ('cancelled' as const) : ('delivered' as const), // Manter status do banco\n            launched_at: orderItem.created_at // Usar created_at como horário de lançamento\n          };\n        });\n        \n        setCart(cartItems);\n        toast.success(`${cartItems.length} item(ns) carregado(s) do pedido #${orders.order_number}`);\n      } else {\n        console.log('Nenhum item encontrado no pedido');\n        setCart([]); // Limpar carrinho se não há itens\n      }\n    } catch (error) {\n      console.error('Erro ao carregar itens existentes:', error);\n      toast.error('Erro ao carregar pedido existente');\n    }\n  };\n\n  // Funções de carregamento\n  const loadInitialData = async () => {\n    setLoading(true);\n    try {\n      await Promise.all([\n        loadTables(), \n        loadGroups(),\n        loadItems(), \n        loadCategories(),\n        loadTodayOrders()\n      ]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadTables = async () => {\n    try {\n      const { data: tablesData, error } = await supabase\n        .from('restaurant_tables')\n        .select(`\n          *,\n          current_session:table_sessions!table_sessions_table_id_fkey(\n            id,\n            table_id,\n            status,\n            customer_count,\n            opened_at,\n            closed_at,\n            total,\n            final_total\n          )\n        `)\n        .eq('active', true)\n        .order('number');\n\n      if (error) throw error;\n\n      const processedTables = (tablesData || []).map((table: any) => ({\n        ...table,\n        current_session: table.current_session?.find((s: any) => s.status === 'open')\n      }));\n\n      // Ordenação numérica das mesas/balcões\n      processedTables.sort((a: any, b: any) => {\n        const numA = parseInt(a.number) || 0;\n        const numB = parseInt(b.number) || 0;\n        return numA - numB;\n      });\n\n      setTables(processedTables);\n    } catch (error) {\n      console.error('Erro ao carregar mesas:', error);\n      toast.error('Erro ao carregar mesas');\n    }\n  };\n\n  const loadGroups = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('groups')\n        .select('*')\n        .eq('active', true)\n        .order('sort_order');\n\n      if (error) throw error;\n      setGroups(data || []);\n    } catch (error) {\n      console.error('Erro ao carregar grupos:', error);\n      toast.error('Erro ao carregar grupos');\n    }\n  };\n\n  const loadItems = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('items')\n        .select(`\n          *,\n          category:categories(*),\n          group:groups(*)\n        `)\n        .eq('active', true)\n        .eq('available', true)\n        .order('name');\n\n      if (error) throw error;\n      setItems(data || []);\n    } catch (error) {\n      console.error('Erro ao carregar produtos:', error);\n      toast.error('Erro ao carregar produtos');\n    }\n  };\n\n  const loadCategories = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('categories')\n        .select('*')\n        .eq('active', true)\n        .order('sort_order');\n\n      if (error) throw error;\n      setCategories(data || []);\n    } catch (error) {\n      console.error('Erro ao carregar categorias:', error);\n    }\n  };\n\n  const loadTodayOrders = async () => {\n    try {\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      \n      const { data, error } = await supabase\n        .from('orders')\n        .select(`\n          *,\n          items:order_items(\n            *,\n            item:items(*)\n          )\n        `)\n        .gte('created_at', today.toISOString())\n        .order('created_at', { ascending: false });\n\n      if (error) throw error;\n      \n      setTodayOrders(data || []);\n      \n      // Calcular estatísticas\n      if (data) {\n        const stats = calculateSalesStats(data);\n        setSalesStats(stats);\n      }\n    } catch (error) {\n      console.error('Erro ao carregar pedidos:', error);\n    }\n  };\n\n  const calculateSalesStats = (orders: Order[]): SalesStats => {\n    const completedOrders = orders.filter(o => o.payment_status === 'paid');\n    const totalSales = completedOrders.reduce((sum, o) => sum + o.total, 0);\n    const totalOrders = completedOrders.length;\n    const averageTicket = totalOrders > 0 ? totalSales / totalOrders : 0;\n    \n    // Calcular produtos mais vendidos\n    const productMap = new Map<string, { quantity: number; total: number }>();\n    \n    completedOrders.forEach(order => {\n      order.items?.forEach(item => {\n        const name = item.item?.name || `Produto ${item.item_id}`;\n        const existing = productMap.get(name) || { quantity: 0, total: 0 };\n        productMap.set(name, {\n          quantity: existing.quantity + item.quantity,\n          total: existing.total + item.total_price\n        });\n      });\n    });\n    \n    const topProducts = Array.from(productMap.entries())\n      .map(([name, data]) => ({ name, ...data }))\n      .sort((a, b) => b.total - a.total)\n      .slice(0, 5);\n    \n    return {\n      totalSales,\n      totalOrders,\n      averageTicket,\n      topProducts\n    };\n  };\n\n  const loadSessionDetails = async (tableId: number) => {\n    try {\n      const { data: orderData, error } = await supabase\n        .from('orders')\n        .select(`\n          *,\n          items:order_items(\n            *,\n            item:items(*)\n          )\n        `)\n        .eq('table_id', tableId)\n        .eq('status', 'open') // Buscar apenas orders abertos\n        .single();\n\n      if (!error && orderData) {\n        setCurrentOrder(orderData as any);\n        \n        // Transform order items to cart format\n        const cartItems = orderData.items?.map((orderItem: any) => {\n          // Handle rodízio items (no item_id)\n          if (!orderItem.item_id) {\n            // Extract rodízio metadata if available\n            const metadata = orderItem.metadata || {};\n            const rodizioItem = {\n              id: orderItem.id, // Manter ID do banco para atualizações\n              order_id: orderItem.order_id,\n              item_id: -1 * Date.now() - Math.random() * 1000, // Generate negative ID for cart\n              quantity: orderItem.quantity,\n              unit_price: orderItem.unit_price,\n              total_price: orderItem.total_price,\n              status: orderItem.status === 'cancelled' ? 'cancelled' : 'delivered', // Preservar cancelamento ou marcar como lançado\n              launched_at: orderItem.created_at,\n              icon: metadata.icon || null, // Recover icon from metadata\n              item: {\n                name: metadata.name || orderItem.notes || 'Rodízio', // Get name from metadata or notes\n                price: orderItem.unit_price,\n                group: {\n                  type: 'rodizio'\n                }\n              }\n            };\n            return rodizioItem;\n          }\n          \n          // Handle regular items\n          return {\n            id: orderItem.id, // Manter ID do banco para atualizações\n            order_id: orderItem.order_id,\n            item_id: orderItem.item_id,\n            quantity: orderItem.quantity,\n            unit_price: orderItem.unit_price,\n            total_price: orderItem.total_price,\n            status: orderItem.status === 'cancelled' ? 'cancelled' : 'delivered', // Preservar cancelamento ou marcar como lançado\n            launched_at: orderItem.created_at,\n            item: orderItem.item\n          };\n        }) || [];\n        \n        setCart(cartItems);\n        // Removido scroll automático - itens recentes ficam no topo\n      } else {\n        setCart([]);\n        setCurrentOrder(null);\n      }\n    } catch (error) {\n      console.error('Erro ao carregar detalhes da sessão:', error);\n      setCart([]);\n      setCurrentOrder(null);\n    }\n  };\n\n  // FUNÇÕES DE MESA/SESSÃO\n  const handleSelectTable = async (table: RestaurantTable) => {\n    console.log('Mesa selecionada:', table);\n    setSelectedTable(table);\n    setCustomerCount(1); // Reset para 1 ao selecionar nova mesa\n    \n    if (table.current_session) {\n      setCurrentSession(table.current_session);\n      await loadSessionDetails(table.id);\n      \n      // Carregar itens existentes do pedido\n      await loadExistingOrderItems(table.id.toString());\n      \n      setScreen('session');\n      // Garante que a mesa está selecionada na sessão\n      console.log('Indo para sessão com mesa:', table.id);\n    } else {\n      setOpenTableDialog(true);\n    }\n  };\n\n  const handleOpenTable = async () => {\n    if (!selectedTable) return;\n    \n    setLoading(true);\n    try {\n      const { data: sessionData, error: sessionError } = await supabase\n        .from('table_sessions')\n        .insert({\n          table_id: selectedTable.id,\n          status: 'open',\n          customer_count: customerCount,\n          opened_at: new Date().toISOString(),\n          total: 0\n        })\n        .select()\n        .single();\n\n      if (sessionError) throw sessionError;\n\n      const { error: tableError } = await supabase\n        .from('restaurant_tables')\n        .update({ status: 'occupied' })\n        .eq('id', selectedTable.id);\n\n      if (tableError) throw tableError;\n\n      setCurrentSession(sessionData);\n      setOpenTableDialog(false);\n      setCart([]);\n      setCurrentOrder(null); // Limpar order ao abrir nova mesa\n      setScreen('session');\n      toast.success(`Mesa ${selectedTable.number} aberta`);\n      \n      await loadTables();\n    } catch (error: any) {\n      console.error('Erro ao abrir mesa:', error);\n      const errorMessage = error?.message || error?.details || 'Erro desconhecido ao abrir mesa';\n      toast.error(errorMessage);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Função para cancelar todos os itens e limpar a mesa\n  const handleCancelTable = async () => {\n    if (!currentSession) {\n      toast.error(\"Nenhuma sessão ativa encontrada\");\n      return;\n    }\n    \n    // Prevenir operações duplicadas\n    if (operationInProgress === 'cancel-table') {\n      toast.warning(\"Operação já em andamento...\");\n      return;\n    }\n    \n    setOperationInProgress('cancel-table');\n    setLoading(true);\n    try {\n      // Buscar o pedido ativo da mesa\n      const { data: activeOrder } = await supabase\n        .from('orders')\n        .select('*')\n        .eq('table_id', currentSession.table_id)\n        .in('status', ['pending', 'confirmed', 'preparing', 'ready', 'delivered'])\n        .order('created_at', { ascending: false })\n        .limit(1)\n        .single();\n\n      if (activeOrder) {\n        // Cancelar todos os itens do pedido\n        const { error: itemsError } = await supabase\n          .from('order_items')\n          .update({ status: 'cancelled' })\n          .eq('order_id', activeOrder.id)\n          .neq('status', 'cancelled');\n\n        if (itemsError) {\n          console.error('Erro ao cancelar itens:', itemsError);\n          throw itemsError;\n        }\n\n        // Fechar o pedido\n        const { error: orderError } = await supabase\n          .from('orders')\n          .update({ \n            status: 'cancelled',\n            total: 0\n          })\n          .eq('id', activeOrder.id);\n\n        if (orderError) {\n          console.error('Erro ao cancelar pedido:', orderError);\n          throw orderError;\n        }\n      }\n\n      // Fechar a sessão\n      const { error: sessionError } = await supabase\n        .from('table_sessions')\n        .update({ \n          status: 'closed',\n          closed_at: new Date().toISOString(),\n          total: 0\n        })\n        .eq('id', currentSession.id);\n\n      if (sessionError) {\n        console.error('Erro ao fechar sessão:', sessionError);\n        throw sessionError;\n      }\n\n      // Liberar a mesa\n      const { error: tableError } = await supabase\n        .from('restaurant_tables')\n        .update({ status: 'available' })\n        .eq('id', currentSession.table_id);\n\n      if (tableError) {\n        console.error('Erro ao liberar mesa:', tableError);\n        throw tableError;\n      }\n\n      toast.success(\"Mesa cancelada e limpa com sucesso!\");\n      \n      // Resetar estado\n      setCart([]);\n      setCurrentSession(null);\n      setCurrentOrder(null);\n      setScreen('tables');\n      setSelectedTable(null);\n      \n      // Recarregar mesas\n      await loadTables();\n    } catch (error: any) {\n      console.error('Erro completo ao cancelar mesa:', error);\n      toast.error(`Erro ao cancelar mesa: ${error.message || 'Erro desconhecido'}`);\n    } finally {\n      setLoading(false);\n      setOperationInProgress(null);\n    }\n  };\n\n  // Função para transferir mesa com tratamento robusto de erros\n  const handleTransferTable = async () => {\n    if (!currentSession || !targetTableNumber) {\n      toast.error('Sessão ou mesa de destino não especificada');\n      return;\n    }\n    \n    // Prevenir operações duplicadas\n    if (operationInProgress === 'transfer-table') {\n      toast.warning(\"Transferência já em andamento...\");\n      return;\n    }\n    \n    // Validar número da mesa\n    const targetNum = parseInt(targetTableNumber);\n    if (isNaN(targetNum) || targetNum <= 0) {\n      toast.error('Número da mesa inválido');\n      return;\n    }\n    \n    setOperationInProgress('transfer-table');\n    setLoading(true);\n    \n    // Salvar estado atual para rollback se necessário\n    const originalSession = currentSession;\n    const originalCart = [...cart];\n    \n    try {\n      // Buscar a mesa de destino com timeout\n      const { data: targetTable, error: targetError } = await Promise.race([\n        supabase\n          .from('restaurant_tables')\n          .select('*')\n          .eq('number', targetNum)\n          .single(),\n        new Promise((_, reject) => \n          setTimeout(() => reject(new Error('Timeout ao buscar mesa')), 5000)\n        )\n      ]) as any;\n\n      if (targetError || !targetTable) {\n        throw new Error(`Mesa ${targetTableNumber} não encontrada`);\n      }\n\n      // Verificar se a mesa destino está livre\n      if (targetTable.status !== 'available') {\n        throw new Error(`Mesa ${targetTableNumber} está ocupada`);\n      }\n\n      // Criar nova sessão para a mesa de destino\n      const { data: newSession, error: newSessionError } = await supabase\n        .from('table_sessions')\n        .insert({\n          table_id: targetTable.id,\n          status: 'open',\n          opened_at: new Date().toISOString(),\n          customer_count: currentSession.customer_count || 1,\n          total: 0\n        })\n        .select()\n        .single();\n\n      if (newSessionError || !newSession) {\n        console.error('Erro ao criar nova sessão:', newSessionError);\n        throw new Error('Falha ao criar nova sessão para a mesa de destino');\n      }\n\n      console.log('Nova sessão criada:', newSession.id);\n\n      // Buscar o pedido ativo da mesa origem\n      const { data: sourceOrder } = await supabase\n        .from('orders')\n        .select('*')\n        .eq('table_id', currentSession.table_id)\n        .in('status', ['pending', 'confirmed', 'preparing', 'ready', 'delivered'])\n        .order('created_at', { ascending: false })\n        .limit(1)\n        .single();\n\n      if (sourceOrder) {\n        // Criar novo pedido para a mesa destino\n        const { data: targetOrder, error: newOrderError } = await supabase\n          .from('orders')\n          .insert({\n            order_number: `ORDER-${Date.now()}`,\n            table_id: targetTable.id,\n            status: 'pending',\n            total: 0\n          })\n          .select()\n          .single();\n\n        if (newOrderError || !targetOrder) {\n          console.error('Erro ao criar novo pedido:', newOrderError);\n          throw new Error('Falha ao criar novo pedido para a mesa de destino');\n        }\n\n        console.log('Novo pedido criado:', targetOrder.id);\n\n        // Transferir todos os itens não cancelados para o novo pedido\n        const { error: itemsError } = await supabase\n          .from('order_items')\n          .update({ order_id: targetOrder.id })\n          .eq('order_id', sourceOrder.id)\n          .neq('status', 'cancelled');\n\n        if (itemsError) {\n          console.error('Erro ao transferir itens:', itemsError);\n          throw itemsError;\n        }\n\n        // Atualizar o total do novo pedido\n        const { data: orderItems } = await supabase\n          .from('order_items')\n          .select('quantity, unit_price')\n          .eq('order_id', targetOrder.id)\n          .neq('status', 'cancelled');\n\n        // Usar cálculo com precisão decimal\n        const newTotal = orderItems?.reduce((sum: number, item: any) => {\n          const itemTotal = Math.round(item.quantity * item.unit_price * 100) / 100;\n          return Math.round((sum + itemTotal) * 100) / 100;\n        }, 0) || 0;\n\n        const { error: totalError } = await supabase\n          .from('orders')\n          .update({ total: newTotal })\n          .eq('id', targetOrder.id);\n\n        if (totalError) throw totalError;\n\n        // Atualizar total da nova sessão\n        const { error: sessionTotalError } = await supabase\n          .from('table_sessions')\n          .update({ total: newTotal })\n          .eq('id', newSession.id);\n\n        if (sessionTotalError) throw sessionTotalError;\n\n        // Fechar o pedido antigo\n        const { error: closeOrderError } = await supabase\n          .from('orders')\n          .update({ \n            status: 'closed',\n            total: 0\n          })\n          .eq('id', sourceOrder.id);\n\n        if (closeOrderError) throw closeOrderError;\n      }\n\n      // Fechar a sessão antiga com verificação\n      const { error: closeError } = await supabase\n        .from('table_sessions')\n        .update({ \n          status: 'closed',\n          closed_at: new Date().toISOString(),\n          total: 0\n        })\n        .eq('id', currentSession.id);\n\n      if (closeError) {\n        console.error('Erro ao fechar sessão antiga:', closeError);\n        throw new Error('Falha ao fechar sessão original');\n      }\n\n      // Liberar mesa antiga\n      const { error: oldTableError } = await supabase\n        .from('restaurant_tables')\n        .update({ status: 'available' })\n        .eq('id', currentSession.table_id);\n\n      if (oldTableError) throw oldTableError;\n\n      // Ocupar mesa nova\n      const { error: newTableError } = await supabase\n        .from('restaurant_tables')\n        .update({ status: 'occupied' })\n        .eq('id', targetTable.id);\n\n      if (newTableError) throw newTableError;\n\n      toast.success(`Mesa transferida para ${targetTableNumber} com sucesso!`);\n      \n      // Fechar o dialog e resetar\n      setTransferTableDialog(false);\n      setTargetTableNumber('');\n      \n      // Voltar para tela de mesas\n      setCart([]);\n      setCurrentSession(null);\n      setCurrentOrder(null);\n      setScreen('tables');\n      setSelectedTable(null);\n      \n      // Recarregar mesas\n      loadTables();\n    } catch (error: any) {\n      console.error('Erro ao transferir mesa:', error);\n      toast.error(`Erro ao transferir mesa: ${error.message || 'Erro desconhecido'}`);\n    } finally {\n      setLoading(false);\n      setOperationInProgress(null);\n    }\n  };\n\n  // FUNÇÕES DO CARRINHO\n  const handleNumpadClick = (value: string) => {\n    if (activeInput === \"code\") {\n      setInputValue(prev => prev + value);\n    } else {\n      setQuantity(prev => prev + value);\n    }\n  };\n\n  const handleBackspace = () => {\n    if (activeInput === \"code\") {\n      setInputValue(prev => prev.slice(0, -1));\n    } else {\n      setQuantity(prev => prev.slice(0, -1) || \"1\");\n    }\n  };\n\n  const handleClear = () => {\n    if (activeInput === \"code\") {\n      setInputValue(\"\");\n    } else {\n      setQuantity(\"1\");\n    }\n  };\n\n  // Função para adicionar rodízio ao carrinho\n  const handleAddRodizio = () => {\n    if (!selectedRodizioGroup) return;\n    \n    const total = rodizioInteiro + rodizioMeio;\n    if (total === 0) {\n      toast.error(\"Adicione pelo menos 1 rodízio\");\n      return;\n    }\n    \n    // Adiciona rodízio inteiro se houver\n    if (rodizioInteiro > 0) {\n      const rodizioItem: OrderItem = {\n        item_id: -1 * Date.now(), // Usar número negativo para IDs temporários de rodízio\n        quantity: rodizioInteiro,\n        unit_price: selectedRodizioGroup.price || 0,\n        total_price: (selectedRodizioGroup.price || 0) * rodizioInteiro,\n        status: 'pending' as const,\n        item: {\n          id: -1 * Date.now(),\n          name: selectedRodizioGroup.name,\n          group_id: selectedRodizioGroup.id,\n          price: selectedRodizioGroup.price || 0,\n          active: true,\n          available: true,\n          category_id: 0,\n          group: selectedRodizioGroup,\n          icon: selectedRodizioGroup.icon\n        }\n      };\n      setCart(prev => [...prev, rodizioItem]);\n    }\n    \n    // Adiciona rodízio meio se houver\n    if (rodizioMeio > 0) {\n      const rodizioItem: OrderItem = {\n        item_id: -2 * Date.now(), // Usar número negativo para IDs temporários de rodízio\n        quantity: rodizioMeio,\n        unit_price: selectedRodizioGroup.half_price || 0,\n        total_price: (selectedRodizioGroup.half_price || 0) * rodizioMeio,\n        status: 'pending' as const,\n        item: {\n          id: -2 * Date.now(),\n          name: `${selectedRodizioGroup.name} (Meio)`,\n          group_id: selectedRodizioGroup.id,\n          price: selectedRodizioGroup.half_price || 0,\n          active: true,\n          available: true,\n          category_id: 0,\n          group: selectedRodizioGroup,\n          icon: selectedRodizioGroup.icon\n        }\n      };\n      setCart(prev => [...prev, rodizioItem]);\n    }\n    \n    // Fecha o modal e vai para as categorias\n    setRodizioModal(false);\n    setSelectedGroup(selectedRodizioGroup.id);\n    \n    // Seleciona a primeira categoria\n    const firstCategory = categories\n      .filter(c => c.active && c.group_id === selectedRodizioGroup.id)\n      .sort((a, b) => (a.sort_order || 0) - (b.sort_order || 0))[0];\n    if (firstCategory) {\n      setSelectedCategory(firstCategory.id);\n    }\n    \n    toast.success(\"Rodízio adicionado com sucesso!\");\n  };\n\n  const handleAddItem = (item?: Item) => {\n    if (!item) {\n      if (!inputValue) {\n        toast.error(\"Digite o código do produto\");\n        return;\n      }\n\n      item = items.find(i => \n        i.id.toString() === inputValue || \n        i.name.toLowerCase().includes(inputValue.toLowerCase())\n      );\n\n      if (!item) {\n        toast.error(\"Produto não encontrado\");\n        return;\n      }\n    }\n\n    const qty = parseInt(quantity) || 1;\n    \n    // Verifica se o item é de um grupo rodízio\n    const group = item.group_id ? groups.find(g => g.id === item.group_id) : null;\n    const isRodizio = group?.type === 'rodizio';\n    \n    // Se for rodízio, verifica se já tem rodízio lançado\n    if (isRodizio) {\n      const hasRodizio = cart.some(cartItem => {\n        // Verifica se é um rodízio (tem ID negativo) e se é do mesmo grupo\n        const isRodizioItem = cartItem.item_id < 0;\n        const isSameGroup = cartItem.item?.group_id === item.group_id;\n        const hasRodizioInName = cartItem.item?.name?.includes(group?.name || '');\n        return isRodizioItem && (isSameGroup || hasRodizioInName);\n      });\n      \n      if (!hasRodizio) {\n        // Se não tem rodízio, mostra o modal para adicionar primeiro\n        toast.error(`É necessário lançar o rodízio ${group.name} primeiro!`);\n        setSelectedRodizioGroup(group);\n        setRodizioInteiro(1);\n        setRodizioMeio(0);\n        setRodizioModal(true);\n        return;\n      }\n    }\n    \n    // Calcular preço - se for item de rodízio (e já tem rodízio lançado), é grátis\n    let itemPrice = item.price || 0;\n    \n    if (isRodizio) {\n      // Items de rodízio são sempre grátis (inclusos no rodízio)\n      itemPrice = 0;\n    }\n    \n    const newItem: OrderItem = {\n      id: Date.now() + Math.random(), // ID único para cada linha do carrinho\n      item_id: item.id,\n      item: item,\n      quantity: qty,\n      unit_price: itemPrice,\n      total_price: itemPrice * qty,\n      status: 'pending' // Status inicial como \"pending\"\n    };\n\n    setCart(prev => {\n      // Procurar apenas por itens PENDENTES (não lançados) para mesclar\n      // Itens lançados (delivered/cancelled) NUNCA devem ser agrupados com novos\n      const existing = prev.find(c => \n        c.item_id === item.id && (c.status === 'pending' || !c.status)\n      );\n      \n      if (existing) {\n        // Mesclar apenas com itens pendentes (não lançados)\n        return prev.map(c => \n          c.id === existing.id \n            ? { \n                ...c, \n                quantity: c.quantity + qty, \n                total_price: c.unit_price * (c.quantity + qty) \n              }\n            : c\n        );\n      } else {\n        // Criar nova linha - itens lançados ficam separados\n        return [...prev, newItem];\n      }\n    });\n\n    // Mudar automaticamente para aba \"Comanda\" para mostrar o item adicionado\n    setActiveTab('cart');\n\n    // Feedback visual e sonoro com animação\n    let message = item.name;\n    if (isRodizio) {\n      message = `${item.name} (Incluído no Rodízio)`;\n    }\n    \n    // Criar um toast customizado com animação\n    toast.success(\n      <motion.div \n        initial={{ opacity: 0, scale: 0.5, x: -100 }}\n        animate={{ opacity: 1, scale: 1, x: 0 }}\n        transition={{ type: \"spring\", stiffness: 300, damping: 20 }}\n        className=\"flex items-center gap-3\"\n      >\n        <motion.div\n          initial={{ rotate: -180 }}\n          animate={{ rotate: 0 }}\n          transition={{ duration: 0.3 }}\n        >\n          <ShoppingCart className=\"h-5 w-5 text-green-500\" />\n        </motion.div>\n        <div>\n          <div className=\"font-semibold\">{message}</div>\n          <div className=\"text-xs text-gray-400\">Adicionado ao carrinho!</div>\n        </div>\n        <motion.div\n          initial={{ scale: 0 }}\n          animate={{ scale: 1 }}\n          transition={{ delay: 0.2 }}\n        >\n          <Check className=\"h-5 w-5 text-green-500\" />\n        </motion.div>\n      </motion.div>,\n      {\n        duration: 3000,\n        style: {\n          background: 'linear-gradient(to right, #1f2937, #111827)',\n          color: '#fff',\n        }\n      }\n    );\n    \n    setInputValue(\"\");\n    setQuantity(\"1\");\n    setActiveInput(\"code\");\n    codeInputRef.current?.focus();\n  };\n\n  const handleUpdateQuantity = (cartLineId: number, delta: number) => {\n    setCart(prev => {\n      // Find the item to check current quantity\n      const currentItem = prev.find(item => item.id === cartLineId);\n      \n      // If decreasing and quantity is 1\n      if (currentItem && currentItem.quantity === 1 && delta === -1) {\n        // Se o item não foi lançado, remove do carrinho\n        if (currentItem.status === 'pending' || !currentItem.status) {\n          toast.success(\"Item removido\");\n          return prev.filter(item => item.id !== cartLineId);\n        }\n        // Se o item foi lançado, marca como cancelado\n        if (currentItem.status === 'delivered') {\n          toast.error(\"Item marcado como cancelado\");\n          return prev.map(item => {\n            if (item.id === cartLineId) {\n              return {\n                ...item,\n                status: 'cancelled' as any\n              };\n            }\n            return item;\n          });\n        }\n        // Se já está cancelado, mantém como está\n        return prev;\n      }\n      \n      // Se está aumentando quantidade de item cancelado, restaura\n      if (currentItem?.status === 'cancelled' && delta > 0) {\n        toast.success(\"Item restaurado\");\n        return prev.map(item => {\n          if (item.id === cartLineId) {\n            return {\n              ...item,\n              status: 'delivered' as any,\n              quantity: item.quantity + delta,\n              total_price: item.unit_price * (item.quantity + delta),\n              wasRestored: true // Flag para indicar que foi restaurado e precisa ser lançado\n            } as any;\n          }\n          return item;\n        });\n      }\n      \n      // Otherwise, update the quantity\n      return prev.map(item => {\n        if (item.id === cartLineId) {\n          const newQty = Math.max(1, item.quantity + delta);\n          return {\n            ...item,\n            quantity: newQty,\n            total_price: item.unit_price * newQty\n          };\n        }\n        return item;\n      });\n    });\n  };\n\n  const handleRemoveItem = (cartLineId: number) => {\n    const item = cart.find(i => i.id === cartLineId);\n    if (!item) return;\n    \n    // Se o item não foi lançado (pending), remove do carrinho\n    if (item.status === 'pending' || !item.status) {\n      setCart(prev => prev.filter(item => item.id !== cartLineId));\n      toast.success(\"Item removido\");\n      return;\n    }\n    \n    // Se o item foi lançado, alterna entre delivered e cancelled\n    if (item.status === 'delivered') {\n      // Se tem apenas 1 unidade, cancela direto\n      if (item.quantity === 1) {\n        setCart(prev => prev.map(item => {\n          if (item.id === cartLineId) {\n            return {\n              ...item,\n              status: 'cancelled' as any,\n              cancelledQuantity: 1,\n              wasCancelled: true // Flag para indicar que foi cancelado e precisa ser lançado\n            } as any;\n          }\n          return item;\n        }));\n        toast.error(\"Item cancelado\");\n      } else {\n        // Se tem mais de 1 unidade, abre modal para escolher quantidade\n        setItemToCancel(item);\n        setCancelQuantity(1);\n        setCancelQuantityDialog(true);\n      }\n    } else if (item.status === 'cancelled') {\n      // Restaurar item cancelado\n      setCart(prev => prev.map(item => {\n        if (item.id === cartLineId) {\n          const updated = { ...item };\n          delete updated.cancelledQuantity;\n          return {\n            ...updated,\n            status: 'delivered' as any,\n            wasRestored: true // Flag para indicar que foi restaurado e precisa ser lançado\n          } as any;\n        }\n        return item;\n      }));\n      toast.success(\"Item restaurado\");\n    }\n  };\n  \n  const handleConfirmCancelQuantity = () => {\n    if (!itemToCancel) return;\n    \n    setCart(prev => prev.map(item => {\n      if (item.id === itemToCancel.id) {\n        const cancelledQty = cancelQuantity;\n        if (cancelledQty >= item.quantity) {\n          // Cancela tudo\n          return {\n            ...item,\n            status: 'cancelled' as any,\n            cancelledQuantity: item.quantity,\n            wasCancelled: true // Flag para indicar que foi cancelado e precisa ser lançado\n          } as any;\n        } else {\n          // Cancela parcialmente\n          return {\n            ...item,\n            cancelledQuantity: cancelledQty,\n            wasCancelled: true // Flag para indicar cancelamento parcial pendente\n          } as any;\n        }\n      }\n      return item;\n    }));\n    \n    toast.error(`${cancelQuantity} ${cancelQuantity === 1 ? 'item cancelado' : 'itens cancelados'}`);\n    setCancelQuantityDialog(false);\n    setItemToCancel(null);\n  };\n\n  const handleCancelOrder = () => {\n    // Identifica itens que precisam ser cancelados (pendentes, restaurados ou cancelados)\n    const itemsToCancelOrRevert = cart.filter(item => \n      item.status === 'pending' || \n      !item.status || \n      (item as any).wasRestored === true ||\n      (item as any).wasCancelled === true\n    );\n    \n    if (itemsToCancelOrRevert.length === 0) {\n      toast.error(\"Não há alterações para cancelar.\");\n      return;\n    }\n\n    // Remove itens pendentes e reverte flags de itens modificados\n    setCart(prev => prev\n      .filter(item => item.status === 'delivered' || item.status === 'cancelled')\n      .map(item => {\n        const updated = { ...item };\n        \n        // Se o item foi restaurado, remove a flag wasRestored\n        if ((updated as any).wasRestored) {\n          delete (updated as any).wasRestored;\n        }\n        \n        // Se o item foi cancelado, reverte para delivered e remove flags\n        if ((updated as any).wasCancelled) {\n          delete (updated as any).wasCancelled;\n          delete (updated as any).cancelledQuantity;\n          // Se estava totalmente cancelado, volta para delivered\n          if (updated.status === 'cancelled') {\n            return { ...updated, status: 'delivered' as any };\n          }\n        }\n        \n        return updated;\n      })\n    );\n    \n    toast.success(\"Alterações canceladas\");\n  };\n\n\n  // Calcular total com desconto\n  const calculateTotalWithDiscount = () => {\n    const subtotal = calculateSubtotal(); // Usar subtotal em vez de total\n    const serviceTax = calculateServiceTax();\n    const totalWithTax = subtotal + serviceTax;\n    \n    if (discountType === 'percentage') {\n      // Aplicar desconto no subtotal (antes da taxa)\n      const discountAmount = subtotal * discountValue / 100;\n      const subtotalAfterDiscount = subtotal - discountAmount;\n      const serviceTaxAfterDiscount = serviceTaxPercentage > 0 ? (subtotalAfterDiscount * serviceTaxPercentage / 100) : 0;\n      return subtotalAfterDiscount + serviceTaxAfterDiscount;\n    } else {\n      // Desconto fixo aplicado no total (após taxa)\n      return Math.max(0, totalWithTax - discountValue);\n    }\n  };\n\n  // Calcular valor restante a pagar\n  const calculateRemaining = () => {\n    const total = calculateTotalWithDiscount();\n    const paid = payments.reduce((sum, p) => sum + p.amount, 0);\n    return Math.max(0, total - paid);\n  };\n\n  // Calcular troco\n  const calculateChange = () => {\n    const total = calculateTotalWithDiscount();\n    const paid = payments.reduce((sum, p) => sum + p.amount, 0);\n    return Math.max(0, paid - total);\n  };\n\n  // Adicionar pagamento\n  const addPayment = (payment: any) => {\n    const remaining = calculateRemaining();\n    if (remaining <= 0) {\n      toast.error(\"Conta já está totalmente paga!\");\n      return;\n    }\n    \n    const paymentAmount = Math.min(payment.amount, remaining);\n    setPayments([...payments, {\n      ...payment,\n      amount: paymentAmount\n    }]);\n    \n    if (calculateRemaining() - paymentAmount <= 0) {\n      toast.success(\"Pagamento completo!\");\n    }\n  };\n\n  // Remover pagamento\n  const removePayment = (paymentId: string) => {\n    setPayments(payments.filter(p => p.id !== paymentId));\n  };\n\n  // Iniciar processo de fechar conta\n  const startCheckout = () => {\n    // Abrir modal de confirmação ao invés de ir direto para checkout\n    setConfirmCloseTableDialog(true);\n  };\n  \n  // Confirmar fechamento da conta\n  const confirmCloseTable = async () => {\n    if (!currentSession || !selectedTable) return;\n    \n    setLoading(true);\n    try {\n      // Calcular total da mesa\n      const total = calculateTotal();\n      \n      // Atualizar status da mesa para 'closed'\n      const { error: tableError } = await supabase\n        .from('restaurant_tables')\n        .update({ status: 'closed' })\n        .eq('id', selectedTable.id);\n      \n      if (tableError) throw tableError;\n      \n      // Atualizar sessão para indicar que está fechada mas não encerrada\n      const { error: sessionError } = await supabase\n        .from('table_sessions')\n        .update({\n          final_total: total,\n          notes: 'Conta fechada - aguardando pagamento'\n        })\n        .eq('id', currentSession.id);\n      \n      if (sessionError) throw sessionError;\n      \n      // Atualizar o status da mesa localmente IMEDIATAMENTE\n      setSelectedTable((prev: any) => ({\n        ...prev,\n        status: 'closed'\n      }));\n      \n      toast.success(\"Conta fechada com sucesso!\");\n      setConfirmCloseTableDialog(false);\n      \n      // Recarregar dados da mesa\n      await loadSessionDetails(selectedTable.id);\n      await loadTables();\n      \n    } catch (error: any) {\n      console.error('Erro ao fechar conta:', error);\n      toast.error(`Erro ao fechar conta: ${error.message || 'Erro desconhecido'}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n  \n  // Reabrir mesa fechada\n  const reopenTable = async () => {\n    if (!currentSession || !selectedTable) return;\n    \n    setLoading(true);\n    try {\n      // Voltar status da mesa para 'occupied'\n      const { error: tableError } = await supabase\n        .from('restaurant_tables')\n        .update({ status: 'occupied' })\n        .eq('id', selectedTable.id);\n      \n      if (tableError) throw tableError;\n      \n      // Limpar notas da sessão\n      const { error: sessionError } = await supabase\n        .from('table_sessions')\n        .update({\n          notes: null,\n          final_total: null\n        })\n        .eq('id', currentSession.id);\n      \n      if (sessionError) throw sessionError;\n      \n      toast.success(\"Mesa reaberta com sucesso!\");\n      \n      // Recarregar dados da mesa primeiro\n      await loadSessionDetails(selectedTable.id);\n      await loadTables();\n      \n      // Atualizar o status da mesa localmente DEPOIS de recarregar\n      // Isso garante que a interface seja atualizada corretamente\n      setSelectedTable((prev: any) => prev ? ({\n        ...prev,\n        status: 'occupied'\n      }) : null);\n      \n    } catch (error: any) {\n      console.error('Erro ao reabrir mesa:', error);\n      toast.error(`Erro ao reabrir mesa: ${error.message || 'Erro desconhecido'}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Finalizar checkout e processar pagamento\n  const finishCheckout = async () => {\n    const remaining = calculateRemaining();\n    if (remaining > 0) {\n      toast.error(`Ainda faltam ${formatCurrency(remaining)} para pagar!`);\n      return;\n    }\n    \n    if (!selectedTable) {\n      toast.error(\"Mesa não encontrada!\");\n      return;\n    }\n    \n    setLoading(true);\n    \n    try {\n      // Buscar pedido atual da mesa\n      const { data: order, error: orderError } = await supabase\n        .from('orders')\n        .select('id')\n        .eq('table_id', selectedTable.id)\n        .not('status', 'in', '(completed,cancelled)')\n        .order('created_at', { ascending: false })\n        .limit(1)\n        .single();\n\n      if (orderError || !order) {\n        throw new Error('Pedido não encontrado');\n      }\n\n      // Salvar pagamentos no banco\n      for (const payment of payments) {\n        await supabase\n          .from('payments')\n          .insert({\n            order_id: order.id,\n            amount: payment.amount,\n            method: payment.method,\n            status: 'completed'\n          });\n      }\n      \n      // Salvar desconto se houver\n      if (discountValue > 0) {\n        const discountAmount = discountType === 'percentage' \n          ? calculateSubtotal() * discountValue / 100 \n          : discountValue;\n          \n        await supabase\n          .from('discounts')\n          .insert({\n            order_id: order.id,\n            type: discountType,\n            value: discountValue,\n            amount: discountAmount\n          });\n      }\n      \n      // Salvar divisão se houver\n      if (splitCount > 1) {\n        const amountPerPerson = calculateTotalWithDiscount() / splitCount;\n        \n        for (let i = 1; i <= splitCount; i++) {\n          await supabase\n            .from('payment_splits')\n            .insert({\n              order_id: order.id,\n              person_number: i,\n              amount: amountPerPerson\n            });\n        }\n      }\n      \n      // Atualizar ordem\n      await supabase\n        .from('orders')\n        .update({\n          payment_status: 'paid',\n          payment_method: payments.length > 1 ? 'mixed' : payments[0].method,\n          discount: discountValue > 0 ? (discountType === 'percentage' ? calculateSubtotal() * discountValue / 100 : discountValue) : 0,\n          status: 'completed',\n          completed_at: new Date().toISOString(),\n          total: calculateTotalWithDiscount()\n        })\n        .eq('id', order.id);\n      \n      // Atualizar mesa para disponível\n      await supabase\n        .from('tables')\n        .update({ \n          status: 'available',\n          current_order_id: null\n        })\n        .eq('id', selectedTable.id);\n      \n      toast.success(\"Conta fechada com sucesso!\");\n      \n      // Limpar tudo e voltar\n      setCheckoutDialog(false);\n      setPaymentDialog(false);\n      setCart([]);\n      setCurrentOrder(null);\n      setCurrentSession(null);\n      setSelectedTable(null);\n      setScreen('tables');\n      loadTables();\n      \n    } catch (error: any) {\n      console.error('Erro ao fechar conta:', error);\n      toast.error(\"Erro ao processar pagamento!\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n\n  const handleLaunchOrder = async () => {\n    // Filtrar itens por status\n    const newItems = cart.filter(item => item.status === 'pending');\n    const cancelledItems = cart.filter(item => item.status === 'cancelled' && item.id && !item.lineId);\n    const restoredItems = cart.filter(item => \n      item.status === 'delivered' && \n      (item as any).wasRestored === true && \n      item.id && \n      item.order_id\n    );\n    const itemsWithCancelledFlag = cart.filter(item =>\n      (item as any).wasCancelled === true\n    );\n    const itemsToUpdate = cart.filter(item => \n      (item.status === 'cancelled' || item.status === 'pending') && \n      item.id && \n      !item.lineId\n    );\n    \n    // Se não há nada para processar (todos já lançados)\n    if (newItems.length === 0 && cancelledItems.length === 0 && restoredItems.length === 0 && itemsToUpdate.length === 0 && itemsWithCancelledFlag.length === 0) {\n      toast.error(\"Nenhuma alteração para lançar. Adicione novos itens ou modifique os existentes.\");\n      return;\n    }\n\n    if (!selectedTable?.id) {\n      toast.error(\"Mesa não selecionada. Volte para a tela de mesas e selecione uma mesa.\");\n      console.error(\"Erro: selectedTable não está definida\", selectedTable);\n      return;\n    }\n\n    try {\n      console.log('Lançando pedido para mesa:', selectedTable.id);\n\n      // Verificar se já existe uma comanda aberta para esta mesa\n      const { data: existingOrders, error: checkError } = await supabase\n        .from('orders')\n        .select('id')\n        .eq('table_id', selectedTable.id)\n        .eq('status', 'open')\n        .single();\n\n      // Ignorar erro PGRST116 (nenhuma linha encontrada)\n      if (checkError && checkError.code !== 'PGRST116') {\n        console.error('Erro ao verificar pedidos existentes:', checkError);\n        throw checkError;\n      }\n\n      let orderId;\n\n      if (existingOrders?.id) {\n        orderId = existingOrders.id;\n        console.log('Usando comanda existente:', orderId);\n      } else {\n        // Criar nova comanda\n        const orderNumber = `${selectedTable.number}-${Date.now().toString().slice(-6)}`;\n        \n        const { data: newOrder, error: orderError } = await supabase\n          .from('orders')\n          .insert({\n            order_number: orderNumber,\n            table_id: selectedTable.id,\n            status: 'open',\n            total: calculateTotal()\n          })\n          .select()\n          .single();\n\n        if (orderError) {\n          console.error('Erro ao criar nova comanda:', orderError);\n          throw orderError;\n        }\n        orderId = newOrder.id;\n        console.log('Nova comanda criada:', orderId);\n      }\n\n      // Processar itens cancelados que já foram lançados anteriormente\n      const itemsToCancel = cart.filter(item => \n        (item.status === 'cancelled' || (item as any).wasCancelled === true) && \n        item.id && \n        item.order_id\n      );\n\n      if (itemsToCancel.length > 0) {\n        console.log('Atualizando itens cancelados no banco:', itemsToCancel);\n        \n        for (const item of itemsToCancel) {\n          // Se tem cancelamento parcial\n          if ((item as any).cancelledQuantity && (item as any).cancelledQuantity < item.quantity) {\n            // Atualizar quantidade cancelada no banco (cancelamento parcial)\n            const { error: updateError } = await supabase\n              .from('order_items')\n              .update({ \n                cancelled_quantity: (item as any).cancelledQuantity\n              })\n              .eq('id', item.id);\n            \n            if (updateError) {\n              console.error('Erro ao atualizar cancelamento parcial:', updateError);\n              throw updateError;\n            }\n          } else {\n            // Cancelamento total\n            const { error: updateError } = await supabase\n              .from('order_items')\n              .update({ \n                status: 'cancelled'\n                // Não zerar quantity aqui - manter o valor original para histórico\n              })\n              .eq('id', item.id);\n            \n            if (updateError) {\n              console.error('Erro ao atualizar item cancelado:', updateError);\n              throw updateError;\n            }\n          }\n        }\n        \n        console.log('Itens cancelados atualizados com sucesso');\n      }\n\n      // Processar itens restaurados (que eram cancelados e foram restaurados)\n      if (restoredItems.length > 0) {\n        console.log('Atualizando itens restaurados no banco:', restoredItems);\n        \n        for (const item of restoredItems) {\n          const { error: updateError } = await supabase\n            .from('order_items')\n            .update({ \n              status: 'pending' // Voltar para pending para ser entregue novamente\n            })\n            .eq('id', item.id);\n          \n          if (updateError) {\n            console.error('Erro ao atualizar item restaurado:', updateError);\n            throw updateError;\n          }\n        }\n        \n        console.log('Itens restaurados atualizados com sucesso');\n      }\n\n      // Adicionar apenas itens novos (não lançados) ao pedido\n      const orderItems = newItems.map(item => {\n        // Para rodízios (IDs negativos), adicionar metadata\n        if (item.item_id < 0) {\n          return {\n            order_id: orderId,\n            item_id: null, // Rodízio não tem item_id real\n            quantity: item.quantity,\n            unit_price: item.unit_price,\n            total_price: item.total_price,\n            status: 'pending',\n            metadata: {\n              type: 'rodizio',\n              icon: item.item?.icon || '',\n              group_id: item.item?.group_id || 0,\n              name: item.item?.name || '',\n              image: item.item?.image || ''\n            }\n          };\n        }\n        // Para itens normais\n        return {\n          order_id: orderId,\n          item_id: item.item_id,\n          quantity: item.quantity,\n          unit_price: item.unit_price,\n          total_price: item.total_price,\n          status: 'pending'\n        };\n      });\n\n      let insertedItems = null;\n      \n      // Só inserir novos itens se houver algum\n      if (orderItems.length > 0) {\n        console.log('Inserindo itens novos:', orderItems);\n\n        // Inserir e retornar os itens com created_at\n        const { data: items, error: itemsError } = await supabase\n          .from('order_items')\n          .insert(orderItems)\n          .select('*, created_at'); // Retornar os itens inseridos com created_at\n\n        if (itemsError) {\n          console.error('Erro ao inserir itens:', itemsError);\n          throw itemsError;\n        }\n\n        insertedItems = items;\n        console.log('Itens inseridos com sucesso:', insertedItems);\n      }\n\n      // Processar impressão\n      try {\n        await processPrinting(orderId);\n      } catch (printError) {\n        console.error('Erro na impressão (continuando):', printError);\n        // Não vamos falhar o pedido por erro de impressão\n      }\n\n      // Marcar apenas os itens recém-lançados como delivered e adicionar timestamp do banco\n      setCart(cart.map(item => {\n        // Se o item foi restaurado, limpar a flag wasRestored\n        if ((item as any).wasRestored) {\n          const { wasRestored, ...itemWithoutFlag } = item as any;\n          return itemWithoutFlag;\n        }\n        \n        // Se o item foi cancelado, limpar a flag wasCancelled\n        if ((item as any).wasCancelled) {\n          const { wasCancelled, ...itemWithoutFlag } = item as any;\n          return itemWithoutFlag;\n        }\n        \n        // Se o item estava nos newItems (foi lançado agora), marca como delivered\n        const insertedItem = insertedItems?.find((inserted: any) => {\n          // Para rodízios\n          if (item.item_id < 0 && !inserted.item_id) {\n            return inserted.metadata?.name === item.item?.name;\n          }\n          // Para itens normais\n          return inserted.item_id === item.item_id;\n        });\n        \n        if (insertedItem && newItems.some(newItem => \n          newItem.item_id === item.item_id && \n          newItem.quantity === item.quantity &&\n          newItem.status === item.status\n        )) {\n          return {\n            ...item,\n            status: 'delivered' as const,\n            order_id: orderId,\n            launched_at: insertedItem.created_at // Usar created_at do banco\n          };\n        }\n        // Mantém itens já lançados como estão\n        return item;\n      }));\n      \n      // Manter na aba do carrinho para continuar adicionando\n      setActiveTab('cart');\n      \n      // Rolar automaticamente para mostrar os itens lançados\n      setTimeout(() => {\n        if (cartScrollRef.current) {\n          const scrollElement = cartScrollRef.current.querySelector('[data-radix-scroll-area-viewport]');\n          if (scrollElement) {\n            scrollElement.scrollTop = scrollElement.scrollHeight;\n          }\n        }\n      }, 100);\n      \n      // Verificar se ainda há itens ativos na mesa após cancelamentos\n      const activeItemsCount = cart.filter(item => \n        item.status !== 'cancelled'\n      ).length;\n      \n      // Se todos os itens foram cancelados, atualizar mesa para disponível\n      if (activeItemsCount === 0 && cart.length > 0) {\n        console.log('Todos os itens foram cancelados, liberando mesa');\n        \n        // Atualizar status da mesa para disponível\n        await supabase\n          .from('restaurant_tables')\n          .update({ status: 'available' })\n          .eq('id', selectedTable.id);\n          \n        // Fechar o pedido\n        await supabase\n          .from('orders')\n          .update({ \n            status: 'cancelled',\n            total: 0\n          })\n          .eq('id', orderId);\n        \n        // Fechar a sessão se existir\n        if (currentSession) {\n          await supabase\n            .from('table_sessions')\n            .update({ \n              status: 'closed',\n              closed_at: new Date().toISOString()\n            })\n            .eq('id', currentSession.id);\n        }\n        \n        toast.success(\"Mesa liberada - todos os itens foram cancelados\");\n        // Voltar para a tela de mesas\n        setTimeout(() => {\n          setScreen('tables');\n          setCart([]);\n          setSelectedTable(null);\n          setCurrentSession(null);\n          loadTables(); // Recarregar lista de mesas\n        }, 1500);\n        \n        return;\n      }\n      \n      // Mensagem de sucesso apropriada\n      let successMessage = \"Pedido lançado!\";\n      if (itemsToCancel.length > 0 && newItems.length === 0) {\n        successMessage = \"Cancelamentos salvos com sucesso!\";\n      } else if (itemsToCancel.length > 0 && newItems.length > 0) {\n        successMessage = \"Pedido lançado e cancelamentos salvos!\";\n      }\n      \n      toast.success(\n        <div className=\"flex items-center gap-2\">\n          <CheckCircle2 className=\"h-5 w-5\" />\n          <span>{successMessage} Você pode continuar adicionando itens.</span>\n        </div>\n      );\n    } catch (error: any) {\n      console.error('Erro ao lançar pedido:', error);\n      toast.error(error.message || \"Erro ao lançar pedido. Verifique o console para mais detalhes.\");\n    }\n  };\n\n  // Calcular subtotal (sem taxa de serviço)\n  const calculateSubtotal = () => {\n    return cart\n      .filter(item => item.status !== 'cancelled')\n      .reduce((sum, item) => {\n        // Se tem quantidade cancelada parcialmente, calcula o valor das unidades ativas\n        if (item.cancelledQuantity && item.cancelledQuantity > 0) {\n          const activeQuantity = item.quantity - item.cancelledQuantity;\n          return sum + (item.unit_price * activeQuantity);\n        }\n        return sum + item.total_price;\n      }, 0);\n  };\n\n  // Calcular valor da taxa de serviço\n  const calculateServiceTax = () => {\n    const subtotal = calculateSubtotal();\n    return serviceTaxPercentage > 0 ? (subtotal * serviceTaxPercentage / 100) : 0;\n  };\n\n  // Calcular total com taxa de serviço\n  const calculateTotal = () => {\n    const subtotal = calculateSubtotal();\n    const serviceTax = calculateServiceTax();\n    return subtotal + serviceTax;\n  };\n\n  const calculateNewItemsTotal = () => {\n    return cart.filter(item => item.status !== 'delivered' && item.status !== 'cancelled')\n      .reduce((sum, item) => sum + item.total_price, 0);\n  };\n\n  const calculateLaunchedTotal = () => {\n    return cart.filter(item => item.status === 'delivered')\n      .reduce((sum, item) => {\n        const cancelledQty = item.cancelledQuantity || 0;\n        const activeQty = item.quantity - cancelledQty;\n        return sum + (item.unit_price * activeQty);\n      }, 0);\n  };\n\n  const calculateCancelledTotal = () => {\n    const fullyCancelled = cart.filter(item => item.status === 'cancelled')\n      .reduce((sum, item) => sum + item.total_price, 0);\n    \n    const partiallyCancelled = cart.filter(item => item.status === 'delivered' && item.cancelledQuantity)\n      .reduce((sum, item) => {\n        return sum + (item.unit_price * (item.cancelledQuantity || 0));\n      }, 0);\n    \n    return fullyCancelled + partiallyCancelled;\n  };\n\n  // Process printing for order items\n  const processPrinting = async (orderId: number) => {\n    try {\n      // Get order items with their details\n      const { data: orderItems, error: itemsError } = await supabase\n        .from('order_items')\n        .select(`\n          *,\n          item:items (\n            id,\n            name,\n            group_id,\n            group:groups (\n              id,\n              name,\n              type\n            )\n          )\n        `)\n        .eq('order_id', orderId);\n\n      if (itemsError) throw itemsError;\n      if (!orderItems) return;\n\n      const itemsWithoutPrinter: any[] = [];\n      const itemsToPrint: any[] = [];\n\n      // Process each item\n      for (const orderItem of orderItems) {\n        // Skip items without item_id (rodízios)\n        if (!orderItem.item_id || orderItem.item_id < 0) {\n          continue;\n        }\n        \n        // Skip rodízio items (they don't print)\n        if (orderItem.item?.group?.type === 'rodizio') {\n          continue;\n        }\n\n        // Check if item has a printer configured\n        const { data: printerConfig } = await supabase\n          .from('product_printers')\n          .select('printer_id')\n          .eq('product_id', orderItem.item_id)\n          .single();\n\n        if (!printerConfig || !printerConfig.printer_id) {\n          // Item doesn't have a printer configured\n          itemsWithoutPrinter.push({\n            item_id: orderItem.item_id,\n            item_name: orderItem.item?.name || `Item ${orderItem.item_id}`,\n            order_id: orderId,\n            quantity: orderItem.quantity\n          });\n        } else {\n          // Item has a printer configured\n          itemsToPrint.push({\n            ...orderItem,\n            printer_id: printerConfig.printer_id\n          });\n        }\n      }\n\n      // Create notifications for items without printer\n      if (itemsWithoutPrinter.length > 0) {\n        for (const item of itemsWithoutPrinter) {\n          await supabase\n            .from('notifications')\n            .insert({\n              message: `Produto \"${item.item_name}\" foi lançado sem impressora configurada`,\n              type: 'printer_missing',\n              item_id: item.item_id,\n              item_name: item.item_name,\n              metadata: {\n                order_id: item.order_id,\n                quantity: item.quantity,\n                table: selectedTable?.number,\n                timestamp: new Date().toISOString()\n              }\n            });\n        }\n      }\n\n      // TODO: Process items with printer (send to print queue)\n      // This will be implemented later with the print queue system\n      if (itemsToPrint.length > 0) {\n        // For now, just log what would be printed\n        console.log('Items to print:', itemsToPrint);\n      }\n\n    } catch (error) {\n      console.error('Error processing printing:', error);\n      // Don't throw error to not block order saving\n    }\n  };\n\n  // FUNÇÕES DE PEDIDO/PAGAMENTO\n  // Função handleSaveOrder removida - agora só existe Lançar e Cancelar\n  /*\n  const handleSaveOrder = async () => {\n    if (!currentSession || !selectedTable || cart.length === 0) {\n      toast.error(\"Adicione itens ao pedido\");\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const total = calculateTotal();\n      \n      if (currentOrder) {\n        await supabase\n          .from('order_items')\n          .delete()\n          .eq('order_id', currentOrder.id);\n\n        const { error: orderError } = await supabase\n          .from('orders')\n          .update({\n            total: total,\n            updated_at: new Date().toISOString()\n          })\n          .eq('id', currentOrder.id);\n\n        if (orderError) throw orderError;\n\n        const { error: itemsError } = await supabase\n          .from('order_items')\n          .insert(\n            cart.map(item => ({\n              order_id: currentOrder.id,\n              item_id: item.item_id > 0 ? item.item_id : null, // Rodízios have negative IDs, save as null\n              quantity: item.quantity,\n              unit_price: item.unit_price,\n              total_price: item.total_price,\n              status: item.status,\n              notes: item.item_id < 0 ? item.item?.name || null : null, // Save rodízio name in notes\n              metadata: item.item_id < 0 ? { \n                type: 'rodizio',\n                icon: item.item?.icon || (item as any).icon || null,\n                name: item.item?.name || null,\n                group_id: item.item?.group_id || null,\n                image: item.item?.image || null\n              } : null // Save rodízio metadata\n            }))\n          );\n\n        if (itemsError) throw itemsError;\n        \n        // Process printing after saving order\n        await processPrinting(currentOrder.id);\n      } else {\n        const orderNumber = `${selectedTable.number}-${Date.now().toString().slice(-6)}`;\n        \n        const { data: orderData, error: orderError } = await supabase\n          .from('orders')\n          .insert({\n            order_number: orderNumber,\n            table_id: selectedTable.id,\n            status: 'confirmed',\n            total: total,\n            notes: null\n          })\n          .select()\n          .single();\n\n        if (orderError) throw orderError;\n\n        const { error: itemsError } = await supabase\n          .from('order_items')\n          .insert(\n            cart.map(item => ({\n              order_id: orderData.id,\n              item_id: item.item_id > 0 ? item.item_id : null, // Rodízios have negative IDs, save as null\n              quantity: item.quantity,\n              unit_price: item.unit_price,\n              total_price: item.total_price,\n              status: item.status,\n              notes: item.item_id < 0 ? item.item?.name || null : null, // Save rodízio name in notes\n              metadata: item.item_id < 0 ? { \n                type: 'rodizio',\n                icon: item.item?.icon || (item as any).icon || null,\n                name: item.item?.name || null,\n                group_id: item.item?.group_id || null,\n                image: item.item?.image || null\n              } : null // Save rodízio metadata\n            }))\n          );\n\n        if (itemsError) throw itemsError;\n        \n        setCurrentOrder(orderData as any);\n        \n        // Process printing after saving order\n        await processPrinting(orderData.id);\n      }\n\n      await supabase\n        .from('table_sessions')\n        .update({ \n          total,\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', currentSession.id);\n\n      // Update cart items status to 'delivered' after saving (except for cancelled items)\n      setCart(prevCart => prevCart.map(item => ({\n        ...item,\n        status: item.status === 'cancelled' ? 'cancelled' : 'delivered'\n      })));\n      \n      toast.success(\"Pedido salvo com sucesso\");\n    } catch (error: any) {\n      console.error('Erro ao salvar pedido:', error);\n      console.error('Detalhes do erro:', {\n        message: error?.message,\n        details: error?.details,\n        hint: error?.hint,\n        code: error?.code,\n        fullError: JSON.stringify(error, null, 2)\n      });\n      toast.error(`Erro ao salvar pedido: ${error?.message || 'Erro desconhecido'}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n  */\n\n  const handleCompletePayment = async () => {\n    if (!currentOrder || !currentSession || !selectedTable) return;\n    \n    const totalPaid = payments.reduce((sum, p) => sum + p.amount, 0);\n    const totalDue = calculateTotalWithDiscount();\n    \n    if (totalPaid < totalDue - 0.01) {\n      toast.error('Valor pago insuficiente');\n      return;\n    }\n    \n    setLoading(true);\n    try {\n      // Save all payments to database\n      for (const payment of payments) {\n        const { error: paymentError } = await supabase\n          .from('payments')\n          .insert({\n            order_id: currentOrder.id,\n            amount: payment.amount,\n            payment_method: payment.method,\n            status: 'completed',\n            paid_at: new Date().toISOString()\n          });\n\n        if (paymentError) throw paymentError;\n      }\n\n      // Update order status\n      const { error: orderError } = await supabase\n        .from('orders')\n        .update({\n          status: 'completed',\n          discount_type: discountType,\n          discount_value: discountValue,\n          final_total: totalDue,\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', currentOrder.id);\n\n      if (orderError) throw orderError;\n\n      // Update session\n      const { error: sessionError } = await supabase\n        .from('table_sessions')\n        .update({\n          status: 'closed',\n          closed_at: new Date().toISOString(),\n          final_total: totalDue\n        })\n        .eq('id', currentSession.id);\n\n      if (sessionError) throw sessionError;\n\n      // Update table status\n      const { error: tableError } = await supabase\n        .from('restaurant_tables')\n        .update({ status: 'available' })\n        .eq('id', selectedTable.id);\n\n      if (tableError) throw tableError;\n\n      toast.success(\n        <div className=\"flex items-center gap-2\">\n          <Check className=\"h-4 w-4\" />\n          <span>Pagamento finalizado! Mesa liberada.</span>\n        </div>\n      );\n      \n      // Limpar tudo imediatamente e voltar para as mesas\n      setCart([]);\n      setCurrentOrder(null);\n      setCurrentSession(null);\n      setSelectedTable(null);\n      setPayments([]);\n      setDiscountValue(0);\n      setDiscountType('percentage');\n      setSplitCount(1);\n      setScreen('tables');\n      \n      // Recarregar tabelas para mostrar o novo status\n      await loadTables();\n      await loadTodayOrders();\n    } catch (error) {\n      console.error('Erro ao processar pagamento:', error);\n      toast.error('Erro ao processar pagamento');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handlePayment = async () => {\n    if (!currentOrder || !currentSession || !selectedTable) return;\n    \n    setLoading(true);\n    try {\n      const total = calculateTotal();\n      \n      const { error: paymentError } = await supabase\n        .from('payments')\n        .insert({\n          order_id: currentOrder.id,\n          amount: total,\n          payment_method: paymentMethod,\n          status: 'completed',\n          paid_at: new Date().toISOString()\n        });\n\n      if (paymentError) throw paymentError;\n\n      const { error: orderError } = await supabase\n        .from('orders')\n        .update({\n          status: 'completed',\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', currentOrder.id);\n\n      if (orderError) throw orderError;\n\n      const { error: sessionError } = await supabase\n        .from('table_sessions')\n        .update({\n          status: 'closed',\n          closed_at: new Date().toISOString(),\n          final_total: total\n        })\n        .eq('id', currentSession.id);\n\n      if (sessionError) throw sessionError;\n\n      const { error: tableError } = await supabase\n        .from('restaurant_tables')\n        .update({ status: 'available' })\n        .eq('id', selectedTable.id);\n\n      if (tableError) throw tableError;\n\n      toast.success(\n        <div className=\"flex items-center gap-2\">\n          <Check className=\"h-4 w-4\" />\n          <span>Pagamento confirmado! Mesa liberada.</span>\n        </div>\n      );\n      \n      setPaymentDialog(false);\n      setCart([]);\n      setCurrentOrder(null);\n      setCurrentSession(null);\n      setSelectedTable(null);\n      setScreen('tables');\n      \n      await loadTables();\n      await loadTodayOrders();\n    } catch (error) {\n      console.error('Erro ao processar pagamento:', error);\n      toast.error('Erro ao processar pagamento');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCloseSessionWithoutPayment = async () => {\n    if (!currentSession || !selectedTable) return;\n    \n    setLoading(true);\n    try {\n      if (currentOrder) {\n        await supabase\n          .from('orders')\n          .update({ status: 'cancelled' })\n          .eq('id', currentOrder.id);\n      }\n\n      await supabase\n        .from('table_sessions')\n        .update({\n          status: 'closed',\n          closed_at: new Date().toISOString(),\n          final_total: 0,\n          notes: 'Sessão cancelada sem consumo'\n        })\n        .eq('id', currentSession.id);\n\n      await supabase\n        .from('restaurant_tables')\n        .update({ status: 'available' })\n        .eq('id', selectedTable.id);\n\n      toast.success(`Mesa ${selectedTable.number} liberada`);\n      \n      setCloseSessionDialog(false);\n      setCart([]);\n      setCurrentOrder(null);\n      setCurrentSession(null);\n      setSelectedTable(null);\n      setScreen('tables');\n      \n      await loadTables();\n    } catch (error) {\n      console.error('Erro ao fechar sessão:', error);\n      toast.error('Erro ao fechar sessão');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handlePrintComanda = () => {\n    if (!currentOrder || cart.length === 0) {\n      toast.error(\"Nenhum pedido para imprimir\");\n      return;\n    }\n    \n    // Implementar impressão real aqui\n    toast.success(\"Comanda enviada para impressora\");\n    setPrintDialog(false);\n  };\n\n  // Filtros e busca\n  const filteredItems = useMemo(() => {\n    let filtered = items;\n    \n    // Se estiver na aba de carrinho, buscar em todos os produtos\n    // Se estiver na aba de categorias, respeitar o filtro de grupo/categoria\n    if (activeTab === 'categories') {\n      // Filtrar por grupo se selecionado\n      if (selectedGroup) {\n        filtered = filtered.filter(item => item.group_id === selectedGroup);\n      }\n      \n      // Filtrar por categoria se selecionado\n      if (selectedCategory) {\n        filtered = filtered.filter(item => item.category_id === selectedCategory);\n      }\n    }\n    // Na aba 'cart', não aplicar filtros de grupo/categoria, buscar em todos os produtos\n    \n    if (searchQuery) {\n      filtered = filtered.filter(item =>\n        item.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        item.id.toString().includes(searchQuery)\n      );\n    }\n    \n    return filtered;\n  }, [items, selectedGroup, selectedCategory, searchQuery, activeTab]);\n\n  // Formatação\n  const formatCurrency = (value: number) => {\n    if (value === 0) {\n      return 'Incluso';\n    }\n    return new Intl.NumberFormat('pt-BR', {\n      style: 'currency',\n      currency: 'BRL'\n    }).format(value);\n  };\n\n  // Modal de Rodízio - Fora de qualquer container para garantir renderização\n  const rodizioDialogModal = (\n    <Dialog open={rodizioModal} onOpenChange={setRodizioModal}>\n      <DialogContent className=\"sm:max-w-lg\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Package className=\"h-5 w-5 text-orange-400\" />\n            Lançar Rodízio - {selectedRodizioGroup?.name}\n          </DialogTitle>\n          <DialogDescription className=\"text-gray-400\">\n            Selecione a quantidade de rodízios\n          </DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"py-4 space-y-4\">\n          {/* Rodízio Inteiro */}\n          <div className=\"bg-gray-700/50 rounded-lg p-4\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <label className=\"text-sm font-medium\">\n                Rodízio Inteiro\n              </label>\n              <span className=\"text-orange-400 font-bold\">\n                {formatCurrency(selectedRodizioGroup?.price || 0)}\n              </span>\n            </div>\n            <div className=\"flex items-center justify-center gap-4\">\n              <Button\n                type=\"button\"\n                onClick={() => setRodizioInteiro(prev => Math.max(0, prev - 1))}\n                disabled={rodizioInteiro <= 0}\n                className=\"bg-gray-600 hover:bg-gray-500 disabled:opacity-50\"\n                size=\"sm\"\n                data-testid=\"button-rodizio-inteiro-decrement\"\n              >\n                <Minus className=\"h-4 w-4\" />\n              </Button>\n              \n              <div className=\"flex items-center\">\n                <Input\n                  type=\"number\"\n                  value={rodizioInteiro}\n                  onChange={(e) => setRodizioInteiro(Math.max(0, parseInt(e.target.value) || 0))}\n                  className=\"w-20 text-center bg-gray-700 border-gray-600 text-white [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none\"\n                  min=\"0\"\n                  data-testid=\"input-rodizio-inteiro\"\n                />\n              </div>\n              \n              <Button\n                type=\"button\"\n                onClick={() => setRodizioInteiro(prev => prev + 1)}\n                className=\"bg-gray-600 hover:bg-gray-500\"\n                size=\"sm\"\n                data-testid=\"button-rodizio-inteiro-increment\"\n              >\n                <Plus className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          </div>\n\n          {/* Meio Rodízio */}\n          <div className=\"bg-gray-700/50 rounded-lg p-4\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <label className=\"text-sm font-medium\">\n                Meio Rodízio\n              </label>\n              <span className=\"text-blue-400 font-bold\">\n                {formatCurrency(selectedRodizioGroup?.half_price || 0)}\n              </span>\n            </div>\n            <div className=\"flex items-center justify-center gap-4\">\n              <Button\n                type=\"button\"\n                onClick={() => setRodizioMeio(prev => Math.max(0, prev - 1))}\n                disabled={rodizioMeio <= 0}\n                className=\"bg-gray-600 hover:bg-gray-500 disabled:opacity-50\"\n                size=\"sm\"\n                data-testid=\"button-rodizio-meio-decrement\"\n              >\n                <Minus className=\"h-4 w-4\" />\n              </Button>\n              \n              <div className=\"flex items-center\">\n                <Input\n                  type=\"number\"\n                  value={rodizioMeio}\n                  onChange={(e) => setRodizioMeio(Math.max(0, parseInt(e.target.value) || 0))}\n                  className=\"w-20 text-center bg-gray-700 border-gray-600 text-white [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none\"\n                  min=\"0\"\n                  data-testid=\"input-rodizio-meio\"\n                />\n              </div>\n              \n              <Button\n                type=\"button\"\n                onClick={() => setRodizioMeio(prev => prev + 1)}\n                className=\"bg-gray-600 hover:bg-gray-500\"\n                size=\"sm\"\n                data-testid=\"button-rodizio-meio-increment\"\n              >\n                <Plus className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          </div>\n\n          {/* Total */}\n          <div className=\"bg-gray-800 rounded-lg p-4\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-lg font-medium\">Total:</span>\n              <div className=\"text-right\">\n                <div className=\"text-sm text-gray-400\">\n                  {rodizioInteiro > 0 && `${rodizioInteiro} inteiro${rodizioInteiro > 1 ? 's' : ''} `}\n                  {rodizioInteiro > 0 && rodizioMeio > 0 && '+ '}\n                  {rodizioMeio > 0 && `${rodizioMeio} meio${rodizioMeio > 1 ? 's' : ''}`}\n                </div>\n                <div className=\"text-xl font-bold text-orange-400\">\n                  {formatCurrency((rodizioInteiro * (selectedRodizioGroup?.price || 0)) + (rodizioMeio * (selectedRodizioGroup?.half_price || 0)))}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <DialogFooter>\n          <Button\n            variant=\"outline\"\n            onClick={() => setRodizioModal(false)}\n            className=\"bg-gray-700 hover:bg-gray-600 text-white border-gray-600\"\n            data-testid=\"button-rodizio-cancel\"\n          >\n            Cancelar\n          </Button>\n          <Button\n            onClick={handleAddRodizio}\n            disabled={rodizioInteiro === 0 && rodizioMeio === 0}\n            className=\"bg-orange-500 hover:bg-orange-600 text-white\"\n            data-testid=\"button-rodizio-confirm\"\n          >\n            Adicionar ao Pedido\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n\n  // RENDERIZAÇÃO CONDICIONAL POR TELA\n  let screenContent;\n\n  if (loading && screen === 'tables') {\n    screenContent = (\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 to-gray-800\">\n        <motion.div \n          initial={{ opacity: 0, scale: 0.8 }}\n          animate={{ opacity: 1, scale: 1 }}\n          className=\"text-white flex flex-col items-center gap-4\"\n        >\n          <RefreshCw className=\"h-8 w-8 animate-spin\" />\n          <span className=\"text-xl\">Carregando sistema...</span>\n        </motion.div>\n      </div>\n    );\n  }\n  // TELA 1: SELEÇÃO DE MESAS\n  else if (screen === 'tables') {\n    screenContent = (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 p-6\">\n        <div className=\"max-w-7xl mx-auto\">\n          {/* Header */}\n          <motion.div \n            initial={{ opacity: 0, y: -20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"mb-8\"\n          >\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h1 className=\"text-4xl font-bold text-white mb-2 flex items-center gap-3\">\n                  <Calculator className=\"h-10 w-10 text-orange-400\" />\n                  Caixa ComideX\n                </h1>\n              </div>\n              <div className=\"flex gap-2\">\n                <Button\n                  onClick={() => {\n                    // Se houver itens no carrinho, confirmar antes de sair\n                    if (cart.length > 0) {\n                      const action = confirm(\"Você tem itens não lançados no carrinho.\\n\\nDeseja lançar o pedido antes de sair?\\n\\nOK = Lançar e Sair\\nCancelar = Cancelar itens e Sair\");\n                      \n                      if (action) {\n                        // Lançar pedido antes de sair\n                        handleLaunchOrder().then(() => {\n                          window.location.href = '/';\n                        });\n                      } else {\n                        // Cancelar itens e sair\n                        setCart([]);\n                        window.location.href = '/';\n                      }\n                    } else {\n                      window.location.href = '/';\n                    }\n                  }}\n                  className=\"bg-red-600 hover:bg-red-700\"\n                >\n                  <Home className=\"mr-2 h-4 w-4\" />\n                  Voltar (ESC)\n                </Button>\n                <Button\n                  onClick={() => setScreen('history')}\n                  className=\"bg-gray-800 hover:bg-gray-700\"\n                >\n                  <History className=\"mr-2 h-4 w-4\" />\n                  Histórico (F9)\n                </Button>\n                <Button\n                  onClick={loadInitialData}\n                  className=\"bg-gray-800 hover:bg-gray-700\"\n                >\n                  <RefreshCw className=\"mr-2 h-4 w-4\" />\n                  Atualizar (F5)\n                </Button>\n              </div>\n            </div>\n          </motion.div>\n\n          {/* Estatísticas Animadas */}\n          <div className=\"grid grid-cols-4 gap-4 mb-8\">\n            {[\n              { label: 'Mesas Abertas', value: tables.filter(t => t.current_session).length, icon: Users, color: 'blue' },\n              { label: 'Mesas Livres', value: tables.filter(t => !t.current_session).length, icon: UtensilsCrossed, color: 'green' },\n              { label: 'Total de Mesas', value: tables.length, icon: Receipt, color: 'orange' },\n              { label: 'Hora Atual', value: format(new Date(), 'HH:mm'), icon: Clock, color: 'pink' }\n            ].map((stat, index) => (\n              <motion.div\n                key={stat.label}\n                initial={{ opacity: 0, scale: 0.8 }}\n                animate={{ opacity: 1, scale: 1 }}\n                transition={{ delay: index * 0.1 }}\n              >\n                <Card className=\"bg-gray-800/50 backdrop-blur border-gray-700 hover:bg-gray-800/70 transition-all\">\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"text-sm text-gray-400\">{stat.label}</p>\n                        <p className=\"text-2xl font-bold text-white\">\n                          {stat.value}\n                        </p>\n                      </div>\n                      <stat.icon className={`h-8 w-8 text-${stat.color}-400`} />\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n\n          {/* Grid de Mesas com Animação */}\n          <div className=\"grid grid-cols-8 gap-3\">\n            <AnimatePresence>\n              {tables.map((table, index) => (\n                <motion.div\n                  key={table.id}\n                  initial={{ opacity: 0, scale: 0.5 }}\n                  animate={{ opacity: 1, scale: 1 }}\n                  exit={{ opacity: 0, scale: 0.5 }}\n                  transition={{ delay: index * 0.02 }}\n                  whileHover={{ scale: 1.05 }}\n                  whileTap={{ scale: 0.95 }}\n                >\n                  <Card\n                    className={`\n                      cursor-pointer transition-all h-[160px]\n                      ${table.status === 'closed'\n                        ? 'bg-gradient-to-br from-red-900/40 to-red-800/30 border-red-600 shadow-red-600/20'\n                        : table.current_session \n                        ? 'bg-gradient-to-br from-orange-900/40 to-orange-800/30 border-orange-600 shadow-orange-600/20' \n                        : 'bg-gray-800/50 backdrop-blur border-gray-700 hover:bg-gray-700/50'}\n                      shadow-lg hover:shadow-xl\n                    `}\n                    onClick={() => handleSelectTable(table)}\n                  >\n                    <CardContent className=\"p-4 text-center relative h-full flex flex-col justify-between\">\n                      {table.current_session && (\n                        <div className=\"absolute -top-2 -right-2\">\n                          <div className=\"relative\">\n                            <div className=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-orange-400 opacity-75\"></div>\n                            <div className=\"relative inline-flex rounded-full h-3 w-3 bg-orange-500\"></div>\n                          </div>\n                        </div>\n                      )}\n                      \n                      <div>\n                        <div className=\"mb-1 h-8 flex items-center justify-center\">\n                          {table.type === 'counter' ? (\n                            // Ícone de Cadeira Alta de Bar\n                            <div className=\"relative flex flex-col items-center\">\n                              <div className=\"w-4 h-3 bg-white/90 rounded-t-md\"></div>\n                              <div className=\"w-0.5 h-4 bg-white/80\"></div>\n                              <div className=\"w-3 h-0.5 bg-white/70\"></div>\n                            </div>\n                          ) : (\n                            // Ícone de Mesa - quadrado com cadeiras ao redor\n                            <div className=\"relative\">\n                              <div className=\"w-5 h-5 bg-white/90 rounded-sm\"></div>\n                              <div className=\"absolute -top-1 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-white/70 rounded-full\"></div>\n                              <div className=\"absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-white/70 rounded-full\"></div>\n                              <div className=\"absolute top-1/2 -left-1 transform -translate-y-1/2 w-1 h-1 bg-white/70 rounded-full\"></div>\n                              <div className=\"absolute top-1/2 -right-1 transform -translate-y-1/2 w-1 h-1 bg-white/70 rounded-full\"></div>\n                            </div>\n                          )}\n                        </div>\n                        <h3 className=\"text-lg font-bold text-white\">\n                          {table.type === 'counter' ? 'Balcão ' : 'Mesa '}{table.number}\n                        </h3>\n                      </div>\n                      \n                      <div>\n                        {table.status === 'closed' ? (\n                          <>\n                            <Badge className=\"bg-red-600 text-white text-xs py-0.5 mb-1\">\n                              FECHADA\n                            </Badge>\n                            <div className=\"text-xs text-gray-300 mt-1 space-y-1\">\n                              {table.current_session && (\n                                <div className=\"flex items-center justify-center gap-1\">\n                                  <Users className=\"h-3 w-3\" />\n                                  <span>{table.current_session.customer_count} {table.current_session.customer_count === 1 ? 'pessoa' : 'pessoas'}</span>\n                                </div>\n                              )}\n                            </div>\n                          </>\n                        ) : table.current_session ? (\n                          <>\n                            <Badge className=\"bg-orange-600 text-white text-xs py-0.5 mb-1\">\n                              OCUPADA\n                            </Badge>\n                            <div className=\"text-xs text-gray-300 mt-1 space-y-1\">\n                              <div className=\"flex items-center justify-center gap-1\">\n                                <Users className=\"h-3 w-3\" />\n                                <span>{table.current_session.customer_count} {table.current_session.customer_count === 1 ? 'pessoa' : 'pessoas'}</span>\n                              </div>\n                            </div>\n                          </>\n                        ) : (\n                          <>\n                            <Badge className=\"bg-green-600 text-white text-xs py-0.5 mb-1\">\n                              LIVRE\n                            </Badge>\n                            <div className=\"text-xs text-gray-500 mt-2\">\n                              <p>Disponível</p>\n                            </div>\n                          </>\n                        )}\n                      </div>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </AnimatePresence>\n          </div>\n\n          {/* Atalhos de Teclado */}\n          <motion.div \n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.5 }}\n            className=\"mt-8 flex justify-center\"\n          >\n            <Card className=\"bg-gray-800/50 backdrop-blur border-gray-700\">\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-center gap-6 text-sm text-gray-400\">\n                  <span className=\"flex items-center gap-2\">\n                    <Keyboard className=\"h-4 w-4\" />\n                    Atalhos:\n                  </span>\n                  <span><kbd className=\"px-2 py-1 bg-gray-700 rounded\">F1</kbd> Mesas</span>\n                  <span><kbd className=\"px-2 py-1 bg-gray-700 rounded\">F3</kbd> Pagar</span>\n                  <span><kbd className=\"px-2 py-1 bg-gray-700 rounded\">F4</kbd> Imprimir</span>\n                  <span><kbd className=\"px-2 py-1 bg-gray-700 rounded\">F5</kbd> Atualizar</span>\n                  <span><kbd className=\"px-2 py-1 bg-gray-700 rounded\">F9</kbd> Histórico</span>\n                  <span><kbd className=\"px-2 py-1 bg-gray-700 rounded\">ESC</kbd> Fechar</span>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        </div>\n\n        {/* Dialog Rodízio */}\n        <Dialog open={rodizioModal} onOpenChange={setRodizioModal}>\n          <DialogContent className=\"fixed left-[50%] top-[50%] z-[9999] w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-gray-700 bg-gray-800 p-6 shadow-lg sm:rounded-lg text-white\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2\">\n                <Package className=\"h-5 w-5 text-orange-400\" />\n                Lançar Rodízio - {selectedRodizioGroup?.name}\n              </DialogTitle>\n              <DialogDescription className=\"text-gray-400\">\n                Selecione a quantidade de rodízios\n              </DialogDescription>\n            </DialogHeader>\n            \n            <div className=\"py-4 space-y-4\">\n              {/* Rodízio Inteiro */}\n              <div className=\"bg-gray-700/50 rounded-lg p-4\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <label className=\"text-sm font-medium\">\n                    Rodízio Inteiro\n                  </label>\n                  <span className=\"text-orange-400 font-bold\">\n                    {formatCurrency(selectedRodizioGroup?.price || 0)}\n                  </span>\n                </div>\n                <div className=\"flex items-center justify-center gap-4\">\n                  <Button\n                    type=\"button\"\n                    onClick={() => setRodizioInteiro(prev => Math.max(0, prev - 1))}\n                    disabled={rodizioInteiro <= 0}\n                    className=\"bg-gray-600 hover:bg-gray-500 disabled:opacity-50\"\n                    size=\"sm\"\n                    data-testid=\"button-rodizio-inteiro-decrement\"\n                  >\n                    <Minus className=\"h-4 w-4\" />\n                  </Button>\n                  \n                  <div className=\"flex items-center gap-2\">\n                    <Input\n                      type=\"number\"\n                      min=\"0\"\n                      value={rodizioInteiro}\n                      onChange={(e) => {\n                        const value = parseInt(e.target.value) || 0;\n                        setRodizioInteiro(Math.max(0, value));\n                      }}\n                      className=\"bg-gray-700 border-gray-600 text-white text-xl w-20 text-center [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none\"\n                    />\n                    <span className=\"text-gray-400 text-sm\">\n                      = {formatCurrency((selectedRodizioGroup?.price || 0) * rodizioInteiro)}\n                    </span>\n                  </div>\n                  \n                  <Button\n                    type=\"button\"\n                    onClick={() => setRodizioInteiro(prev => prev + 1)}\n                    className=\"bg-gray-600 hover:bg-gray-500\"\n                    size=\"sm\"\n                    data-testid=\"button-rodizio-inteiro-increment\"\n                  >\n                    <Plus className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n\n              {/* Rodízio Meio - só mostra se tem preço configurado */}\n              {selectedRodizioGroup?.half_price && selectedRodizioGroup.half_price > 0 && (\n                <div className=\"bg-gray-700/50 rounded-lg p-4\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <label className=\"text-sm font-medium\">\n                      Rodízio Meio (Crianças)\n                    </label>\n                    <span className=\"text-orange-400 font-bold\">\n                      {formatCurrency(selectedRodizioGroup.half_price)}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center justify-center gap-4\">\n                    <Button\n                      type=\"button\"\n                      onClick={() => setRodizioMeio(prev => Math.max(0, prev - 1))}\n                      disabled={rodizioMeio <= 0}\n                      className=\"bg-gray-600 hover:bg-gray-500 disabled:opacity-50\"\n                      size=\"sm\"\n                      data-testid=\"button-rodizio-meio-decrement\"\n                    >\n                      <Minus className=\"h-4 w-4\" />\n                    </Button>\n                    \n                    <div className=\"flex items-center gap-2\">\n                      <Input\n                        type=\"number\"\n                        min=\"0\"\n                        value={rodizioMeio}\n                        onChange={(e) => {\n                          const value = parseInt(e.target.value) || 0;\n                          setRodizioMeio(Math.max(0, value));\n                        }}\n                        className=\"bg-gray-700 border-gray-600 text-white text-xl w-20 text-center [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none\"\n                      />\n                      <span className=\"text-gray-400 text-sm\">\n                        = {formatCurrency(selectedRodizioGroup.half_price * rodizioMeio)}\n                      </span>\n                    </div>\n                    \n                    <Button\n                      type=\"button\"\n                      onClick={() => setRodizioMeio(prev => prev + 1)}\n                      className=\"bg-gray-600 hover:bg-gray-500\"\n                      size=\"sm\"\n                      data-testid=\"button-rodizio-meio-increment\"\n                    >\n                      <Plus className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              )}\n              \n              {/* Total */}\n              <div className=\"bg-gray-900 rounded-lg p-4 border border-orange-500/30\">\n                <div className=\"flex justify-between items-center text-xl font-bold\">\n                  <span>Total:</span>\n                  <span className=\"text-orange-400\">\n                    {formatCurrency(\n                      (selectedRodizioGroup?.price || 0) * rodizioInteiro +\n                      (selectedRodizioGroup?.half_price || 0) * rodizioMeio\n                    )}\n                  </span>\n                </div>\n              </div>\n            </div>\n            \n            <DialogFooter>\n              <Button\n                onClick={() => setRodizioModal(false)}\n                variant=\"ghost\"\n                className=\"text-gray-300 hover:text-white hover:bg-gray-700\"\n              >\n                Cancelar\n              </Button>\n              <Button\n                onClick={handleAddRodizio}\n                disabled={rodizioInteiro === 0 && rodizioMeio === 0}\n                className=\"bg-orange-600 hover:bg-orange-700 disabled:opacity-50\"\n              >\n                Confirmar Rodízio\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        {/* Dialog Abrir Mesa */}\n        <Dialog open={openTableDialog} onOpenChange={setOpenTableDialog}>\n          <DialogContent className=\"bg-gray-800 text-white border-gray-700\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2\">\n                {selectedTable?.type === 'counter' ? (\n                  // Ícone de Cadeira Alta\n                  <div className=\"relative flex flex-col items-center h-5\">\n                    <div className=\"w-3 h-2 bg-current rounded-t-sm\"></div>\n                    <div className=\"w-0.5 h-2.5 bg-current opacity-80\"></div>\n                    <div className=\"w-2 h-0.5 bg-current opacity-70\"></div>\n                  </div>\n                ) : (\n                  // Ícone de Mesa\n                  <div className=\"relative\">\n                    <div className=\"w-4 h-4 bg-current rounded-sm\"></div>\n                    <div className=\"absolute -top-0.5 left-1/2 transform -translate-x-1/2 w-0.5 h-0.5 bg-current rounded-full opacity-70\"></div>\n                    <div className=\"absolute -bottom-0.5 left-1/2 transform -translate-x-1/2 w-0.5 h-0.5 bg-current rounded-full opacity-70\"></div>\n                    <div className=\"absolute top-1/2 -left-0.5 transform -translate-y-1/2 w-0.5 h-0.5 bg-current rounded-full opacity-70\"></div>\n                    <div className=\"absolute top-1/2 -right-0.5 transform -translate-y-1/2 w-0.5 h-0.5 bg-current rounded-full opacity-70\"></div>\n                  </div>\n                )}\n                Abrir {selectedTable?.type === 'counter' ? 'Balcão' : 'Mesa'} {selectedTable?.number}\n              </DialogTitle>\n              <DialogDescription className=\"text-gray-400\">\n                Confirme a abertura da mesa\n              </DialogDescription>\n            </DialogHeader>\n            \n            <div className=\"py-4 space-y-4\">\n              <div className=\"bg-gray-700/50 rounded-lg p-4 text-center\">\n                <p className=\"text-lg\">\n                  Deseja abrir {selectedTable?.type === 'counter' ? 'o balcão' : 'a mesa'} {selectedTable?.number}?\n                </p>\n              </div>\n              \n              {/* Campo de quantidade de pessoas */}\n              <div>\n                <label className=\"block text-sm mb-2 text-gray-300\">\n                  Quantidade de Pessoas\n                </label>\n                <div className=\"flex items-center justify-center gap-4\">\n                  <Button\n                    type=\"button\"\n                    onClick={() => setCustomerCount(prev => Math.max(1, prev - 1))}\n                    disabled={customerCount <= 1}\n                    className=\"bg-gray-700 hover:bg-gray-600 disabled:opacity-50\"\n                    size=\"sm\"\n                    data-testid=\"button-decrement-pessoas\"\n                  >\n                    <Minus className=\"h-4 w-4\" />\n                  </Button>\n                  \n                  <Input\n                    type=\"number\"\n                    min=\"1\"\n                    value={customerCount}\n                    onChange={(e) => {\n                      const value = parseInt(e.target.value) || 1;\n                      setCustomerCount(Math.max(1, value));\n                    }}\n                    className=\"bg-gray-800 border-gray-600 text-white text-2xl w-20 text-center [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none\"\n                    pattern=\"[0-9]*\"\n                  />\n                  \n                  <Button\n                    type=\"button\"\n                    onClick={() => setCustomerCount(prev => prev + 1)}\n                    className=\"bg-gray-700 hover:bg-gray-600\"\n                    size=\"sm\"\n                    data-testid=\"button-increment-pessoas\"\n                  >\n                    <Plus className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n            \n            <DialogFooter>\n              <Button\n                onClick={() => setOpenTableDialog(false)}\n                className=\"bg-gray-700 hover:bg-gray-600\"\n              >\n                Cancelar\n              </Button>\n              <Button\n                onClick={handleOpenTable}\n                disabled={loading}\n                className=\"bg-orange-600 hover:bg-orange-700\"\n              >\n                {loading ? (\n                  <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                ) : (\n                  <>\n                    <Check className=\"mr-2 h-4 w-4\" />\n                    Abrir Mesa\n                  </>\n                )}\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    );\n  }\n  // TELA 2: SESSÃO/PEDIDOS MELHORADA\n  else if (screen === 'session') {\n    screenContent = (\n      <div className=\"h-screen bg-gradient-to-br from-gray-900 to-gray-800 text-white flex flex-col\">\n        {/* Header Melhorado com Design Aprimorado */}\n        <div className=\"bg-gradient-to-r from-gray-900 to-gray-800 backdrop-blur px-6 py-4 border-b-2 border-orange-600/30\">\n          <div className=\"flex items-center justify-between\">\n            {/* Lado Esquerdo - Informações da Mesa */}\n            <div className=\"flex items-center gap-6\">\n              <Button\n                onClick={() => setScreen('tables')}\n                size=\"lg\"\n                className=\"bg-gray-800 hover:bg-gray-700 border border-gray-600 h-12 px-4\"\n              >\n                <ArrowLeft className=\"h-5 w-5\" />\n              </Button>\n              \n              {/* Informação Principal da Mesa */}\n              <div className=\"flex items-center gap-8\">\n                {/* Mesa/Balcão com Tipo de Atendimento Inteligente */}\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"bg-orange-600 p-3 rounded-lg\">\n                    {(() => {\n                      // Detectar ícone baseado no grupo dos itens\n                      if (cart.length > 0 && cart[0]?.item?.group_id) {\n                        const group = groups.find(g => g.id === cart[0].item?.group_id);\n                        if (group?.icon) {\n                          const IconComponent = getIconByName(group.icon);\n                          if (IconComponent) {\n                            return <IconComponent className=\"h-6 w-6 text-white\" />;\n                          }\n                        }\n                      }\n                      return <UtensilsCrossed className=\"h-6 w-6 text-white\" />;\n                    })()}\n                  </div>\n                  <div>\n                    <h2 className=\"text-2xl font-bold text-white\">\n                      {selectedTable?.type === 'counter' ? 'Balcão' : 'Mesa'} {selectedTable?.number}\n                    </h2>\n                    <p className=\"text-sm text-gray-400\">\n                      {(() => {\n                        // Detectar tipo de atendimento baseado nos itens do carrinho\n                        if (cart.length > 0) {\n                          // Buscar grupos baseado no group_id dos items\n                          const groupsInCart: Group[] = [];\n                          const groupNames: string[] = [];\n                          \n                          cart.forEach(cartItem => {\n                            if (cartItem.item?.group_id) {\n                              const group = groups.find(g => g.id === cartItem.item?.group_id);\n                              if (group && !groupNames.includes(group.name)) {\n                                groupsInCart.push(group);\n                                groupNames.push(group.name);\n                              }\n                            }\n                          });\n                          \n                          // Prioridade 1: Rodízio (pegar o nome completo)\n                          const rodizioGroup = groupsInCart.find(g => \n                            g.type === 'rodizio' ||\n                            g.name?.toLowerCase().includes('rodizio') || \n                            g.name?.toLowerCase().includes('rodízio')\n                          );\n                          \n                          if (rodizioGroup) {\n                            return `${rodizioGroup.name}`;\n                          }\n                          \n                          // Prioridade 2: À la Carte\n                          const carteGroup = groupsInCart.find(g => \n                            g.name?.toLowerCase().includes('carte') ||\n                            g.name?.toLowerCase().includes('la carte') ||\n                            g.name?.toLowerCase().includes('à la carte')\n                          );\n                          \n                          if (carteGroup) {\n                            return 'Atendimento À la Carte';\n                          }\n                          \n                          // Prioridade 3: Delivery ou outros tipos especiais\n                          const deliveryGroup = groupsInCart.find(g => \n                            g.name?.toLowerCase().includes('delivery') ||\n                            g.name?.toLowerCase().includes('entrega')\n                          );\n                          \n                          if (deliveryGroup) {\n                            return 'Pedido Delivery';\n                          }\n                          \n                          // Se tem grupos mistos\n                          if (groupNames.length > 1) {\n                            return 'Atendimento Misto';\n                          }\n                          \n                          // Se tem apenas um grupo, mostrar o nome dele\n                          if (groupNames.length === 1) {\n                            return groupNames[0];\n                          }\n                        }\n                        \n                        // Valor padrão baseado no tipo da mesa\n                        return selectedTable?.type === 'counter' ? 'Atendimento no balcão' : 'Aguardando pedido';\n                      })()}\n                    </p>\n                  </div>\n                </div>\n                \n                {/* Separador Visual */}\n                <div className=\"h-12 w-px bg-gray-600\" />\n                \n                {/* Pessoas */}\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"bg-blue-600 p-3 rounded-lg\">\n                    <Users className=\"h-6 w-6 text-white\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-xl font-semibold text-white\">\n                      {currentSession?.customer_count || 0} {(currentSession?.customer_count || 0) === 1 ? 'Pessoa' : 'Pessoas'}\n                    </h3>\n                    <p className=\"text-sm text-gray-400\">Capacidade: {selectedTable?.capacity || 4} pessoas</p>\n                  </div>\n                </div>\n                \n                {/* Separador Visual */}\n                <div className=\"h-12 w-px bg-gray-600\" />\n                \n                {/* Horário */}\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"bg-green-600 p-3 rounded-lg\">\n                    <Clock className=\"h-6 w-6 text-white\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-xl font-semibold text-white\">\n                      {currentSession && format(new Date(currentSession.opened_at), 'HH:mm')}\n                    </h3>\n                    <p className=\"text-sm text-gray-400\">\n                      Aberta há {currentSession && (() => {\n                        const diff = new Date().getTime() - new Date(currentSession.opened_at).getTime();\n                        const minutes = Math.abs(Math.floor(diff / 60000));\n                        const hours = Math.floor(minutes / 60);\n                        const mins = minutes % 60;\n                        return hours > 0 ? `${hours}h ${mins}min` : `${mins} minutos`;\n                      })()}\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n            \n            {/* Lado Direito - Informação de Status */}\n            <div className=\"flex items-center gap-4\">\n              {/* Status da Mesa */}\n              <div className=\"bg-gray-800/50 px-4 py-2 rounded-lg border border-gray-600\">\n                <p className=\"text-xs text-gray-400\">Status</p>\n                <p className=\"text-sm font-bold text-green-400\">Mesa Ativa</p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Main Content com Layout 70/30 */}\n        <div className=\"flex flex-1 overflow-hidden\">\n          {/* Left Panel 70% - Carrinho e Categorias ou Interface de Pagamento */}\n          <div className=\"w-[70%] flex flex-col border-r border-gray-700 overflow-hidden\">\n            {/* Se a mesa está fechada, mostra interface de pagamento */}\n            {selectedTable?.status === 'closed' ? (\n              <div className=\"flex-1 p-4\">\n                <PaymentWorkspace\n                  mode=\"embedded\"\n                  groupedItems={groupedItems}\n                  calculateSubtotal={calculateSubtotal}\n                  calculateTotal={calculateTotal}\n                  calculateTotalWithDiscount={calculateTotalWithDiscount}\n                  serviceTaxPercentage={serviceTaxPercentage}\n                  serviceTaxValue={calculateServiceTax()}\n                  discountType={discountType}\n                  setDiscountType={setDiscountType}\n                  discountValue={discountValue}\n                  setDiscountValue={setDiscountValue}\n                  splitCount={splitCount}\n                  setSplitCount={setSplitCount}\n                  calculatorDisplay={calculatorDisplay}\n                  setCalculatorDisplay={setCalculatorDisplay}\n                  payments={payments}\n                  addPayment={addPayment}\n                  removePayment={removePayment}\n                  handleCompletePayment={handleCompletePayment}\n                  reopenTable={reopenTable}\n                  selectedTable={selectedTable}\n                  loading={loading}\n                />\n              </div>\n            ) : (\n              <Tabs value={activeTab} onValueChange={setActiveTab} className=\"flex-1 flex flex-col p-4 pb-0 overflow-hidden\">\n              {/* Input Section com Tabs */}\n              <Card className=\"bg-gray-900/50 backdrop-blur border-gray-700 mb-4 overflow-visible\">\n                <CardContent className=\"p-3 overflow-visible\">\n                  <div className=\"flex gap-2\">\n                    <div className=\"flex-1\">\n                      <div className=\"relative\">\n                        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n                        <Input\n                          ref={codeInputRef}\n                          value={inputValue}\n                          onChange={(e) => {\n                            setInputValue(e.target.value);\n                            setSearchQuery(e.target.value);\n                            setQuantity(\"1\"); // Reset quantity to 1 when searching\n                          }}\n                          onFocus={() => setActiveInput(\"code\")}\n                          onKeyPress={(e) => {\n                            if (e.key === \"Enter\") {\n                              if (searchQuery && filteredItems.length > 0) {\n                                handleAddItem(filteredItems[0]);\n                                setInputValue(\"\");\n                                setSearchQuery(\"\");\n                                setQuantity(\"1\");\n                              } else {\n                                handleAddItem();\n                              }\n                            }\n                          }}\n                          className=\"bg-gray-800 border-gray-600 text-white text-lg h-10 pl-9 pr-10\"\n                          placeholder=\"Buscar produto...\"\n                        />\n                        {inputValue && (\n                          <button\n                            onClick={() => {\n                              setInputValue(\"\");\n                              setSearchQuery(\"\");\n                              codeInputRef.current?.focus();\n                            }}\n                            className=\"absolute right-2 top-1/2 -translate-y-1/2 h-6 w-6 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center justify-center transition-colors\"\n                            type=\"button\"\n                            data-testid=\"clear-search\"\n                          >\n                            <X className=\"h-3 w-3 text-gray-300\" />\n                          </button>\n                        )}\n                      </div>\n                    </div>\n                    <TabsList className=\"bg-gray-800 border-gray-700 h-10\">\n                      <TabsTrigger value=\"cart\" className=\"data-[state=active]:bg-orange-600 h-full px-3\">\n                        <ShoppingCart className=\"mr-2 h-4 w-4\" />\n                        Carrinho\n                      </TabsTrigger>\n                      <TabsTrigger value=\"categories\" className=\"data-[state=active]:bg-orange-600 h-full px-3\">\n                        <ShoppingBag className=\"mr-2 h-4 w-4\" />\n                        Produtos\n                      </TabsTrigger>\n                    </TabsList>\n                  </div>\n                </CardContent>\n              </Card>\n              <TabsContent value=\"cart\" className=\"flex-1 flex flex-col overflow-hidden min-h-0\">\n                {/* Portal para Resultados da Busca em Tempo Real */}\n                {searchQuery.length > 0 && typeof document !== 'undefined' && createPortal(\n                        <div className=\"fixed z-[99999] bg-gray-900 rounded-lg border-2 border-orange-500 shadow-2xl\"\n                             style={{ \n                               top: codeInputRef.current ? codeInputRef.current.getBoundingClientRect().bottom + 8 : '50%',\n                               left: codeInputRef.current ? codeInputRef.current.getBoundingClientRect().left : '50%',\n                               width: codeInputRef.current ? codeInputRef.current.getBoundingClientRect().width : '400px',\n                               transform: codeInputRef.current ? 'none' : 'translate(-50%, -50%)'\n                             }}>\n                          {filteredItems.length === 0 ? (\n                            <div className=\"text-gray-400 p-4 text-center\">\n                              Nenhum produto encontrado para \"{searchQuery}\"\n                            </div>\n                          ) : (\n                            <ScrollArea className=\"h-[400px] w-full\">\n                              <div className=\"p-2\">\n                                {filteredItems.map((item) => (\n                                  <button\n                                    key={item.id}\n                                    data-testid={`search-result-${item.id}`}\n                                    className=\"w-full flex items-center p-2 hover:bg-gray-800 rounded-lg transition-all group\"\n                                    onClick={() => {\n                                      handleAddItem(item);\n                                      setInputValue(\"\");\n                                      setSearchQuery(\"\");\n                                    }}\n                                  >\n                                    {/* Foto do produto */}\n                                    <div className=\"w-14 h-14 bg-gray-700 rounded-lg mr-3 flex-shrink-0 overflow-hidden\">\n                                      <img\n                                        src={item.image || '/fotos/placeholder/placeholder.png'}\n                                        alt={item.name}\n                                        className=\"w-full h-full object-cover\"\n                                        onError={(e) => {\n                                          const target = e.target as HTMLImageElement;\n                                          target.src = '/fotos/placeholder/placeholder.png';\n                                        }}\n                                      />\n                                    </div>\n                                    \n                                    {/* Informações do produto */}\n                                    <div className=\"flex-1 text-left\">\n                                      <div className=\"font-medium text-white group-hover:text-orange-400 transition-colors\">\n                                        {item.name}\n                                      </div>\n                                      <div className=\"text-xs text-gray-400\">\n                                        {item.group?.name || '—'} • {item.category?.name || '—'}\n                                      </div>\n                                    </div>\n                                    \n                                    {/* Valor */}\n                                    <div className=\"text-right\">\n                                      <div className=\"font-bold text-orange-400\">\n                                        {item.price ? formatCurrency(item.price) : 'Sem preço'}\n                                      </div>\n                                    </div>\n                                  </button>\n                                ))}\n                              </div>\n                            </ScrollArea>\n                          )}\n                        </div>,\n                        document.body\n                      )}\n\n                {/* Lista de Itens Animada */}\n                <Card className=\"flex-1 bg-gray-900/50 backdrop-blur border-gray-700 overflow-hidden flex flex-col min-h-0\">\n                  <CardHeader className=\"pb-3 flex-shrink-0\">\n                    <CardTitle className=\"text-lg flex items-center justify-between\">\n                      <span className=\"flex items-center gap-2\">\n                        <ShoppingBag className=\"h-5 w-5 text-orange-400\" />\n                        Itens do Pedido\n                      </span>\n                      <button\n                        onClick={() => {\n                          // Ciclar entre os modos: all -> delivered -> cancelled -> all\n                          if (filterMode === 'all') {\n                            setFilterMode('delivered');\n                          } else if (filterMode === 'delivered') {\n                            setFilterMode('cancelled');\n                          } else {\n                            setFilterMode('all');\n                          }\n                        }}\n                        className={`px-4 py-1 rounded-md text-sm font-medium transition-all ${\n                          filterMode === 'all' \n                            ? 'bg-orange-600 text-white' \n                            : filterMode === 'delivered'\n                            ? 'bg-green-600 text-white'\n                            : 'bg-red-600 text-white'\n                        }`}\n                        data-testid=\"filter-toggle\"\n                      >\n                        {filterMode === 'all' ? (\n                          <span className=\"flex items-center gap-1\">\n                            <ShoppingCart className=\"h-4 w-4\" />\n                            Todos\n                          </span>\n                        ) : filterMode === 'delivered' ? (\n                          <span className=\"flex items-center gap-1\">\n                            <CheckCircle2 className=\"h-4 w-4\" />\n                            Lançados\n                          </span>\n                        ) : (\n                          <span className=\"flex items-center gap-1\">\n                            <XCircle className=\"h-4 w-4\" />\n                            Cancelados\n                          </span>\n                        )}\n                      </button>\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"p-4 pt-0 flex-1 overflow-hidden\">\n                    <div className=\"relative h-full\">\n                      <ScrollArea ref={cartScrollRef} className=\"h-full pr-4\" style={{ willChange: 'scroll-position' }}>\n                        {(() => {\n                          const filteredCart = filterMode === 'cancelled' \n                            ? cart.filter(item => item.status === 'cancelled')\n                            : filterMode === 'delivered'\n                            ? cart.filter(item => item.status === 'delivered')\n                            : cart;\n                          \n                          return filteredCart.length === 0 ? (\n                            <div className=\"flex items-center justify-center h-full\">\n                              <div className=\"text-center text-gray-500\">\n                                {filterMode === 'cancelled' ? (\n                                  <>\n                                    <XCircle className=\"h-16 w-16 mx-auto mb-4 opacity-50\" />\n                                    <p>Nenhum item cancelado</p>\n                                    <p className=\"text-sm mt-2\">Clique em \"Todos\" para ver todos os itens</p>\n                                  </>\n                                ) : filterMode === 'delivered' ? (\n                                  <>\n                                    <CheckCircle2 className=\"h-16 w-16 mx-auto mb-4 opacity-50\" />\n                                    <p>Nenhum item lançado</p>\n                                    <p className=\"text-sm mt-2\">Lance os itens primeiro ou clique em \"Todos\"</p>\n                                  </>\n                                ) : (\n                                  <>\n                                    <ShoppingCart className=\"h-16 w-16 mx-auto mb-4 opacity-50\" />\n                                    <p>Carrinho vazio</p>\n                                    <p className=\"text-sm mt-2\">Adicione produtos usando o código ou busca</p>\n                                  </>\n                                )}\n                              </div>\n                            </div>\n                          ) : (\n                            <AnimatePresence>\n                              {filteredCart.slice().reverse().map((item, index) => (\n                            <motion.div\n                              key={`${item.item_id}-${index}`}\n                              initial={{ opacity: 0, y: -20 }}\n                              animate={{ opacity: 1, y: 0 }}\n                              exit={{ opacity: 0, x: 50 }}\n                              transition={{ duration: 0.15 }}\n                              className=\"mb-2\"\n                            >\n                              <Card className={`backdrop-blur transition-all ${\n                                item.status === 'delivered' \n                                  ? 'bg-green-900/20 border-green-700/50'\n                                  : item.status === 'cancelled'\n                                  ? 'bg-red-900/30 border-red-600'\n                                  : 'bg-gray-800/50 border-gray-700 hover:bg-gray-800/70'\n                              }`}>\n                                <CardContent className=\"p-3 relative\">\n                                  {/* Horário - centralizado com transform */}\n                                  {(item.status === 'delivered' || item.status === 'cancelled') && item.launched_at && (\n                                    <div className=\"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none z-10\">\n                                      <div className={`${item.status === 'delivered' ? 'text-green-400' : 'text-red-400'} flex flex-col items-center justify-center`}>\n                                        <Clock className=\"h-3 w-3 mb-1\" />\n                                        <div className=\"flex items-center\">\n                                          {(() => {\n                                            const date = new Date(item.launched_at);\n                                            const hours = date.getHours().toString().padStart(2, '0');\n                                            const minutes = date.getMinutes().toString().padStart(2, '0');\n                                            const seconds = date.getSeconds().toString().padStart(2, '0');\n                                            return (\n                                              <>\n                                                <span className=\"text-sm font-medium\">{hours}:{minutes}</span>\n                                                <span className=\"text-[11px] font-normal opacity-80\">:{seconds}</span>\n                                              </>\n                                            );\n                                          })()}\n                                        </div>\n                                      </div>\n                                    </div>\n                                  )}\n                                  \n                                  <div className=\"flex items-center justify-between\">\n                                    {/* Foto do produto */}\n                                    <div className=\"w-14 h-14 bg-gray-700 rounded-lg mr-3 flex-shrink-0 overflow-hidden\">\n                                      {item.item?.image ? (\n                                        <img\n                                          src={item.item.image}\n                                          alt={item.item?.name || ''}\n                                          className=\"w-full h-full object-cover\"\n                                        />\n                                      ) : (item as any).icon || item.item?.icon ? (\n                                        <div className=\"w-full h-full flex items-center justify-center text-orange-400\">\n                                          {(() => {\n                                            const iconName = (item as any).icon || item.item?.icon;\n                                            const IconComponent = getIconByName(iconName);\n                                            return IconComponent ? <IconComponent className=\"h-6 w-6\" /> : <Package className=\"h-6 w-6\" />;\n                                          })()}\n                                        </div>\n                                      ) : (\n                                        <div className=\"w-full h-full flex items-center justify-center\">\n                                          <img\n                                            src=\"/fotos/placeholder/placeholder.png\"\n                                            alt=\"Placeholder\"\n                                            className=\"w-full h-full object-cover\"\n                                            onError={(e) => {\n                                              const target = e.target as HTMLImageElement;\n                                              target.style.display = 'none';\n                                              const parent = target.parentElement;\n                                              if (parent) {\n                                                parent.innerHTML = '<div class=\"w-full h-full flex items-center justify-center text-gray-500\"><svg class=\"h-6 w-6\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"/><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"9\"/><line x1=\"9\" y1=\"15\" x2=\"15\" y2=\"15\"/></svg></div>';\n                                              }\n                                            }}\n                                          />\n                                        </div>\n                                      )}\n                                    </div>\n                                    \n                                    {/* Nome e preço - flex como era antes */}\n                                    <div className=\"flex-1\">\n                                      <div className=\"font-medium flex items-center\">\n                                        <span className={`${\n                                          item.status === 'cancelled' \n                                            ? 'text-red-500 line-through decoration-red-600 decoration-2' \n                                            : 'text-white'\n                                        }`}>\n                                          {item.item?.name || `Produto ${item.item_id}`}\n                                        </span>\n                                        {item.status === 'cancelled' && (\n                                          <span className=\"text-xs text-red-600 font-bold ml-2 uppercase\">\n                                            CANCELADO\n                                          </span>\n                                        )}\n                                      </div>\n                                      <div className={`text-sm mt-1 ${\n                                        item.status === 'cancelled' \n                                          ? 'text-red-400 line-through decoration-red-600' \n                                          : 'text-gray-400'\n                                      }`}>\n                                        {formatCurrency(item.unit_price)} × {\n                                          item.cancelledQuantity && item.cancelledQuantity > 0\n                                            ? item.quantity - item.cancelledQuantity\n                                            : item.quantity\n                                        }\n                                      </div>\n                                    </div>\n                                    \n                                    <div className=\"flex items-center gap-3\">\n                                      {/* Só mostra botões +/- para itens não lançados */}\n                                      {item.status === 'pending' || !item.status ? (\n                                        <div className=\"flex items-center gap-1\">\n                                          <Button\n                                            size=\"sm\"\n                                            onClick={() => handleUpdateQuantity(item.id!, -1)}\n                                            className=\"h-7 w-7 p-0 bg-gray-700 hover:bg-gray-600\"\n                                          >\n                                            <Minus className=\"h-3 w-3\" />\n                                          </Button>\n                                          <span className=\"w-8 text-center font-medium\">\n                                            {item.quantity}\n                                          </span>\n                                          <Button\n                                            size=\"sm\"\n                                            onClick={() => handleUpdateQuantity(item.id!, 1)}\n                                            className=\"h-7 w-7 p-0 bg-gray-700 hover:bg-gray-600\"\n                                          >\n                                            <Plus className=\"h-3 w-3\" />\n                                          </Button>\n                                        </div>\n                                      ) : (\n                                        /* Para itens lançados, mostra quantidade de forma elegante */\n                                        <div className=\"flex items-center\">\n                                          <div className=\"bg-gray-700/50 px-3 py-1 rounded-lg border border-gray-600\">\n                                            <div className=\"flex items-center gap-2\">\n                                              {item.cancelledQuantity && item.cancelledQuantity > 0 && item.status !== 'cancelled' ? (\n                                                <>\n                                                  <span className=\"font-bold text-lg text-white\">\n                                                    {item.quantity - item.cancelledQuantity}\n                                                  </span>\n                                                  <span className=\"text-gray-500 text-sm\">/</span>\n                                                  <span className=\"text-red-500 line-through text-sm\">\n                                                    {item.cancelledQuantity}\n                                                  </span>\n                                                </>\n                                              ) : (\n                                                <span className={`font-bold text-lg ${\n                                                  item.status === 'cancelled' ? 'text-red-500 line-through' : 'text-white'\n                                                }`}>\n                                                  {item.quantity}\n                                                </span>\n                                              )}\n                                              <span className=\"text-gray-400 text-xs uppercase tracking-wider ml-1\">\n                                                UN\n                                              </span>\n                                            </div>\n                                          </div>\n                                        </div>\n                                      )}\n                                      \n                                      <div className=\"text-right\">\n                                        <div className={`font-bold text-lg ${\n                                          item.status === 'cancelled' \n                                            ? 'text-red-500 line-through' \n                                            : 'text-orange-400'\n                                        }`}>\n                                          {formatCurrency(\n                                            item.status === 'cancelled' \n                                              ? item.total_price // Sempre mostra o valor total original quando cancelado\n                                              : (item.cancelledQuantity && item.cancelledQuantity > 0\n                                                  ? item.unit_price * (item.quantity - item.cancelledQuantity)\n                                                  : item.total_price)\n                                          )}\n                                        </div>\n                                      </div>\n                                      \n                                      {/* Botão de cancelar/restaurar só aparece para itens lançados */}\n                                      {(item.status === 'delivered' || item.status === 'cancelled') && (\n                                        <Button\n                                          size=\"sm\"\n                                          variant=\"ghost\"\n                                          onClick={() => handleRemoveItem(item.id!)}\n                                          className={`h-7 w-7 p-0 ${\n                                            item.status === 'cancelled'\n                                              ? 'text-green-400 hover:text-green-300 hover:bg-green-900/20'\n                                              : 'text-red-400 hover:text-red-300 hover:bg-red-900/20'\n                                          }`}\n                                        >\n                                          {item.status === 'cancelled' ? (\n                                            <RefreshCw className=\"h-4 w-4\" />\n                                          ) : (\n                                            <X className=\"h-5 w-5 font-bold\" />\n                                          )}\n                                        </Button>\n                                      )}\n                                      \n                                      {/* Botão de excluir para itens não lançados */}\n                                      {(item.status === 'pending' || !item.status) && (\n                                        <Button\n                                          size=\"sm\"\n                                          variant=\"ghost\"\n                                          onClick={() => handleRemoveItem(item.id!)}\n                                          className=\"h-7 w-7 p-0 text-red-400 hover:text-red-300 hover:bg-red-900/20\"\n                                        >\n                                          <X className=\"h-5 w-5 font-bold\" />\n                                        </Button>\n                                      )}\n                                    </div>\n                                  </div>\n                                </CardContent>\n                              </Card>\n                            </motion.div>\n                          ))}\n                        </AnimatePresence>\n                      )\n                    })()}\n                    </ScrollArea>\n                  </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n              \n              <TabsContent value=\"categories\" className=\"flex-1 mt-4 overflow-hidden\">\n                <Card className=\"h-full bg-gray-900/50 backdrop-blur border-gray-700 flex flex-col\">\n                  <CardHeader className=\"flex-shrink-0\">\n                    <CardTitle className=\"flex items-center justify-between\">\n                      <span>\n                        {selectedGroup \n                          ? `${groups.find(g => g.id === selectedGroup)?.name || ''} - Categorias` \n                          : 'Grupos de Produtos'}\n                      </span>\n                      {selectedGroup && (\n                        <Button\n                          size=\"sm\"\n                          variant=\"ghost\"\n                          onClick={() => {\n                            setSelectedGroup(null);\n                            setSelectedCategory(null);\n                          }}\n                          className=\"text-gray-300 hover:text-white\"\n                        >\n                          <ChevronLeft className=\"h-4 w-4 mr-1\" />\n                          Voltar aos Grupos\n                        </Button>\n                      )}\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"flex-1 overflow-y-auto\">\n                    {!selectedGroup ? (\n                      // Mostrar Grupos\n                      <div className=\"space-y-4\">\n                        <div className=\"grid grid-cols-3 gap-4\">\n                          {groups.map((group) => {\n                            const Icon = (group.icon ? getIconByName(group.icon) : null) || Package;\n                            return (\n                              <motion.div\n                                key={group.id}\n                                whileHover={{ scale: 1.05 }}\n                                whileTap={{ scale: 0.95 }}\n                              >\n                                <Card\n                                  onClick={() => {\n                                    // Se o grupo for rodízio, verifica se já tem rodízio lançado\n                                    if (group.type === 'rodizio') {\n                                      // Verifica se já tem rodízio deste grupo no carrinho\n                                      const hasRodizio = cart.some(cartItem => {\n                                        // Verifica se é um rodízio (tem ID negativo) e se é do mesmo grupo\n                                        const isRodizioItem = cartItem.item_id < 0;\n                                        const isSameGroup = cartItem.item?.group_id === group.id;\n                                        const hasRodizioInName = cartItem.item?.name?.includes(group.name);\n                                        return isRodizioItem && (isSameGroup || hasRodizioInName);\n                                      });\n                                      \n                                      if (!hasRodizio) {\n                                        // Se não tem rodízio, abre o modal para adicionar\n                                        setSelectedRodizioGroup(group);\n                                        setRodizioInteiro(1);\n                                        setRodizioMeio(0);\n                                        setRodizioModal(true);\n                                      } else {\n                                        // Se já tem rodízio, vai para as categorias normalmente\n                                        setSelectedGroup(group.id);\n                                        const firstCategory = categories\n                                          .filter(c => c.active && c.group_id === group.id)\n                                          .sort((a, b) => (a.sort_order || 0) - (b.sort_order || 0))[0];\n                                        if (firstCategory) {\n                                          setSelectedCategory(firstCategory.id);\n                                        }\n                                      }\n                                    } else {\n                                      // Se não for rodízio, procede normalmente\n                                      setSelectedGroup(group.id);\n                                      const firstCategory = categories\n                                        .filter(c => c.active && c.group_id === group.id)\n                                        .sort((a, b) => (a.sort_order || 0) - (b.sort_order || 0))[0];\n                                      if (firstCategory) {\n                                        setSelectedCategory(firstCategory.id);\n                                      }\n                                    }\n                                  }}\n                                  className=\"h-32 bg-gradient-to-br from-gray-800 to-gray-700 hover:from-orange-700 hover:to-orange-600 border-gray-600 hover:border-orange-500 cursor-pointer transition-all group\"\n                                >\n                                  <CardContent className=\"h-full flex flex-col items-center justify-between p-4 relative\">\n                                    {/* Badge Rodízio */}\n                                    {group.type === 'rodizio' && (\n                                      <div className=\"absolute top-2 right-2 bg-gradient-to-r from-yellow-500 to-yellow-600 text-black text-xs px-2 py-1 rounded-full font-semibold shadow-lg\">\n                                        Rodízio\n                                      </div>\n                                    )}\n                                    \n                                    {/* Valor sempre no canto esquerdo */}\n                                    <div className=\"absolute top-2 left-2 text-yellow-400 font-bold text-sm\">\n                                      {group.price ? `R$ ${group.price.toFixed(2)}` : ''}\n                                    </div>\n\n                                    {/* Conteúdo centralizado */}\n                                    <div className=\"flex-1 flex flex-col items-center justify-center\">\n                                      <div className=\"bg-gray-900/50 p-3 rounded-full mb-2 group-hover:bg-orange-600/30 transition-colors\">\n                                        <Icon className=\"h-10 w-10 text-gray-200 group-hover:text-white\" />\n                                      </div>\n                                      <h3 className=\"text-center text-white font-semibold text-base\">\n                                        {group.name}\n                                      </h3>\n                                    </div>\n                                  </CardContent>\n                                </Card>\n                              </motion.div>\n                            );\n                          })}\n                        </div>\n                      </div>\n                    ) : (\n                      // Mostrar Categorias do Grupo e Produtos\n                      <div className=\"space-y-4\">\n                        <div className=\"flex flex-wrap gap-1\">\n                          {categories\n                            .filter((c) => c.active && c.group_id === selectedGroup)\n                            .map((category) => {\n                              return (\n                                <Button\n                                  key={category.id}\n                                  onClick={() => setSelectedCategory(category.id)}\n                                  className={`h-7 text-sm font-medium px-2 py-0 w-auto min-w-fit ${selectedCategory === category.id ? 'bg-orange-600' : 'bg-gray-700'} hover:bg-orange-700`}\n                                >\n                                  {category.name}\n                                </Button>\n                              );\n                            })}\n                        </div>\n                        \n                        <div className=\"relative h-[400px]\">\n                          <ScrollArea className=\"h-full\">\n                            {filteredItems.length === 0 ? (\n                              <div className=\"flex flex-col items-center justify-center h-full text-gray-400\">\n                                <Package className=\"h-16 w-16 mb-4 opacity-50\" />\n                                <p className=\"text-lg font-medium mb-2\">Nenhum produto encontrado</p>\n                                {searchQuery && (\n                                  <p className=\"text-sm\">Para a busca: \"{searchQuery}\"</p>\n                                )}\n                                {!searchQuery && selectedCategory && (\n                                  <p className=\"text-sm\">Nesta categoria</p>\n                                )}\n                              </div>\n                          ) : (\n                            <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2\">\n                              {filteredItems.map((item) => (\n                                <motion.div\n                                  key={item.id}\n                                  whileHover={{ scale: 1.02 }}\n                                  whileTap={{ scale: 0.98 }}\n                                >\n                                  <Card\n                                    className=\"bg-gray-800 border-gray-700 hover:bg-gray-700 cursor-pointer transition-all overflow-hidden h-full\"\n                                    onClick={() => handleAddItem(item)}\n                                  >\n                                    <CardContent className=\"p-2 flex items-center gap-2\">\n                                      {/* Foto do produto - tamanho fixo com borda arredondada */}\n                                      <div className=\"w-16 h-16 bg-gray-900 rounded-lg overflow-hidden flex-shrink-0\">\n                                        <img\n                                          src={item.image || '/fotos/placeholder/placeholder.png'}\n                                          alt={item.name}\n                                          className=\"w-full h-full object-cover\"\n                                          onError={(e) => {\n                                            const target = e.target as HTMLImageElement;\n                                            target.src = '/fotos/placeholder/placeholder.png';\n                                          }}\n                                        />\n                                      </div>\n                                      {/* Informações do produto */}\n                                      <div className=\"flex-1 min-w-0\">\n                                        <div className=\"font-medium text-white text-xs line-clamp-2\">\n                                          {item.name}\n                                        </div>\n                                        <div className=\"text-[10px] text-gray-500 mt-0.5\">\n                                          Cód: {item.id}\n                                        </div>\n                                        <div className=\"font-bold text-orange-400 text-sm mt-1\">\n                                          {formatCurrency(item.price || 0)}\n                                        </div>\n                                      </div>\n                                    </CardContent>\n                                  </Card>\n                                </motion.div>\n                              ))}\n                            </div>\n                          )}\n                          </ScrollArea>\n                          \n                        </div>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </TabsContent>\n            </Tabs>\n            )}\n            \n            {/* Botões de Ação na parte inferior do painel esquerdo */}\n            <div className=\"p-4 pt-2 bg-gray-900/50 border-t border-gray-700\">\n              <div className=\"flex justify-between items-center gap-4\">\n                {/* Botão Voltar - Lado Esquerdo */}\n                <Button\n                  onClick={() => setScreen('tables')}\n                  variant=\"outline\"\n                  className=\"h-10 px-6 text-gray-300 border-gray-600 hover:bg-gray-800 font-medium\"\n                >\n                  <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                  Voltar\n                </Button>\n                \n                {/* Botões Cancelar/Lançar ou Info de Mesa Fechada */}\n                {selectedTable?.status === 'closed' ? (\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"flex-1 bg-red-900/30 border border-red-600 rounded-lg px-4 py-2\">\n                      <div className=\"flex items-center gap-3\">\n                        <CreditCard className=\"h-5 w-5 text-red-400\" />\n                        <div>\n                          <p className=\"text-sm font-semibold text-red-300\">Conta Fechada</p>\n                          <p className=\"text-xs text-gray-400\">Total: {formatCurrency(calculateTotal())}</p>\n                        </div>\n                      </div>\n                    </div>\n                    <Button\n                      onClick={reopenTable}\n                      disabled={loading}\n                      className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n                    >\n                      <RefreshCw className=\"h-4 w-4 mr-2\" />\n                      Reabrir Mesa\n                    </Button>\n                  </div>\n                ) : (() => {\n                  // Verifica se há alterações pendentes\n                  const hasPendingItems = cart.some(item => \n                    item.status === 'pending' || !item.status\n                  );\n                  const hasRestoredItems = cart.some((item: any) => \n                    item.wasRestored === true\n                  );\n                  const hasCancelledItems = cart.some((item: any) => \n                    item.wasCancelled === true\n                  );\n                  const hasChanges = hasPendingItems || hasRestoredItems || hasCancelledItems;\n                  \n                  return (\n                    <div className={`flex rounded-full border border-gray-700 overflow-hidden ${\n                      hasChanges \n                        ? 'bg-gray-800' \n                        : 'bg-gray-900 opacity-50 cursor-not-allowed'\n                    }`}>\n                      <button\n                        onClick={hasChanges ? handleCancelOrder : undefined}\n                        disabled={!hasChanges}\n                        className={`px-6 py-2 font-medium transition-all flex items-center gap-2 border-r border-gray-700 ${\n                          hasChanges\n                            ? 'text-red-400 hover:bg-red-900/20 hover:text-red-300'\n                            : 'text-gray-600 cursor-not-allowed'\n                        }`}\n                      >\n                        <X className=\"h-4 w-4\" />\n                        Cancelar\n                      </button>\n                      <button\n                        onClick={hasChanges ? handleLaunchOrder : undefined}\n                        disabled={!hasChanges}\n                        className={`px-7 py-2 font-medium transition-all flex items-center gap-2 ${\n                          hasChanges\n                            ? 'bg-green-600 hover:bg-green-700 text-white'\n                            : 'bg-gray-800 text-gray-600 cursor-not-allowed'\n                        }`}\n                      >\n                        <Send className=\"h-4 w-4\" />\n                        Lançar\n                      </button>\n                    </div>\n                  );\n                })()}\n              </div>\n            </div>\n          </div>\n          \n          {/* Right Panel 30% - Menu Lateral Compacto */}\n          <div className=\"w-[30%] flex flex-col p-4 bg-gray-900/50\">\n            {/* Se a mesa está fechada, mostra apenas resumo */}\n            {selectedTable?.status === 'closed' ? (\n              <Card className=\"bg-gray-900/50 backdrop-blur border-gray-700\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Receipt className=\"h-5 w-5 text-orange-400\" />\n                    Resumo da Conta Fechada\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  {/* Status da Mesa */}\n                  <div className=\"bg-red-900/30 border border-red-600 rounded-lg p-4\">\n                    <div className=\"flex items-center gap-3\">\n                      <CreditCard className=\"h-6 w-6 text-red-400\" />\n                      <div>\n                        <p className=\"text-lg font-semibold text-red-300\">Mesa {selectedTable.number} Fechada</p>\n                        {currentSession?.customer_count > 0 && (\n                          <p className=\"text-sm text-gray-400\">\n                            {currentSession.customer_count} {currentSession.customer_count === 1 ? 'pessoa' : 'pessoas'}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                  \n                  {/* Resumo de Valores */}\n                  <div className=\"space-y-3 p-4 bg-gray-800 rounded-lg\">\n                    <div className=\"flex justify-between text-sm\">\n                      <span className=\"text-gray-400\">Subtotal:</span>\n                      <span className=\"font-medium\">{formatCurrency(calculateSubtotal())}</span>\n                    </div>\n                    {serviceTaxPercentage > 0 && (\n                      <div className=\"flex justify-between text-sm\">\n                        <span className=\"text-gray-400\">Taxa de Serviço ({serviceTaxPercentage}%):</span>\n                        <span className=\"font-medium text-yellow-400\">+{formatCurrency(calculateServiceTax())}</span>\n                      </div>\n                    )}\n                    {discountValue > 0 && (\n                      <div className=\"flex justify-between text-sm\">\n                        <span className=\"text-gray-400\">Desconto:</span>\n                        <span className=\"font-medium text-green-400\">\n                          -{discountType === 'percentage' \n                            ? `${discountValue}%` \n                            : formatCurrency(discountValue)}\n                        </span>\n                      </div>\n                    )}\n                    <div className=\"flex justify-between text-lg font-bold pt-3 border-t border-gray-600\">\n                      <span>Total Final:</span>\n                      <span className=\"text-orange-400\">{formatCurrency(calculateTotalWithDiscount())}</span>\n                    </div>\n                  </div>\n                  \n                  {/* Informações da Sessão */}\n                  <div className=\"space-y-2 text-sm\">\n                    <div className=\"flex items-center gap-2\">\n                      <Users className=\"h-4 w-4 text-gray-400\" />\n                      <span className=\"text-gray-400\">Pessoas:</span>\n                      <span className=\"font-medium\">{currentSession?.customer_count || 0}</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Clock className=\"h-4 w-4 text-gray-400\" />\n                      <span className=\"text-gray-400\">Mesa aberta:</span>\n                      <span className=\"font-medium\">\n                        {currentSession?.opened_at \n                          ? format(new Date(currentSession.opened_at), 'HH:mm', { locale: ptBR })\n                          : '-'}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <ShoppingCart className=\"h-4 w-4 text-gray-400\" />\n                      <span className=\"text-gray-400\">Total de Itens:</span>\n                      <span className=\"font-medium\">\n                        {cart.filter(item => item.status !== 'cancelled').length}\n                      </span>\n                    </div>\n                  </div>\n                  \n                </CardContent>\n              </Card>\n            ) : (\n              <>\n              {/* Card de Ações Normal - quando mesa não está fechada */}\n              <Card className=\"bg-gray-900/50 backdrop-blur border-gray-700 mb-4\">\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-base flex items-center gap-2\">\n                  <Settings className=\"h-4 w-4 text-orange-400\" />\n                  Ações da Mesa\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-3 pt-0\">\n                <div className=\"space-y-2\">\n                  {/* Botão Fechar Conta - Principal em laranja */}\n                  <Button\n                    onClick={startCheckout}\n                    disabled={loading || cart.length === 0 || selectedTable?.status === 'closed'}\n                    className={`w-full h-11 text-sm font-semibold transition-all ${\n                      cart.length === 0 || selectedTable?.status === 'closed'\n                        ? \"bg-gray-700 text-gray-400 cursor-not-allowed\" \n                        : \"bg-orange-600 hover:bg-orange-500 text-white shadow-lg shadow-orange-600/20\"\n                    }`}\n                  >\n                    <CreditCard className=\"mr-2 h-4 w-4\" />\n                    {selectedTable?.status === 'closed' ? 'Conta Fechada' : 'Fechar Conta'}\n                  </Button>\n                  \n                  {/* Botão Imprimir - Secundário */}\n                  <Button\n                    onClick={() => setPrintDialog(true)}\n                    disabled={cart.length === 0}\n                    className={`w-full h-11 text-sm font-semibold transition-all ${\n                      cart.length === 0 \n                        ? \"bg-gray-700 text-gray-400 cursor-not-allowed\" \n                        : \"bg-gray-700 hover:bg-gray-600 text-white border border-gray-600\"\n                    }`}\n                  >\n                    <Printer className=\"mr-2 h-4 w-4\" />\n                    Imprimir Conta\n                  </Button>\n                  \n                  {/* Botão Transferir - Secundário */}\n                  <Button\n                    onClick={() => setTransferTableDialog(true)}\n                    className=\"w-full h-11 text-sm font-semibold bg-gray-700 hover:bg-gray-600 text-white border border-gray-600 transition-all\"\n                  >\n                    <ArrowRight className=\"mr-2 h-4 w-4\" />\n                    Transferir Mesa\n                  </Button>\n                  \n                  {/* Botão Cancelar Mesa - Destrutivo mais sutil */}\n                  <Button\n                    onClick={() => setCancelTableDialog(true)}\n                    className=\"w-full h-11 text-sm font-semibold bg-gray-700 hover:bg-red-900/30 text-red-400 border border-gray-600 hover:border-red-800 transition-all\"\n                  >\n                    <X className=\"mr-2 h-4 w-4\" />\n                    Cancelar Mesa\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n            \n            {/* Resumo Financeiro Compacto */}\n            <div className=\"mt-auto pt-3\">\n              <div className=\"bg-gray-800/40 rounded-lg p-3 border border-gray-700\">\n                <div className=\"space-y-2\">\n                  {/* Itens Lançados */}\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-green-400 text-xs flex items-center gap-1\">\n                      <CheckCircle2 className=\"h-3 w-3\" />\n                      Lançados\n                    </span>\n                    <span className=\"text-green-400 font-semibold text-sm\">\n                      R$ {calculateLaunchedTotal().toFixed(2).replace('.', ',')}\n                    </span>\n                  </div>\n                  \n                  {/* Itens Cancelados */}\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-red-400 text-xs flex items-center gap-1\">\n                      <XCircle className=\"h-3 w-3\" />\n                      Cancelados\n                    </span>\n                    <span className=\"text-red-400 font-semibold text-sm line-through\">\n                      R$ {calculateCancelledTotal().toFixed(2).replace('.', ',')}\n                    </span>\n                  </div>\n\n                  {/* Subtotal */}\n                  <div className=\"flex justify-between items-center pt-1\">\n                    <span className=\"text-gray-400 text-xs\">Subtotal</span>\n                    <span className=\"text-gray-300 text-sm\">\n                      R$ {calculateSubtotal().toFixed(2).replace('.', ',')}\n                    </span>\n                  </div>\n                  \n                  {/* Taxa de Serviço - só mostra se > 0 */}\n                  {serviceTaxPercentage > 0 && (\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-yellow-400 text-xs\">\n                        Taxa de Serviço ({serviceTaxPercentage}%)\n                      </span>\n                      <span className=\"text-yellow-400 text-sm\">\n                        +R$ {calculateServiceTax().toFixed(2).replace('.', ',')}\n                      </span>\n                    </div>\n                  )}\n                  \n                  {/* Total Geral */}\n                  <div className=\"border-t border-gray-600 pt-2 mt-1\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-white text-sm font-bold flex items-center gap-1\">\n                        <DollarSign className=\"h-3 w-3 text-orange-400\" />\n                        Total\n                      </span>\n                      <motion.span \n                        className=\"text-lg font-bold text-orange-500\"\n                        key={calculateTotal()}\n                        initial={{ scale: 1.1 }}\n                        animate={{ scale: 1 }}\n                        transition={{ duration: 0.2 }}\n                      >\n                        R$ {calculateTotal().toFixed(2).replace('.', ',')}\n                      </motion.span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            </>)}\n            \n          </div>\n        </div>\n\n\n        {/* Dialogs Melhorados */}\n        {/* Dialog Pagamento com Animação */}\n        <Dialog open={paymentDialog} onOpenChange={setPaymentDialog}>\n          <DialogContent className=\"bg-gray-800 text-white border-gray-700 max-w-md\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2\">\n                <CreditCard className=\"h-5 w-5 text-green-400\" />\n                Receber Pagamento\n              </DialogTitle>\n              <DialogDescription className=\"text-gray-400\">\n                Confirme o pagamento da conta\n              </DialogDescription>\n            </DialogHeader>\n            \n            <div className=\"py-4 space-y-4\">\n              <motion.div \n                initial={{ scale: 0.9, opacity: 0 }}\n                animate={{ scale: 1, opacity: 1 }}\n                className=\"bg-gradient-to-br from-gray-900 to-gray-800 rounded-lg p-4\"\n              >\n                <div className=\"flex justify-between items-center text-2xl font-bold\">\n                  <span>Total a Pagar:</span>\n                  <motion.span \n                    className=\"text-orange-400\"\n                    initial={{ x: 20, opacity: 0 }}\n                    animate={{ x: 0, opacity: 1 }}\n                  >\n                    {formatCurrency(calculateTotal())}\n                  </motion.span>\n                </div>\n              </motion.div>\n\n              <div>\n                <label className=\"block text-sm mb-2 text-gray-300\">\n                  Forma de Pagamento\n                </label>\n                <div className=\"grid grid-cols-3 gap-2\">\n                  {[\n                    { method: 'cash' as const, icon: DollarSign, label: 'Dinheiro' },\n                    { method: 'card' as const, icon: CreditCard, label: 'Cartão' },\n                    { method: 'pix' as const, icon: Smartphone, label: 'PIX' }\n                  ].map((pm) => (\n                    <motion.div\n                      key={pm.method}\n                      whileHover={{ scale: 1.05 }}\n                      whileTap={{ scale: 0.95 }}\n                    >\n                      <Button\n                        onClick={() => setPaymentMethod(pm.method)}\n                        className={`h-20 flex flex-col items-center justify-center gap-2 ${\n                          paymentMethod === pm.method \n                            ? 'bg-gradient-to-br from-orange-600 to-orange-700' \n                            : 'bg-gray-700 hover:bg-gray-600'\n                        }`}\n                      >\n                        <pm.icon className=\"h-6 w-6\" />\n                        <span className=\"text-xs\">{pm.label}</span>\n                      </Button>\n                    </motion.div>\n                  ))}\n                </div>\n              </div>\n\n              <motion.div \n                initial={{ y: 20, opacity: 0 }}\n                animate={{ y: 0, opacity: 1 }}\n                className=\"bg-yellow-900/30 border border-yellow-600 rounded-lg p-3\"\n              >\n                <div className=\"flex items-center gap-2 text-yellow-400\">\n                  <AlertCircle className=\"h-4 w-4\" />\n                  <p className=\"text-sm\">\n                    Confirme o recebimento do valor total antes de finalizar\n                  </p>\n                </div>\n              </motion.div>\n            </div>\n            \n            <DialogFooter>\n              <Button\n                onClick={() => setPaymentDialog(false)}\n                className=\"bg-gray-700 hover:bg-gray-600\"\n              >\n                Cancelar (ESC)\n              </Button>\n              <Button\n                onClick={handlePayment}\n                disabled={loading}\n                className=\"bg-gradient-to-br from-green-600 to-green-700 hover:from-green-700 hover:to-green-800\"\n              >\n                {loading ? (\n                  <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                ) : (\n                  <>\n                    <Check className=\"mr-2 h-4 w-4\" />\n                    Confirmar Pagamento\n                  </>\n                )}\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        {/* Dialog Checkout Completo */}\n        <Dialog open={checkoutDialog} onOpenChange={setCheckoutDialog}>\n          <DialogContent className=\"bg-gray-900 text-white border-gray-700 max-w-6xl max-h-[90vh] overflow-y-auto\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center justify-between text-2xl\">\n                <span className=\"flex items-center gap-3\">\n                  <Calculator className=\"h-7 w-7 text-orange-400\" />\n                  Fechamento de Conta - Mesa {selectedTable?.number}\n                </span>\n                <Button\n                  onClick={reopenTable}\n                  variant=\"outline\"\n                  className=\"text-yellow-400 border-yellow-400 hover:bg-yellow-400/10\"\n                >\n                  <ArrowLeft className=\"mr-2 h-4 w-4\" />\n                  Reabrir Mesa\n                </Button>\n              </DialogTitle>\n            </DialogHeader>\n            \n            <div className=\"grid grid-cols-3 gap-6\">\n              {/* Coluna 1: Resumo de Itens e Descontos */}\n              <div className=\"space-y-4\">\n                {/* Itens Agrupados */}\n                <Card className=\"bg-gray-800 border-gray-700\">\n                  <CardHeader>\n                    <CardTitle className=\"text-lg\">Resumo da Conta</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <ScrollArea className=\"h-[250px]\">\n                      <div className=\"space-y-2\">\n                        {groupedItems.map((item, idx) => (\n                          <div key={idx} className=\"flex justify-between items-center p-2 bg-gray-700/50 rounded\">\n                            <div className=\"flex-1\">\n                              <div className=\"font-medium\">{item.item?.name || 'Produto'}</div>\n                              <div className=\"text-sm text-gray-400\">\n                                {formatCurrency(item.unit_price)} × {\n                                  item.cancelledQuantity && item.cancelledQuantity > 0\n                                    ? `${item.quantity - item.cancelledQuantity}`\n                                    : item.quantity\n                                }\n                              </div>\n                            </div>\n                            <div className=\"text-right\">\n                              <div className=\"font-bold text-orange-400\">\n                                {formatCurrency(\n                                  item.cancelledQuantity && item.cancelledQuantity > 0\n                                    ? item.unit_price * (item.quantity - item.cancelledQuantity)\n                                    : item.total_price\n                                )}\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </ScrollArea>\n                    \n                    {/* Totais */}\n                    <div className=\"mt-4 pt-4 border-t border-gray-600 space-y-2\">\n                      <div className=\"flex justify-between\">\n                        <span>Subtotal:</span>\n                        <span className=\"font-bold\">{formatCurrency(calculateSubtotal())}</span>\n                      </div>\n                      \n                      {/* Taxa de Serviço - só mostra se > 0 */}\n                      {serviceTaxPercentage > 0 && (\n                        <div className=\"flex justify-between text-yellow-400\">\n                          <span>Taxa de Serviço ({serviceTaxPercentage}%):</span>\n                          <span className=\"font-bold\">+{formatCurrency(calculateServiceTax())}</span>\n                        </div>\n                      )}\n                      \n                      {/* Desconto */}\n                      <div className=\"flex items-center gap-2\">\n                        <span>Desconto:</span>\n                        <div className=\"flex gap-1\">\n                          <Button\n                            size=\"sm\"\n                            onClick={() => setDiscountType('percentage')}\n                            className={discountType === 'percentage' ? 'bg-orange-600' : 'bg-gray-700'}\n                          >\n                            %\n                          </Button>\n                          <Button\n                            size=\"sm\"\n                            onClick={() => setDiscountType('fixed')}\n                            className={discountType === 'fixed' ? 'bg-orange-600' : 'bg-gray-700'}\n                          >\n                            R$\n                          </Button>\n                        </div>\n                        <Input\n                          type=\"number\"\n                          value={discountValue}\n                          onChange={(e) => setDiscountValue(parseFloat(e.target.value) || 0)}\n                          className=\"w-20 h-8 bg-gray-700 border-gray-600 text-white\"\n                          min=\"0\"\n                        />\n                        {discountValue > 0 && (\n                          <span className=\"text-red-400\">\n                            -{formatCurrency(\n                              discountType === 'percentage' \n                                ? calculateTotal() * discountValue / 100 \n                                : discountValue\n                            )}\n                          </span>\n                        )}\n                      </div>\n                      \n                      {/* Total com Desconto */}\n                      <div className=\"flex justify-between text-xl font-bold\">\n                        <span>Total:</span>\n                        <span className=\"text-orange-400\">\n                          {formatCurrency(calculateTotalWithDiscount())}\n                        </span>\n                      </div>\n                      \n                      {/* Divisão */}\n                      <div className=\"flex items-center gap-2\">\n                        <span>Dividir em:</span>\n                        <div className=\"flex items-center gap-1\">\n                          <Button\n                            size=\"sm\"\n                            onClick={() => setSplitCount(Math.max(1, splitCount - 1))}\n                            className=\"h-8 w-8 p-0 bg-gray-700 hover:bg-gray-600\"\n                          >\n                            <Minus className=\"h-3 w-3\" />\n                          </Button>\n                          <span className=\"w-12 text-center font-bold\">{splitCount}</span>\n                          <Button\n                            size=\"sm\"\n                            onClick={() => setSplitCount(splitCount + 1)}\n                            className=\"h-8 w-8 p-0 bg-gray-700 hover:bg-gray-600\"\n                          >\n                            <Plus className=\"h-3 w-3\" />\n                          </Button>\n                        </div>\n                        {splitCount > 1 && (\n                          <span className=\"text-sm text-gray-400\">\n                            ({formatCurrency(calculateTotalWithDiscount() / splitCount)} cada)\n                          </span>\n                        )}\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n              \n              {/* Coluna 2: Calculadora e Pagamento */}\n              <div className=\"space-y-4\">\n                {/* Display da Calculadora */}\n                <Card className=\"bg-gray-800 border-gray-700\">\n                  <CardContent className=\"p-4\">\n                    <div className=\"bg-black rounded p-3 text-right text-3xl font-mono text-green-400\">\n                      {calculatorDisplay}\n                    </div>\n                    \n                    {/* Teclado da Calculadora */}\n                    <div className=\"grid grid-cols-3 gap-2 mt-4\">\n                      {['7', '8', '9', '4', '5', '6', '1', '2', '3', '0', '00', 'C'].map((key) => (\n                        <Button\n                          key={key}\n                          onClick={() => {\n                            if (key === 'C') {\n                              setCalculatorDisplay('0');\n                            } else if (calculatorDisplay === '0') {\n                              setCalculatorDisplay(key);\n                            } else {\n                              setCalculatorDisplay(calculatorDisplay + key);\n                            }\n                          }}\n                          className={`h-14 text-xl font-bold ${\n                            key === 'C' ? 'bg-red-600 hover:bg-red-700' : 'bg-gray-700 hover:bg-gray-600'\n                          }`}\n                        >\n                          {key}\n                        </Button>\n                      ))}\n                    </div>\n                    \n                    {/* Botões de Valor Rápido */}\n                    <div className=\"grid grid-cols-4 gap-2 mt-4\">\n                      {[10, 20, 50, 100].map((value) => (\n                        <Button\n                          key={value}\n                          onClick={() => setCalculatorDisplay(value.toString())}\n                          className=\"bg-gray-700 hover:bg-gray-600\"\n                        >\n                          R$ {value}\n                        </Button>\n                      ))}\n                    </div>\n                    \n                    {/* Botões de Pagamento */}\n                    <div className=\"grid grid-cols-2 gap-2 mt-4\">\n                      <Button\n                        onClick={() => {\n                          const amount = parseFloat(calculatorDisplay) || 0;\n                          if (amount > 0) {\n                            addPayment(amount, 'cash');\n                            setCalculatorDisplay('0');\n                          }\n                        }}\n                        className=\"bg-green-600 hover:bg-green-700 h-12\"\n                      >\n                        <DollarSign className=\"mr-2 h-5 w-5\" />\n                        Dinheiro\n                      </Button>\n                      <Button\n                        onClick={() => {\n                          const amount = parseFloat(calculatorDisplay) || 0;\n                          if (amount > 0) {\n                            addPayment(amount, 'credit');\n                            setCalculatorDisplay('0');\n                          }\n                        }}\n                        className=\"bg-blue-600 hover:bg-blue-700 h-12\"\n                      >\n                        <CreditCard className=\"mr-2 h-5 w-5\" />\n                        Crédito\n                      </Button>\n                      <Button\n                        onClick={() => {\n                          const amount = parseFloat(calculatorDisplay) || 0;\n                          if (amount > 0) {\n                            addPayment(amount, 'debit');\n                            setCalculatorDisplay('0');\n                          }\n                        }}\n                        className=\"bg-purple-600 hover:bg-purple-700 h-12\"\n                      >\n                        <CreditCard className=\"mr-2 h-5 w-5\" />\n                        Débito\n                      </Button>\n                      <Button\n                        onClick={() => {\n                          const amount = parseFloat(calculatorDisplay) || 0;\n                          if (amount > 0) {\n                            addPayment(amount, 'pix');\n                            setCalculatorDisplay('0');\n                          }\n                        }}\n                        className=\"bg-cyan-600 hover:bg-cyan-700 h-12\"\n                      >\n                        <Smartphone className=\"mr-2 h-5 w-5\" />\n                        PIX\n                      </Button>\n                    </div>\n                    \n                    {/* Botão Total Restante */}\n                    <Button\n                      onClick={() => setCalculatorDisplay(calculateRemaining().toString())}\n                      className=\"w-full mt-2 bg-orange-600 hover:bg-orange-700 h-12 text-lg\"\n                    >\n                      Valor Restante: {formatCurrency(calculateRemaining())}\n                    </Button>\n                  </CardContent>\n                </Card>\n              </div>\n              \n              {/* Coluna 3: Pagamentos Realizados */}\n              <div className=\"space-y-4\">\n                <Card className=\"bg-gray-800 border-gray-700\">\n                  <CardHeader>\n                    <CardTitle className=\"text-lg\">Pagamentos Realizados</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <ScrollArea className=\"h-[300px]\">\n                      <div className=\"space-y-2\">\n                        {payments.length === 0 ? (\n                          <div className=\"text-center text-gray-500 py-8\">\n                            <CreditCard className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                            <p>Nenhum pagamento registrado</p>\n                          </div>\n                        ) : (\n                          payments.map((payment) => (\n                            <div key={payment.id} className=\"flex justify-between items-center p-3 bg-gray-700/50 rounded\">\n                              <div>\n                                <div className=\"font-medium\">\n                                  {payment.method === 'cash' && 'Dinheiro'}\n                                  {payment.method === 'credit' && 'Crédito'}\n                                  {payment.method === 'debit' && 'Débito'}\n                                  {payment.method === 'pix' && 'PIX'}\n                                </div>\n                                <div className=\"text-sm text-gray-400\">\n                                  {format(payment.timestamp, 'HH:mm:ss')}\n                                </div>\n                              </div>\n                              <div className=\"flex items-center gap-2\">\n                                <span className=\"font-bold text-green-400\">\n                                  {formatCurrency(payment.amount)}\n                                </span>\n                                <Button\n                                  size=\"sm\"\n                                  onClick={() => removePayment(payment.id)}\n                                  className=\"h-8 w-8 p-0 bg-red-600 hover:bg-red-700\"\n                                >\n                                  <X className=\"h-4 w-4\" />\n                                </Button>\n                              </div>\n                            </div>\n                          ))\n                        )}\n                      </div>\n                    </ScrollArea>\n                    \n                    {/* Resumo de Pagamentos */}\n                    <div className=\"mt-4 pt-4 border-t border-gray-600 space-y-2\">\n                      <div className=\"flex justify-between\">\n                        <span>Total Pago:</span>\n                        <span className=\"font-bold text-green-400\">\n                          {formatCurrency(payments.reduce((sum, p) => sum + p.amount, 0))}\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span>Restante:</span>\n                        <span className={`font-bold ${calculateRemaining() > 0 ? 'text-red-400' : 'text-green-400'}`}>\n                          {formatCurrency(calculateRemaining())}\n                        </span>\n                      </div>\n                      {calculateChange() > 0 && (\n                        <div className=\"flex justify-between\">\n                          <span>Troco:</span>\n                          <span className=\"font-bold text-yellow-400\">\n                            {formatCurrency(calculateChange())}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n                \n                {/* Botão Finalizar */}\n                <Button\n                  onClick={finishCheckout}\n                  disabled={calculateRemaining() > 0 || loading}\n                  className=\"w-full h-14 text-lg font-bold bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  {loading ? (\n                    <RefreshCw className=\"h-5 w-5 animate-spin\" />\n                  ) : calculateRemaining() > 0 ? (\n                    <>\n                      <AlertCircle className=\"mr-2 h-5 w-5\" />\n                      Faltam {formatCurrency(calculateRemaining())}\n                    </>\n                  ) : (\n                    <>\n                      <Check className=\"mr-2 h-5 w-5\" />\n                      Finalizar Pagamento\n                    </>\n                  )}\n                </Button>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n\n        {/* Dialog Imprimir Comanda */}\n        <Dialog open={printDialog} onOpenChange={setPrintDialog}>\n          <DialogContent className=\"bg-gray-800 text-white border-gray-700\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2\">\n                <Printer className=\"h-5 w-5\" />\n                Imprimir Comanda\n              </DialogTitle>\n            </DialogHeader>\n            \n            <div className=\"py-4\">\n              <Card className=\"bg-gray-900 border-gray-700\">\n                <CardContent className=\"p-4\">\n                  <div className=\"text-center mb-4\">\n                    <h3 className=\"font-bold\">ComideX Restaurant</h3>\n                    <p className=\"text-sm text-gray-400\">\n                      {selectedTable?.type === 'counter' ? 'Balcão' : 'Mesa'} {selectedTable?.number}\n                    </p>\n                    <p className=\"text-xs text-gray-500\">\n                      {format(new Date(), 'dd/MM/yyyy HH:mm')}\n                    </p>\n                  </div>\n                  \n                  <div className=\"border-t border-gray-700 pt-2\">\n                    {cart.slice(0, 5).map((item, index) => (\n                      <div key={index} className=\"flex justify-between text-sm py-1\">\n                        <span>{item.quantity}x {item.item?.name}</span>\n                        <span>{formatCurrency(item.total_price)}</span>\n                      </div>\n                    ))}\n                    {cart.length > 5 && (\n                      <div className=\"text-sm text-gray-400 text-center py-1\">\n                        ... e mais {cart.length - 5} itens\n                      </div>\n                    )}\n                  </div>\n                  \n                  <div className=\"border-t border-gray-700 mt-2 pt-2\">\n                    <div className=\"flex justify-between font-bold\">\n                      <span>Total:</span>\n                      <span className=\"text-orange-400\">\n                        {formatCurrency(calculateTotal())}\n                      </span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n            \n            <DialogFooter>\n              <Button\n                onClick={() => setPrintDialog(false)}\n                className=\"bg-gray-700 hover:bg-gray-600\"\n              >\n                Cancelar\n              </Button>\n              <Button\n                onClick={handlePrintComanda}\n                className=\"bg-purple-600 hover:bg-purple-700\"\n              >\n                <Printer className=\"mr-2 h-4 w-4\" />\n                Imprimir\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        {/* Dialog Fechar Mesa Vazia */}\n        <Dialog open={closeSessionDialog} onOpenChange={setCloseSessionDialog}>\n          <DialogContent className=\"bg-gray-800 text-white border-gray-700\">\n            <DialogHeader>\n              <DialogTitle>Fechar Mesa Sem Consumo</DialogTitle>\n              <DialogDescription className=\"text-gray-400\">\n                Deseja fechar a mesa sem registrar consumo?\n              </DialogDescription>\n            </DialogHeader>\n            \n            <div className=\"py-4\">\n              <div className=\"bg-yellow-900/30 border border-yellow-600 rounded-lg p-3\">\n                <div className=\"flex items-center gap-2 text-yellow-400\">\n                  <AlertCircle className=\"h-4 w-4\" />\n                  <p className=\"text-sm\">\n                    A mesa será liberada sem registrar vendas\n                  </p>\n                </div>\n              </div>\n            </div>\n            \n            <DialogFooter>\n              <Button\n                onClick={() => setCloseSessionDialog(false)}\n                className=\"bg-gray-700 hover:bg-gray-600\"\n              >\n                Cancelar\n              </Button>\n              <Button\n                onClick={handleCloseSessionWithoutPayment}\n                disabled={loading}\n                className=\"bg-red-600 hover:bg-red-700\"\n              >\n                {loading ? (\n                  <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                ) : (\n                  <>\n                    <X className=\"mr-2 h-4 w-4\" />\n                    Fechar Mesa\n                  </>\n                )}\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n        \n        {/* Dialog de Cancelamento Parcial */}\n        <Dialog open={cancelQuantityDialog} onOpenChange={setCancelQuantityDialog}>\n          <DialogContent className=\"bg-gray-800 text-white border-gray-700 max-w-sm\">\n            <div className=\"space-y-6\">\n              {itemToCancel && (\n                <>\n                  <div className=\"bg-gray-700/50 rounded-lg p-4 text-center\">\n                    <p className=\"font-bold text-lg\">{itemToCancel.item?.name || 'Produto'}</p>\n                    <p className=\"text-sm text-gray-400 mt-1\">Disponível: {itemToCancel.quantity} unidades</p>\n                  </div>\n                  \n                  <div className=\"space-y-3\">\n                    <p className=\"text-center text-gray-300\">Quantidade a cancelar:</p>\n                    <div className=\"flex items-center justify-center gap-3\">\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={() => setCancelQuantity(Math.max(1, cancelQuantity - 1))}\n                        className=\"h-12 w-12 p-0 bg-gray-700 hover:bg-gray-600 border-gray-600 rounded-full\"\n                        disabled={cancelQuantity <= 1}\n                      >\n                        <Minus className=\"h-5 w-5\" />\n                      </Button>\n                      <div className=\"bg-gray-900 px-6 py-2 rounded-lg border border-gray-600\">\n                        <span className=\"text-2xl font-bold text-white\">\n                          {cancelQuantity}\n                        </span>\n                      </div>\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={() => setCancelQuantity(Math.min(itemToCancel.quantity, cancelQuantity + 1))}\n                        className=\"h-12 w-12 p-0 bg-gray-700 hover:bg-gray-600 border-gray-600 rounded-full\"\n                        disabled={cancelQuantity >= itemToCancel.quantity}\n                      >\n                        <Plus className=\"h-5 w-5\" />\n                      </Button>\n                    </div>\n                  </div>\n                  \n                  <div className=\"bg-red-900/20 border border-red-800 rounded-lg p-3\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-gray-300\">Valor a cancelar:</span>\n                      <span className=\"text-red-400 font-bold text-xl\">\n                        R$ {((itemToCancel.unit_price || itemToCancel.item?.price || 0) * cancelQuantity).toFixed(2).replace('.', ',')}\n                      </span>\n                    </div>\n                  </div>\n                </>\n              )}\n            </div>\n            \n            <DialogFooter className=\"gap-2 mt-4\">\n              <Button\n                onClick={() => setCancelQuantityDialog(false)}\n                className=\"flex-1 bg-gray-700 hover:bg-gray-600\"\n              >\n                Voltar\n              </Button>\n              <Button\n                onClick={handleConfirmCancelQuantity}\n                className=\"flex-1 bg-red-600 hover:bg-red-700\"\n              >\n                Confirmar\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        {/* Dialog Transferir Mesa */}\n        <Dialog open={transferTableDialog} onOpenChange={setTransferTableDialog}>\n          <DialogContent className=\"bg-gray-800 text-white border-gray-700\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2\">\n                <ArrowRight className=\"h-5 w-5 text-blue-400\" />\n                Transferir Mesa\n              </DialogTitle>\n              <DialogDescription className=\"text-gray-400\">\n                Transferir todos os pedidos para outra mesa\n              </DialogDescription>\n            </DialogHeader>\n            \n            <div className=\"py-4 space-y-4\">\n              <div className=\"bg-blue-900/30 border border-blue-600 rounded-lg p-3 mb-4\">\n                <div className=\"flex items-center gap-2 text-blue-400\">\n                  <AlertCircle className=\"h-4 w-4\" />\n                  <p className=\"text-sm\">\n                    Mesa atual: {selectedTable?.number || 'N/A'}\n                  </p>\n                </div>\n              </div>\n\n              <div>\n                <label className=\"text-sm font-medium mb-2 block\">\n                  Número da Mesa de Destino\n                </label>\n                <input\n                  type=\"number\"\n                  value={targetTableNumber}\n                  onChange={(e) => setTargetTableNumber(e.target.value)}\n                  className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white\"\n                  placeholder=\"Digite o número da mesa\"\n                  autoFocus\n                />\n              </div>\n            </div>\n            \n            <DialogFooter>\n              <Button\n                onClick={() => {\n                  setTransferTableDialog(false);\n                  setTargetTableNumber('');\n                }}\n                className=\"bg-gray-700 hover:bg-gray-600\"\n              >\n                Cancelar\n              </Button>\n              <Button\n                onClick={handleTransferTable}\n                disabled={loading || !targetTableNumber}\n                className=\"bg-blue-600 hover:bg-blue-700\"\n              >\n                {loading ? (\n                  <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                ) : (\n                  <>\n                    <ArrowRight className=\"mr-2 h-4 w-4\" />\n                    Transferir\n                  </>\n                )}\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n        \n        {/* Dialog Confirmar Fechamento de Conta */}\n        <Dialog open={confirmCloseTableDialog} onOpenChange={setConfirmCloseTableDialog}>\n          <DialogContent className=\"bg-gray-800 text-white border-gray-700\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2 text-orange-400\">\n                <CreditCard className=\"h-5 w-5\" />\n                Confirmar Fechamento da Conta\n              </DialogTitle>\n              <DialogDescription className=\"text-gray-400\">\n                Mesa {selectedTable?.number} - Total: {formatCurrency(calculateTotal())}\n              </DialogDescription>\n            </DialogHeader>\n            \n            <div className=\"py-4 space-y-4\">\n              <div className=\"bg-orange-900/30 border border-orange-600 rounded-lg p-4\">\n                <p className=\"text-sm text-gray-300\">\n                  Deseja realmente fechar a conta da mesa {selectedTable?.number}?\n                </p>\n                <p className=\"text-xs text-gray-400 mt-2\">\n                  A mesa ficará marcada como \"Fechada\" até o pagamento ser processado.\n                </p>\n              </div>\n              \n              <div className=\"bg-gray-700/50 rounded-lg p-4\">\n                <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                  <div className=\"text-gray-400\">Subtotal:</div>\n                  <div className=\"text-right font-medium\">{formatCurrency(calculateSubtotal())}</div>\n                  {serviceTaxPercentage > 0 && (\n                    <>\n                      <div className=\"text-gray-400\">Taxa de Serviço ({serviceTaxPercentage}%):</div>\n                      <div className=\"text-right font-medium\">{formatCurrency(calculateServiceTax())}</div>\n                    </>\n                  )}\n                  <div className=\"text-orange-400 font-bold\">Total:</div>\n                  <div className=\"text-right text-orange-400 font-bold\">{formatCurrency(calculateTotal())}</div>\n                </div>\n              </div>\n            </div>\n            \n            <DialogFooter>\n              <Button \n                variant=\"outline\" \n                onClick={() => setConfirmCloseTableDialog(false)}\n                className=\"bg-gray-700 hover:bg-gray-600 border-gray-600\"\n              >\n                Cancelar\n              </Button>\n              <Button \n                onClick={confirmCloseTable}\n                disabled={loading}\n                className=\"bg-orange-600 hover:bg-orange-700\"\n              >\n                {loading ? (\n                  <>\n                    <RefreshCw className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Fechando...\n                  </>\n                ) : (\n                  <>\n                    <Check className=\"mr-2 h-4 w-4\" />\n                    Confirmar Fechamento\n                  </>\n                )}\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n        \n        {/* Dialog Cancelar Mesa */}\n        <Dialog open={cancelTableDialog} onOpenChange={setCancelTableDialog}>\n          <DialogContent className=\"bg-gray-800 text-white border-gray-700\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2 text-red-400\">\n                <AlertCircle className=\"h-5 w-5\" />\n                Confirmar Cancelamento\n              </DialogTitle>\n              <DialogDescription className=\"text-gray-400\">\n                Esta ação não pode ser desfeita\n              </DialogDescription>\n            </DialogHeader>\n            \n            <div className=\"py-4 space-y-4\">\n              <div className=\"bg-red-900/30 border border-red-600 rounded-lg p-4\">\n                <div className=\"flex items-start gap-3\">\n                  <AlertCircle className=\"h-5 w-5 text-red-400 mt-0.5\" />\n                  <div className=\"space-y-2\">\n                    <p className=\"text-sm text-red-300 font-medium\">\n                      Tem certeza que deseja cancelar a mesa {selectedTable?.number}?\n                    </p>\n                    <ul className=\"text-xs text-gray-400 space-y-1\">\n                      <li>• Todos os pedidos serão cancelados</li>\n                      <li>• A mesa será liberada</li>\n                      <li>• A sessão será fechada</li>\n                      <li>• Esta ação não pode ser desfeita</li>\n                    </ul>\n                  </div>\n                </div>\n              </div>\n            </div>\n            \n            <DialogFooter>\n              <Button\n                onClick={() => setCancelTableDialog(false)}\n                variant=\"ghost\"\n                className=\"bg-gray-700 hover:bg-gray-600\"\n              >\n                Voltar\n              </Button>\n              <Button\n                onClick={() => {\n                  setCancelTableDialog(false);\n                  handleCancelTable();\n                }}\n                className=\"bg-red-600 hover:bg-red-700\"\n              >\n                <X className=\"mr-2 h-4 w-4\" />\n                Sim, Cancelar Mesa\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    );\n  }\n\n  // TELA 3: HISTÓRICO DE VENDAS\n  else if (screen === 'history') {\n    screenContent = (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 p-6\">\n        <div className=\"max-w-7xl mx-auto\">\n          <motion.div \n            initial={{ opacity: 0, y: -20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"mb-8\"\n          >\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h1 className=\"text-3xl font-bold text-white mb-2 flex items-center gap-3\">\n                  <History className=\"h-8 w-8 text-orange-400\" />\n                  Histórico de Vendas\n                </h1>\n                <p className=\"text-gray-400\">Vendas do dia {format(new Date(), 'dd/MM/yyyy')}</p>\n              </div>\n              <Button\n                onClick={() => setScreen('tables')}\n                className=\"bg-gray-800 hover:bg-gray-700\"\n              >\n                <ArrowLeft className=\"mr-2 h-4 w-4\" />\n                Voltar (F1)\n              </Button>\n            </div>\n          </motion.div>\n\n          {/* Estatísticas do Dia */}\n          <div className=\"grid grid-cols-4 gap-4 mb-8\">\n            <motion.div\n              initial={{ opacity: 0, scale: 0.8 }}\n              animate={{ opacity: 1, scale: 1 }}\n            >\n              <Card className=\"bg-gray-800/50 backdrop-blur border-gray-700\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"text-sm text-gray-400\">Total de Vendas</p>\n                      <p className=\"text-3xl font-bold text-white\">\n                        {formatCurrency(salesStats.totalSales)}\n                      </p>\n                    </div>\n                    <TrendingUp className=\"h-10 w-10 text-green-400\" />\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            <motion.div\n              initial={{ opacity: 0, scale: 0.8 }}\n              animate={{ opacity: 1, scale: 1 }}\n              transition={{ delay: 0.1 }}\n            >\n              <Card className=\"bg-gray-800/50 backdrop-blur border-gray-700\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"text-sm text-gray-400\">Pedidos</p>\n                      <p className=\"text-3xl font-bold text-white\">\n                        {salesStats.totalOrders}\n                      </p>\n                    </div>\n                    <Receipt className=\"h-10 w-10 text-blue-400\" />\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            <motion.div\n              initial={{ opacity: 0, scale: 0.8 }}\n              animate={{ opacity: 1, scale: 1 }}\n              transition={{ delay: 0.2 }}\n            >\n              <Card className=\"bg-gray-800/50 backdrop-blur border-gray-700\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"text-sm text-gray-400\">Ticket Médio</p>\n                      <p className=\"text-3xl font-bold text-white\">\n                        {formatCurrency(salesStats.averageTicket)}\n                      </p>\n                    </div>\n                    <Calculator className=\"h-10 w-10 text-purple-400\" />\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            <motion.div\n              initial={{ opacity: 0, scale: 0.8 }}\n              animate={{ opacity: 1, scale: 1 }}\n              transition={{ delay: 0.3 }}\n            >\n              <Card className=\"bg-gray-800/50 backdrop-blur border-gray-700\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"text-sm text-gray-400\">Mesas Atendidas</p>\n                      <p className=\"text-3xl font-bold text-white\">\n                        {new Set(todayOrders.map(o => o.table_id)).size}\n                      </p>\n                    </div>\n                    <UtensilsCrossed className=\"h-10 w-10 text-orange-400\" />\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          </div>\n\n          <div className=\"grid grid-cols-3 gap-6\">\n            {/* Produtos Mais Vendidos */}\n            <Card className=\"bg-gray-800/50 backdrop-blur border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Star className=\"h-5 w-5 text-yellow-400\" />\n                  Top 5 Produtos\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {salesStats.topProducts.map((product, index) => (\n                    <motion.div\n                      key={product.name}\n                      initial={{ opacity: 0, x: -20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      transition={{ delay: index * 0.1 }}\n                      className=\"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg\"\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        <div className={`\n                          w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold\n                          ${index === 0 ? 'bg-yellow-600' : index === 1 ? 'bg-gray-400' : index === 2 ? 'bg-orange-600' : 'bg-gray-600'}\n                        `}>\n                          {index + 1}º\n                        </div>\n                        <div>\n                          <div className=\"font-medium text-white\">{product.name}</div>\n                          <div className=\"text-xs text-gray-400\">{product.quantity} unidades</div>\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <div className=\"font-bold text-orange-400\">\n                          {formatCurrency(product.total)}\n                        </div>\n                      </div>\n                    </motion.div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Lista de Pedidos */}\n            <Card className=\"col-span-2 bg-gray-800/50 backdrop-blur border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <FileText className=\"h-5 w-5\" />\n                  Pedidos Recentes\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <ScrollArea className=\"h-[400px]\">\n                  <div className=\"space-y-2\">\n                    {todayOrders.slice(0, 10).map((order, index) => (\n                      <motion.div\n                        key={order.id}\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        transition={{ delay: index * 0.05 }}\n                      >\n                        <Card className=\"bg-gray-900/50 border-gray-700\">\n                          <CardContent className=\"p-3\">\n                            <div className=\"flex items-center justify-between\">\n                              <div>\n                                <div className=\"flex items-center gap-2\">\n                                  <span className=\"font-medium text-white\">\n                                    Pedido #{order.order_number}\n                                  </span>\n                                  <Badge className={`\n                                    ${order.payment_status === 'paid' ? 'bg-green-600' : \n                                      order.payment_status === 'pending' ? 'bg-yellow-600' : 'bg-red-600'}\n                                  `}>\n                                    {order.payment_status === 'paid' ? 'Pago' : \n                                     order.payment_status === 'pending' ? 'Pendente' : 'Cancelado'}\n                                  </Badge>\n                                </div>\n                                <div className=\"text-sm text-gray-400 mt-1\">\n                                  Mesa {order.table_id} • {order.items?.length || 0} itens • \n                                  {order.created_at && format(new Date(order.created_at), ' HH:mm')}\n                                </div>\n                              </div>\n                              <div className=\"text-right\">\n                                <div className=\"font-bold text-lg text-orange-400\">\n                                  {formatCurrency(order.total)}\n                                </div>\n                                {order.payment_method && (\n                                  <div className=\"text-xs text-gray-400\">\n                                    {order.payment_method === 'cash' ? 'Dinheiro' :\n                                     order.payment_method === 'card' ? 'Cartão' : 'PIX'}\n                                  </div>\n                                )}\n                              </div>\n                            </div>\n                          </CardContent>\n                        </Card>\n                      </motion.div>\n                    ))}\n                  </div>\n                </ScrollArea>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // RETURN ÚNICO FINAL - Renderiza o modal e o conteúdo da tela\n  return (\n    <>\n      {rodizioDialogModal}\n      {screenContent}\n    </>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}