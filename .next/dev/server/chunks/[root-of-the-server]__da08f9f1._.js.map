{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/console-prompt-service.ts"],"sourcesContent":["// Servi√ßo de Console Prompt interno ao Next.js\n// Simula o comportamento do workflow externo mas roda dentro do pr√≥prio servidor\n\ninterface ConsoleMessage {\n  type: 'prompt' | 'image' | 'clear'\n  content?: string\n  images?: string[]\n  timestamp: string\n}\n\nclass ConsolePromptService {\n  private messages: ConsoleMessage[] = []\n  private isEnabled: boolean = true\n\n  constructor() {\n    // Limpar console ao iniciar\n    this.clearConsole()\n    this.printHeader()\n  }\n\n  private clearConsole() {\n    if (typeof process !== 'undefined' && process.stdout) {\n      // Limpar console completamente\n      process.stdout.write('\\x1Bc')\n      process.stdout.write('\\x1b[0;0H')\n    }\n  }\n\n  private printHeader() {\n    console.log('‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó')\n    console.log('‚ïë     Console Prompt Service (Interno)      ‚ïë')\n    console.log('‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù')\n    console.log('\\nüöÄ Servi√ßo integrado ao Next.js')\n    console.log('üìù Aguardando prompts...\\n')\n  }\n\n  public handlePrompt(prompt: string, images?: string[]) {\n    if (!this.isEnabled) return\n\n    // Limpar console antes de mostrar novo prompt\n    this.clearConsole()\n    \n    if (prompt) {\n      console.log('================== PROMPT ==================')\n      console.log(prompt)\n      console.log('============================================')\n      \n      this.messages.push({\n        type: 'prompt',\n        content: prompt,\n        timestamp: new Date().toISOString()\n      })\n    }\n    \n    if (images && images.length > 0) {\n      console.log('\\nüìé Imagens anexadas:')\n      images.forEach((path, index) => {\n        console.log(`  ${index + 1}. ${path}`)\n      })\n      \n      this.messages.push({\n        type: 'image',\n        images,\n        timestamp: new Date().toISOString()\n      })\n    }\n  }\n\n  public clear() {\n    this.clearConsole()\n    this.messages = []\n    console.log('‚ú® Console Prompt Service limpo')\n    \n    this.messages.push({\n      type: 'clear',\n      timestamp: new Date().toISOString()\n    })\n  }\n\n  public getMessages() {\n    return this.messages\n  }\n\n  public setEnabled(enabled: boolean) {\n    this.isEnabled = enabled\n  }\n\n  public isServiceEnabled() {\n    return this.isEnabled\n  }\n}\n\n// Singleton instance\nlet serviceInstance: ConsolePromptService | null = null\n\nexport function getConsolePromptService(): ConsolePromptService {\n  if (!serviceInstance) {\n    serviceInstance = new ConsolePromptService()\n  }\n  return serviceInstance\n}\n\nexport default getConsolePromptService"],"names":[],"mappings":"AAAA,+CAA+C;AAC/C,iFAAiF;;;;;;;AASjF,MAAM;IACI,WAA6B,EAAE,CAAA;IAC/B,YAAqB,KAAI;IAEjC,aAAc;QACZ,4BAA4B;QAC5B,IAAI,CAAC,YAAY;QACjB,IAAI,CAAC,WAAW;IAClB;IAEQ,eAAe;QACrB,IAAI,OAAO,YAAY,eAAe,QAAQ,MAAM,EAAE;YACpD,+BAA+B;YAC/B,QAAQ,MAAM,CAAC,KAAK,CAAC;YACrB,QAAQ,MAAM,CAAC,KAAK,CAAC;QACvB;IACF;IAEQ,cAAc;QACpB,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC;IACd;IAEO,aAAa,MAAc,EAAE,MAAiB,EAAE;QACrD,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;QAErB,8CAA8C;QAC9C,IAAI,CAAC,YAAY;QAEjB,IAAI,QAAQ;YACV,QAAQ,GAAG,CAAC;YACZ,QAAQ,GAAG,CAAC;YACZ,QAAQ,GAAG,CAAC;YAEZ,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;gBACjB,MAAM;gBACN,SAAS;gBACT,WAAW,IAAI,OAAO,WAAW;YACnC;QACF;QAEA,IAAI,UAAU,OAAO,MAAM,GAAG,GAAG;YAC/B,QAAQ,GAAG,CAAC;YACZ,OAAO,OAAO,CAAC,CAAC,MAAM;gBACpB,QAAQ,GAAG,CAAC,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE,EAAE,MAAM;YACvC;YAEA,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;gBACjB,MAAM;gBACN;gBACA,WAAW,IAAI,OAAO,WAAW;YACnC;QACF;IACF;IAEO,QAAQ;QACb,IAAI,CAAC,YAAY;QACjB,IAAI,CAAC,QAAQ,GAAG,EAAE;QAClB,QAAQ,GAAG,CAAC;QAEZ,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;YACjB,MAAM;YACN,WAAW,IAAI,OAAO,WAAW;QACnC;IACF;IAEO,cAAc;QACnB,OAAO,IAAI,CAAC,QAAQ;IACtB;IAEO,WAAW,OAAgB,EAAE;QAClC,IAAI,CAAC,SAAS,GAAG;IACnB;IAEO,mBAAmB;QACxB,OAAO,IAAI,CAAC,SAAS;IACvB;AACF;AAEA,qBAAqB;AACrB,IAAI,kBAA+C;AAE5C,SAAS;IACd,IAAI,CAAC,iBAAiB;QACpB,kBAAkB,IAAI;IACxB;IACA,OAAO;AACT;uCAEe","debugId":null}},
    {"offset": {"line": 134, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/prompt-message/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport getConsolePromptService from '@/lib/console-prompt-service'\n\n// Configura√ß√µes dos servidores de console\nconst CONSOLE_SERVERS = [\n  {\n    name: 'Prompt Console (TypeScript)',\n    port: 3456,\n    endpoints: {\n      message: 'http://localhost:3456/prompt-message',\n      health: 'http://localhost:3456/health'\n    }\n  },\n  {\n    name: 'Console Prompt Workflow (JavaScript)', \n    port: 3001,\n    endpoints: {\n      message: 'http://localhost:3001/console-prompt',\n      health: 'http://localhost:3001/console-prompt'\n    }\n  }\n]\n\n// Tenta conectar com os servidores externos na ordem de prioridade\nasync function tryExternalServers(method: string, body?: any): Promise<{response: Response | null, server: string}> {\n  // Primeiro tenta o server TypeScript na porta 3456\n  for (const server of CONSOLE_SERVERS) {\n    try {\n      const endpoint = method === 'POST' || method === 'DELETE' \n        ? server.endpoints.message \n        : server.endpoints.health\n        \n      const response = await fetch(endpoint, {\n        method: method === 'DELETE' && server.port === 3001 ? 'DELETE' : method === 'DELETE' ? 'POST' : method,\n        headers: body ? { 'Content-Type': 'application/json' } : undefined,\n        body: body ? JSON.stringify(body) : undefined,\n        signal: AbortSignal.timeout(500) // timeout r√°pido\n      })\n      \n      if (response.ok) {\n        return { response, server: server.name }\n      }\n    } catch (error) {\n      // Continua para o pr√≥ximo servidor\n      continue\n    }\n  }\n  \n  return { response: null, server: '' }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    \n    // Se for comando de limpar\n    if (body.clear) {\n      // Para o servidor TypeScript (3456), enviamos como POST com { clear: true }\n      const { response: externalResponse, server } = await tryExternalServers('POST', { clear: true })\n      \n      if (externalResponse && externalResponse.ok) {\n        return NextResponse.json({ \n          success: true, \n          server,\n          port: server.includes('TypeScript') ? 3456 : 3001\n        })\n      }\n      \n      // Usar servi√ßo interno como fallback\n      const service = getConsolePromptService()\n      service.clear()\n      return NextResponse.json({ \n        success: true, \n        server: 'Console Prompt Service (Interno)',\n        note: 'Para usar o Console Prompt colorido, execute: tsx server/prompt-console.ts'\n      })\n    }\n    \n    // Enviar mensagem normal\n    const { message, imageId } = body\n    \n    // Preparar payload para o servidor TypeScript\n    const payload: any = {}\n    if (message) {\n      payload.message = message\n    }\n    if (imageId) {\n      payload.imageId = imageId\n      // Adiciona caminho da imagem na mensagem  \n      payload.message = (payload.message || '') + ` [Imagem: attachments/${imageId}.jpg]`\n    }\n    \n    // Tentar servidores externos primeiro\n    const { response: externalResponse, server } = await tryExternalServers('POST', payload)\n    \n    if (externalResponse && externalResponse.ok) {\n      const result = await externalResponse.json()\n      return NextResponse.json({ \n        success: true, \n        server,\n        port: server.includes('TypeScript') ? 3456 : 3001,\n        ...result \n      })\n    }\n    \n    // Usar servi√ßo interno como fallback\n    const service = getConsolePromptService()\n    const images = imageId ? [`attachments/${imageId}.jpg`] : []\n    service.handlePrompt(message || '', images)\n    \n    return NextResponse.json({ \n      success: true, \n      server: 'Console Prompt Service (Interno)',\n      message: 'Prompt exibido no console do servidor Next.js',\n      note: 'Para usar o Console Prompt colorido, execute: tsx server/prompt-console.ts'\n    })\n    \n  } catch (error: any) {\n    console.error('Erro ao processar requisi√ß√£o:', error)\n    return NextResponse.json(\n      { \n        error: 'Erro ao processar requisi√ß√£o',\n        details: error.message \n      },\n      { status: 500 }\n    )\n  }\n}\n\n// GET para verificar status dos servidores\nexport async function GET() {\n  const status = {\n    servers: [] as any[],\n    activeServer: null as string | null,\n    instructions: {\n      typescript: 'tsx server/prompt-console.ts',\n      javascript: 'node console-prompt-workflow.js'\n    }\n  }\n  \n  // Verificar cada servidor\n  for (const server of CONSOLE_SERVERS) {\n    try {\n      const response = await fetch(server.endpoints.health, {\n        method: 'GET',\n        signal: AbortSignal.timeout(500)\n      })\n      \n      if (response.ok) {\n        const data = await response.json()\n        status.servers.push({\n          name: server.name,\n          port: server.port,\n          status: 'online',\n          ...data\n        })\n        \n        if (!status.activeServer) {\n          status.activeServer = server.name\n        }\n      } else {\n        status.servers.push({\n          name: server.name,\n          port: server.port,\n          status: 'offline'\n        })\n      }\n    } catch (error) {\n      status.servers.push({\n        name: server.name,\n        port: server.port,\n        status: 'offline'\n      })\n    }\n  }\n  \n  // Verificar servi√ßo interno\n  const service = getConsolePromptService()\n  if (service.isServiceEnabled()) {\n    status.servers.push({\n      name: 'Console Prompt Service (Interno)',\n      status: 'online',\n      internal: true,\n      messages: service.getMessages()\n    })\n    \n    if (!status.activeServer) {\n      status.activeServer = 'Console Prompt Service (Interno)'\n    }\n  }\n  \n  return NextResponse.json({\n    ...status,\n    connected: status.activeServer !== null\n  })\n}"],"names":[],"mappings":"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","debugId":null}}]
}