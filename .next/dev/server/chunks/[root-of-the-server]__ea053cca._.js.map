{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/printers/detect-local/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { exec } from \"child_process\";\nimport { promisify } from \"util\";\nimport os from \"os\";\n\nconst execAsync = promisify(exec);\n\n// Fun√ß√£o para detectar impressoras no Windows usando WMIC\nasync function detectWindowsPrinters() {\n  try {\n    console.log('üñ®Ô∏è Detectando impressoras Windows com WMIC...');\n    \n    // Primeiro, tentar formato lista mais simples (mais confi√°vel)\n    try {\n      const { stdout: listOutput } = await execAsync('wmic printer get name /format:value');\n      console.log('üìÑ Sa√≠da WMIC (formato value):', listOutput);\n      \n      // Parser para formato value (Name=PrinterName)\n      const printers = [];\n      const lines = listOutput.split('\\n');\n      \n      for (const line of lines) {\n        const trimmedLine = line.trim();\n        if (trimmedLine.startsWith('Name=')) {\n          const printerName = trimmedLine.substring(5).trim();\n          if (printerName && printerName.length > 0) {\n            // Obter detalhes adicionais para esta impressora\n            let printerInfo: any = {\n              name: printerName,\n              port: 'Local',\n              driver: 'Windows Driver',\n              status: 'Ready',\n              type: detectPrinterType(printerName, ''),\n              os: 'Windows',\n              detected_via: 'WMIC'\n            };\n            \n            // Tentar obter mais informa√ß√µes sobre a impressora\n            try {\n              const { stdout: detailOutput } = await execAsync(`wmic printer where name=\"${printerName.replace(/\"/g, '\\\\\"')}\" get portname,drivername,printerstatus /format:list`);\n              const detailLines = detailOutput.split('\\n');\n              \n              for (const detailLine of detailLines) {\n                const trimmed = detailLine.trim();\n                if (trimmed.startsWith('PortName=')) {\n                  printerInfo.port = trimmed.substring(9).trim() || 'Local';\n                } else if (trimmed.startsWith('DriverName=')) {\n                  printerInfo.driver = trimmed.substring(11).trim() || 'Windows Driver';\n                  printerInfo.type = detectPrinterType(printerName, printerInfo.driver);\n                } else if (trimmed.startsWith('PrinterStatus=')) {\n                  const statusCode = trimmed.substring(14).trim();\n                  printerInfo.status = statusCode === '3' ? 'Ready' : \n                                     statusCode === '1' ? 'Paused' : \n                                     statusCode === '2' ? 'Error' : 'Unknown';\n                }\n              }\n            } catch (detailError) {\n              console.log(`‚ö†Ô∏è N√£o foi poss√≠vel obter detalhes para ${printerName}`);\n            }\n            \n            printers.push(printerInfo);\n            console.log(`‚úÖ Impressora detectada: ${printerName}`);\n          }\n        }\n      }\n      \n      if (printers.length > 0) {\n        console.log(`‚úÖ Total: ${printers.length} impressoras encontradas no Windows`);\n        return printers;\n      }\n    } catch (valueError) {\n      console.log('‚ö†Ô∏è Formato value falhou, tentando formato CSV...');\n    }\n    \n    // Fallback: tentar formato CSV original\n    const { stdout } = await execAsync('wmic printer get name,portname,drivername,status /format:csv');\n    console.log('üìÑ Sa√≠da WMIC (formato CSV):', stdout.substring(0, 500));\n    \n    // Parsear sa√≠da CSV do WMIC\n    const lines = stdout.split(/\\r?\\n/).filter(line => line.trim());\n    const printers = [];\n    \n    // Debug: mostrar primeiras linhas\n    console.log('Primeiras 5 linhas do CSV:');\n    lines.slice(0, 5).forEach((line, i) => {\n      console.log(`  Linha ${i}: \"${line}\"`);\n    });\n    \n    // WMIC CSV geralmente tem formato: Node,DriverName,Name,PortName,Status\n    // A primeira linha com v√≠rgulas √© o header\n    let headerIndex = -1;\n    let headers: string[] = [];\n    \n    for (let i = 0; i < lines.length; i++) {\n      if (lines[i].includes(',')) {\n        headerIndex = i;\n        headers = lines[i].split(',').map(h => h.trim());\n        console.log(`Headers encontrados na linha ${i}: ${headers.join(', ')}`);\n        break;\n      }\n    }\n    \n    if (headerIndex === -1) {\n      console.error('‚ùå Headers n√£o encontrados na sa√≠da WMIC');\n      return [];\n    }\n    \n    // Encontrar √≠ndice da coluna Name\n    const nameIndex = headers.findIndex(h => h.toLowerCase() === 'name');\n    const portIndex = headers.findIndex(h => h.toLowerCase() === 'portname');\n    const driverIndex = headers.findIndex(h => h.toLowerCase() === 'drivername');\n    const statusIndex = headers.findIndex(h => h.toLowerCase() === 'status');\n    \n    console.log(`√çndices: Name=${nameIndex}, Port=${portIndex}, Driver=${driverIndex}, Status=${statusIndex}`);\n    \n    if (nameIndex === -1) {\n      console.error('‚ùå Coluna \"Name\" n√£o encontrada nos headers');\n      return [];\n    }\n    \n    // Process data lines (after header)\n    for (let i = headerIndex + 1; i < lines.length; i++) {\n      const line = lines[i];\n      if (!line || line.trim() === '') continue;\n      \n      const values = line.split(',').map(v => v.trim());\n      const printerName = values[nameIndex];\n      \n      if (printerName && printerName.length > 0) {\n        const printer: any = {\n          name: printerName,\n          port: portIndex >= 0 ? (values[portIndex] || 'Local') : 'Local',\n          driver: driverIndex >= 0 ? (values[driverIndex] || 'Windows Driver') : 'Windows Driver',\n          status: statusIndex >= 0 ? (values[statusIndex] || 'Ready') : 'Ready',\n          type: detectPrinterType(printerName, driverIndex >= 0 ? values[driverIndex] : ''),\n          os: 'Windows',\n          detected_via: 'WMIC'\n        };\n        \n        printers.push(printer);\n        console.log(`‚úÖ Impressora detectada: ${printerName}`);\n      }\n    }\n    \n    console.log(`‚úÖ Total: ${printers.length} impressoras encontradas no Windows`);\n    return printers;\n  } catch (error: any) {\n    console.error('‚ùå Erro ao detectar impressoras Windows:', error.message);\n    \n    // √öltima tentativa: usar PowerShell\n    try {\n      console.log('üîÑ Tentando com PowerShell...');\n      const { stdout } = await execAsync('powershell -Command \"Get-Printer | Select-Object Name, PortName, DriverName | ConvertTo-Json\"');\n      const printerData = JSON.parse(stdout);\n      const printers = [];\n      \n      // Garantir que sempre seja um array\n      const printerArray = Array.isArray(printerData) ? printerData : [printerData];\n      \n      for (const p of printerArray) {\n        if (p.Name) {\n          printers.push({\n            name: p.Name,\n            port: p.PortName || 'Local',\n            driver: p.DriverName || 'Windows Driver',\n            status: 'Ready',\n            type: detectPrinterType(p.Name, p.DriverName || ''),\n            os: 'Windows',\n            detected_via: 'PowerShell'\n          });\n          console.log(`‚úÖ Impressora detectada via PowerShell: ${p.Name}`);\n        }\n      }\n      \n      return printers;\n    } catch (psError) {\n      console.error('‚ùå PowerShell tamb√©m falhou:', psError);\n      throw error;\n    }\n  }\n}\n\n// Fun√ß√£o para detectar impressoras no Linux\nasync function detectLinuxPrinters() {\n  try {\n    console.log('üñ®Ô∏è Detectando impressoras Linux com lpstat...');\n    \n    // Tentar usar lpstat (CUPS)\n    const { stdout } = await execAsync('lpstat -p -d');\n    const lines = stdout.split('\\n').filter(line => line.trim());\n    const printers = [];\n    \n    for (const line of lines) {\n      if (line.startsWith('printer')) {\n        const match = line.match(/printer\\s+(\\S+)/);\n        if (match) {\n          const printerName = match[1];\n          \n          // Tentar obter mais informa√ß√µes\n          let printerInfo: any = {\n            name: printerName,\n            status: line.includes('enabled') ? 'Ready' : 'Offline',\n            os: 'Linux',\n            detected_via: 'CUPS'\n          };\n          \n          // Tentar obter informa√ß√µes adicionais\n          try {\n            const { stdout: info } = await execAsync(`lpstat -l -p ${printerName}`);\n            if (info.includes('USB')) printerInfo.port = 'USB';\n            if (info.includes('network')) printerInfo.port = 'Network';\n            printerInfo.type = detectPrinterType(printerName, info);\n          } catch {}\n          \n          printers.push(printerInfo);\n        }\n      }\n    }\n    \n    console.log(`‚úÖ ${printers.length} impressoras encontradas no Linux`);\n    return printers;\n  } catch (error: any) {\n    console.error('‚ùå Erro ao detectar impressoras Linux:', error.message);\n    return [];\n  }\n}\n\n// Fun√ß√£o para detectar impressoras no macOS\nasync function detectMacPrinters() {\n  try {\n    console.log('üñ®Ô∏è Detectando impressoras macOS...');\n    \n    // Usar lpstat no macOS (similar ao Linux)\n    const { stdout } = await execAsync('lpstat -p');\n    const lines = stdout.split('\\n').filter(line => line.trim());\n    const printers = [];\n    \n    for (const line of lines) {\n      if (line.startsWith('printer')) {\n        const match = line.match(/printer\\s+(\\S+)/);\n        if (match) {\n          printers.push({\n            name: match[1],\n            status: line.includes('enabled') ? 'Ready' : 'Offline',\n            os: 'macOS',\n            detected_via: 'CUPS'\n          });\n        }\n      }\n    }\n    \n    // Tentar tamb√©m o comando system_profiler para mais detalhes\n    try {\n      const { stdout: spOutput } = await execAsync('system_profiler SPPrintersDataType -json');\n      const data = JSON.parse(spOutput);\n      // Processar dados do system_profiler se dispon√≠vel\n      if (data.SPPrintersDataType) {\n        for (const printer of data.SPPrintersDataType) {\n          const existing = printers.find(p => p.name === printer._name);\n          if (existing) {\n            existing.driver = printer.driver_version;\n            existing.port = printer.uri || 'Unknown';\n            existing.type = detectPrinterType(printer._name, printer.driver_version);\n          } else {\n            printers.push({\n              name: printer._name,\n              driver: printer.driver_version,\n              port: printer.uri || 'Unknown',\n              status: printer.printer_status || 'Unknown',\n              type: detectPrinterType(printer._name, printer.driver_version),\n              os: 'macOS',\n              detected_via: 'system_profiler'\n            });\n          }\n        }\n      }\n    } catch {}\n    \n    console.log(`‚úÖ ${printers.length} impressoras encontradas no macOS`);\n    return printers;\n  } catch (error: any) {\n    console.error('‚ùå Erro ao detectar impressoras macOS:', error.message);\n    return [];\n  }\n}\n\n// Fun√ß√£o auxiliar para detectar tipo de impressora\nfunction detectPrinterType(name: string, driver: string): string {\n  const nameLower = name.toLowerCase();\n  const driverLower = driver.toLowerCase();\n  \n  // Verificar se √© t√©rmica\n  if (nameLower.includes('thermal') || driverLower.includes('thermal') ||\n      nameLower.includes('pos') || driverLower.includes('pos') ||\n      nameLower.includes('receipt') || driverLower.includes('receipt') ||\n      nameLower.includes('epson tm') || nameLower.includes('bematech') ||\n      nameLower.includes('elgin') || nameLower.includes('daruma') ||\n      nameLower.includes('tanca') || nameLower.includes('sweda')) {\n    return 'thermal';\n  }\n  \n  // Verificar se √© PDF/Virtual\n  if (nameLower.includes('pdf') || nameLower.includes('xps') ||\n      nameLower.includes('onenote') || nameLower.includes('fax') ||\n      nameLower.includes('virtual') || nameLower.includes('print to file')) {\n    return 'virtual';\n  }\n  \n  // Verificar se √© laser\n  if (nameLower.includes('laser') || nameLower.includes('laserjet') ||\n      driverLower.includes('laser')) {\n    return 'laser';\n  }\n  \n  // Verificar se √© jato de tinta\n  if (nameLower.includes('inkjet') || nameLower.includes('deskjet') ||\n      nameLower.includes('officejet') || driverLower.includes('inkjet')) {\n    return 'inkjet';\n  }\n  \n  // Verificar se √© matricial\n  if (nameLower.includes('dot matrix') || nameLower.includes('matricial') ||\n      nameLower.includes('lx-') || nameLower.includes('fx-')) {\n    return 'dot-matrix';\n  }\n  \n  return 'unknown';\n}\n\n// GET /api/printers/detect-local\nexport async function GET() {\n  try {\n    const platform = os.platform();\n    console.log(`üñ•Ô∏è Sistema operacional detectado: ${platform}`);\n    \n    let printers: any[] = [];\n    let error = null;\n    \n    switch (platform) {\n      case 'win32':\n        try {\n          printers = await detectWindowsPrinters();\n        } catch (e: any) {\n          error = `Windows: ${e.message}`;\n        }\n        break;\n        \n      case 'linux':\n        try {\n          printers = await detectLinuxPrinters();\n        } catch (e: any) {\n          error = `Linux: ${e.message}`;\n        }\n        break;\n        \n      case 'darwin':\n        try {\n          printers = await detectMacPrinters();\n        } catch (e: any) {\n          error = `macOS: ${e.message}`;\n        }\n        break;\n        \n      default:\n        error = `Sistema operacional n√£o suportado: ${platform}`;\n    }\n    \n    // Adicionar informa√ß√µes extras\n    const response = {\n      success: !error || printers.length > 0,\n      platform,\n      hostname: os.hostname(),\n      printers,\n      count: printers.length,\n      error,\n      timestamp: new Date().toISOString(),\n      message: printers.length > 0 \n        ? `${printers.length} impressora(s) encontrada(s)`\n        : error || 'Nenhuma impressora encontrada'\n    };\n    \n    // Se encontrou impressoras, filtrar as t√©rmicas\n    if (printers.length > 0) {\n      const thermalPrinters = printers.filter(p => p.type === 'thermal');\n      if (thermalPrinters.length > 0) {\n        response.message += ` (${thermalPrinters.length} t√©rmica(s))`;\n      }\n    }\n    \n    return NextResponse.json(response);\n    \n  } catch (error: any) {\n    console.error('‚ùå Erro na detec√ß√£o de impressoras:', error);\n    return NextResponse.json({\n      success: false,\n      error: error.message || 'Erro ao detectar impressoras',\n      platform: os.platform(),\n      hostname: os.hostname(),\n      printers: [],\n      count: 0\n    }, { status: 500 });\n  }\n}\n\n// Fun√ß√£o para sanitizar nome da impressora (prevenir command injection)\nfunction sanitizePrinterName(name: string): string {\n  // Remove caracteres perigosos que podem causar command injection\n  // Permite apenas letras, n√∫meros, espa√ßos, h√≠fen, underscore e ponto\n  return name.replace(/[^a-zA-Z0-9\\s\\-_\\.]/g, '');\n}\n\n// POST /api/printers/detect-local - Detectar e testar impressora espec√≠fica\nexport async function POST(request: Request) {\n  try {\n    const { printerName } = await request.json();\n    \n    if (!printerName) {\n      return NextResponse.json({\n        success: false,\n        error: 'Nome da impressora √© obrigat√≥rio'\n      }, { status: 400 });\n    }\n    \n    // Sanitizar nome da impressora para prevenir command injection\n    const safePrinterName = sanitizePrinterName(printerName);\n    \n    if (safePrinterName !== printerName) {\n      console.warn(`‚ö†Ô∏è Nome da impressora sanitizado: \"${printerName}\" -> \"${safePrinterName}\"`);\n    }\n    \n    const platform = os.platform();\n    console.log(`üñ®Ô∏è Testando impressora \"${safePrinterName}\" no ${platform}...`);\n    \n    // Comando para enviar teste de impress√£o\n    let command = '';\n    \n    switch (platform) {\n      case 'win32':\n        // No Windows, podemos usar print ou PowerShell\n        command = `powershell -Command \"Out-Printer -Name '${safePrinterName}' -InputObject 'TESTE COMIDEX - ${new Date().toLocaleString('pt-BR')}'\"`;\n        break;\n        \n      case 'linux':\n      case 'darwin':\n        // No Linux/Mac, usar lp\n        command = `echo \"TESTE COMIDEX - ${new Date().toLocaleString('pt-BR')}\" | lp -d \"${safePrinterName}\"`;\n        break;\n        \n      default:\n        return NextResponse.json({\n          success: false,\n          error: `Sistema n√£o suportado: ${platform}`\n        }, { status: 400 });\n    }\n    \n    const { stdout, stderr } = await execAsync(command);\n    \n    return NextResponse.json({\n      success: !stderr,\n      message: stderr ? `Erro: ${stderr}` : 'Teste enviado com sucesso',\n      printerName: safePrinterName,\n      platform,\n      output: stdout || 'Comando executado com sucesso'\n    });\n    \n  } catch (error: any) {\n    console.error('‚ùå Erro ao testar impressora:', error);\n    return NextResponse.json({\n      success: false,\n      error: error.message || 'Erro ao testar impressora'\n    }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,YAAY,IAAA,8GAAS,EAAC,2HAAI;AAEhC,0DAA0D;AAC1D,eAAe;IACb,IAAI;QACF,QAAQ,GAAG,CAAC;QAEZ,+DAA+D;QAC/D,IAAI;YACF,MAAM,EAAE,QAAQ,UAAU,EAAE,GAAG,MAAM,UAAU;YAC/C,QAAQ,GAAG,CAAC,kCAAkC;YAE9C,+CAA+C;YAC/C,MAAM,WAAW,EAAE;YACnB,MAAM,QAAQ,WAAW,KAAK,CAAC;YAE/B,KAAK,MAAM,QAAQ,MAAO;gBACxB,MAAM,cAAc,KAAK,IAAI;gBAC7B,IAAI,YAAY,UAAU,CAAC,UAAU;oBACnC,MAAM,cAAc,YAAY,SAAS,CAAC,GAAG,IAAI;oBACjD,IAAI,eAAe,YAAY,MAAM,GAAG,GAAG;wBACzC,iDAAiD;wBACjD,IAAI,cAAmB;4BACrB,MAAM;4BACN,MAAM;4BACN,QAAQ;4BACR,QAAQ;4BACR,MAAM,kBAAkB,aAAa;4BACrC,IAAI;4BACJ,cAAc;wBAChB;wBAEA,mDAAmD;wBACnD,IAAI;4BACF,MAAM,EAAE,QAAQ,YAAY,EAAE,GAAG,MAAM,UAAU,CAAC,yBAAyB,EAAE,YAAY,OAAO,CAAC,MAAM,OAAO,oDAAoD,CAAC;4BACnK,MAAM,cAAc,aAAa,KAAK,CAAC;4BAEvC,KAAK,MAAM,cAAc,YAAa;gCACpC,MAAM,UAAU,WAAW,IAAI;gCAC/B,IAAI,QAAQ,UAAU,CAAC,cAAc;oCACnC,YAAY,IAAI,GAAG,QAAQ,SAAS,CAAC,GAAG,IAAI,MAAM;gCACpD,OAAO,IAAI,QAAQ,UAAU,CAAC,gBAAgB;oCAC5C,YAAY,MAAM,GAAG,QAAQ,SAAS,CAAC,IAAI,IAAI,MAAM;oCACrD,YAAY,IAAI,GAAG,kBAAkB,aAAa,YAAY,MAAM;gCACtE,OAAO,IAAI,QAAQ,UAAU,CAAC,mBAAmB;oCAC/C,MAAM,aAAa,QAAQ,SAAS,CAAC,IAAI,IAAI;oCAC7C,YAAY,MAAM,GAAG,eAAe,MAAM,UACvB,eAAe,MAAM,WACrB,eAAe,MAAM,UAAU;gCACpD;4BACF;wBACF,EAAE,OAAO,aAAa;4BACpB,QAAQ,GAAG,CAAC,CAAC,wCAAwC,EAAE,aAAa;wBACtE;wBAEA,SAAS,IAAI,CAAC;wBACd,QAAQ,GAAG,CAAC,CAAC,wBAAwB,EAAE,aAAa;oBACtD;gBACF;YACF;YAEA,IAAI,SAAS,MAAM,GAAG,GAAG;gBACvB,QAAQ,GAAG,CAAC,CAAC,SAAS,EAAE,SAAS,MAAM,CAAC,mCAAmC,CAAC;gBAC5E,OAAO;YACT;QACF,EAAE,OAAO,YAAY;YACnB,QAAQ,GAAG,CAAC;QACd;QAEA,wCAAwC;QACxC,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,UAAU;QACnC,QAAQ,GAAG,CAAC,gCAAgC,OAAO,SAAS,CAAC,GAAG;QAEhE,4BAA4B;QAC5B,MAAM,QAAQ,OAAO,KAAK,CAAC,SAAS,MAAM,CAAC,CAAA,OAAQ,KAAK,IAAI;QAC5D,MAAM,WAAW,EAAE;QAEnB,kCAAkC;QAClC,QAAQ,GAAG,CAAC;QACZ,MAAM,KAAK,CAAC,GAAG,GAAG,OAAO,CAAC,CAAC,MAAM;YAC/B,QAAQ,GAAG,CAAC,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;QACvC;QAEA,wEAAwE;QACxE,2CAA2C;QAC3C,IAAI,cAAc,CAAC;QACnB,IAAI,UAAoB,EAAE;QAE1B,IAAK,IAAI,IAAI,GAAG,IAAI,MAAM,MAAM,EAAE,IAAK;YACrC,IAAI,KAAK,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM;gBAC1B,cAAc;gBACd,UAAU,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAA,IAAK,EAAE,IAAI;gBAC7C,QAAQ,GAAG,CAAC,CAAC,6BAA6B,EAAE,EAAE,EAAE,EAAE,QAAQ,IAAI,CAAC,OAAO;gBACtE;YACF;QACF;QAEA,IAAI,gBAAgB,CAAC,GAAG;YACtB,QAAQ,KAAK,CAAC;YACd,OAAO,EAAE;QACX;QAEA,kCAAkC;QAClC,MAAM,YAAY,QAAQ,SAAS,CAAC,CAAA,IAAK,EAAE,WAAW,OAAO;QAC7D,MAAM,YAAY,QAAQ,SAAS,CAAC,CAAA,IAAK,EAAE,WAAW,OAAO;QAC7D,MAAM,cAAc,QAAQ,SAAS,CAAC,CAAA,IAAK,EAAE,WAAW,OAAO;QAC/D,MAAM,cAAc,QAAQ,SAAS,CAAC,CAAA,IAAK,EAAE,WAAW,OAAO;QAE/D,QAAQ,GAAG,CAAC,CAAC,cAAc,EAAE,UAAU,OAAO,EAAE,UAAU,SAAS,EAAE,YAAY,SAAS,EAAE,aAAa;QAEzG,IAAI,cAAc,CAAC,GAAG;YACpB,QAAQ,KAAK,CAAC;YACd,OAAO,EAAE;QACX;QAEA,oCAAoC;QACpC,IAAK,IAAI,IAAI,cAAc,GAAG,IAAI,MAAM,MAAM,EAAE,IAAK;YACnD,MAAM,OAAO,KAAK,CAAC,EAAE;YACrB,IAAI,CAAC,QAAQ,KAAK,IAAI,OAAO,IAAI;YAEjC,MAAM,SAAS,KAAK,KAAK,CAAC,KAAK,GAAG,CAAC,CAAA,IAAK,EAAE,IAAI;YAC9C,MAAM,cAAc,MAAM,CAAC,UAAU;YAErC,IAAI,eAAe,YAAY,MAAM,GAAG,GAAG;gBACzC,MAAM,UAAe;oBACnB,MAAM;oBACN,MAAM,aAAa,IAAK,MAAM,CAAC,UAAU,IAAI,UAAW;oBACxD,QAAQ,eAAe,IAAK,MAAM,CAAC,YAAY,IAAI,mBAAoB;oBACvE,QAAQ,eAAe,IAAK,MAAM,CAAC,YAAY,IAAI,UAAW;oBAC9D,MAAM,kBAAkB,aAAa,eAAe,IAAI,MAAM,CAAC,YAAY,GAAG;oBAC9E,IAAI;oBACJ,cAAc;gBAChB;gBAEA,SAAS,IAAI,CAAC;gBACd,QAAQ,GAAG,CAAC,CAAC,wBAAwB,EAAE,aAAa;YACtD;QACF;QAEA,QAAQ,GAAG,CAAC,CAAC,SAAS,EAAE,SAAS,MAAM,CAAC,mCAAmC,CAAC;QAC5E,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,2CAA2C,MAAM,OAAO;QAEtE,oCAAoC;QACpC,IAAI;YACF,QAAQ,GAAG,CAAC;YACZ,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,UAAU;YACnC,MAAM,cAAc,KAAK,KAAK,CAAC;YAC/B,MAAM,WAAW,EAAE;YAEnB,oCAAoC;YACpC,MAAM,eAAe,MAAM,OAAO,CAAC,eAAe,cAAc;gBAAC;aAAY;YAE7E,KAAK,MAAM,KAAK,aAAc;gBAC5B,IAAI,EAAE,IAAI,EAAE;oBACV,SAAS,IAAI,CAAC;wBACZ,MAAM,EAAE,IAAI;wBACZ,MAAM,EAAE,QAAQ,IAAI;wBACpB,QAAQ,EAAE,UAAU,IAAI;wBACxB,QAAQ;wBACR,MAAM,kBAAkB,EAAE,IAAI,EAAE,EAAE,UAAU,IAAI;wBAChD,IAAI;wBACJ,cAAc;oBAChB;oBACA,QAAQ,GAAG,CAAC,CAAC,uCAAuC,EAAE,EAAE,IAAI,EAAE;gBAChE;YACF;YAEA,OAAO;QACT,EAAE,OAAO,SAAS;YAChB,QAAQ,KAAK,CAAC,+BAA+B;YAC7C,MAAM;QACR;IACF;AACF;AAEA,4CAA4C;AAC5C,eAAe;IACb,IAAI;QACF,QAAQ,GAAG,CAAC;QAEZ,4BAA4B;QAC5B,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,UAAU;QACnC,MAAM,QAAQ,OAAO,KAAK,CAAC,MAAM,MAAM,CAAC,CAAA,OAAQ,KAAK,IAAI;QACzD,MAAM,WAAW,EAAE;QAEnB,KAAK,MAAM,QAAQ,MAAO;YACxB,IAAI,KAAK,UAAU,CAAC,YAAY;gBAC9B,MAAM,QAAQ,KAAK,KAAK,CAAC;gBACzB,IAAI,OAAO;oBACT,MAAM,cAAc,KAAK,CAAC,EAAE;oBAE5B,gCAAgC;oBAChC,IAAI,cAAmB;wBACrB,MAAM;wBACN,QAAQ,KAAK,QAAQ,CAAC,aAAa,UAAU;wBAC7C,IAAI;wBACJ,cAAc;oBAChB;oBAEA,sCAAsC;oBACtC,IAAI;wBACF,MAAM,EAAE,QAAQ,IAAI,EAAE,GAAG,MAAM,UAAU,CAAC,aAAa,EAAE,aAAa;wBACtE,IAAI,KAAK,QAAQ,CAAC,QAAQ,YAAY,IAAI,GAAG;wBAC7C,IAAI,KAAK,QAAQ,CAAC,YAAY,YAAY,IAAI,GAAG;wBACjD,YAAY,IAAI,GAAG,kBAAkB,aAAa;oBACpD,EAAE,OAAM,CAAC;oBAET,SAAS,IAAI,CAAC;gBAChB;YACF;QACF;QAEA,QAAQ,GAAG,CAAC,CAAC,EAAE,EAAE,SAAS,MAAM,CAAC,iCAAiC,CAAC;QACnE,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,yCAAyC,MAAM,OAAO;QACpE,OAAO,EAAE;IACX;AACF;AAEA,4CAA4C;AAC5C,eAAe;IACb,IAAI;QACF,QAAQ,GAAG,CAAC;QAEZ,0CAA0C;QAC1C,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,UAAU;QACnC,MAAM,QAAQ,OAAO,KAAK,CAAC,MAAM,MAAM,CAAC,CAAA,OAAQ,KAAK,IAAI;QACzD,MAAM,WAAW,EAAE;QAEnB,KAAK,MAAM,QAAQ,MAAO;YACxB,IAAI,KAAK,UAAU,CAAC,YAAY;gBAC9B,MAAM,QAAQ,KAAK,KAAK,CAAC;gBACzB,IAAI,OAAO;oBACT,SAAS,IAAI,CAAC;wBACZ,MAAM,KAAK,CAAC,EAAE;wBACd,QAAQ,KAAK,QAAQ,CAAC,aAAa,UAAU;wBAC7C,IAAI;wBACJ,cAAc;oBAChB;gBACF;YACF;QACF;QAEA,6DAA6D;QAC7D,IAAI;YACF,MAAM,EAAE,QAAQ,QAAQ,EAAE,GAAG,MAAM,UAAU;YAC7C,MAAM,OAAO,KAAK,KAAK,CAAC;YACxB,mDAAmD;YACnD,IAAI,KAAK,kBAAkB,EAAE;gBAC3B,KAAK,MAAM,WAAW,KAAK,kBAAkB,CAAE;oBAC7C,MAAM,WAAW,SAAS,IAAI,CAAC,CAAA,IAAK,EAAE,IAAI,KAAK,QAAQ,KAAK;oBAC5D,IAAI,UAAU;wBACZ,SAAS,MAAM,GAAG,QAAQ,cAAc;wBACxC,SAAS,IAAI,GAAG,QAAQ,GAAG,IAAI;wBAC/B,SAAS,IAAI,GAAG,kBAAkB,QAAQ,KAAK,EAAE,QAAQ,cAAc;oBACzE,OAAO;wBACL,SAAS,IAAI,CAAC;4BACZ,MAAM,QAAQ,KAAK;4BACnB,QAAQ,QAAQ,cAAc;4BAC9B,MAAM,QAAQ,GAAG,IAAI;4BACrB,QAAQ,QAAQ,cAAc,IAAI;4BAClC,MAAM,kBAAkB,QAAQ,KAAK,EAAE,QAAQ,cAAc;4BAC7D,IAAI;4BACJ,cAAc;wBAChB;oBACF;gBACF;YACF;QACF,EAAE,OAAM,CAAC;QAET,QAAQ,GAAG,CAAC,CAAC,EAAE,EAAE,SAAS,MAAM,CAAC,iCAAiC,CAAC;QACnE,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,yCAAyC,MAAM,OAAO;QACpE,OAAO,EAAE;IACX;AACF;AAEA,mDAAmD;AACnD,SAAS,kBAAkB,IAAY,EAAE,MAAc;IACrD,MAAM,YAAY,KAAK,WAAW;IAClC,MAAM,cAAc,OAAO,WAAW;IAEtC,yBAAyB;IACzB,IAAI,UAAU,QAAQ,CAAC,cAAc,YAAY,QAAQ,CAAC,cACtD,UAAU,QAAQ,CAAC,UAAU,YAAY,QAAQ,CAAC,UAClD,UAAU,QAAQ,CAAC,cAAc,YAAY,QAAQ,CAAC,cACtD,UAAU,QAAQ,CAAC,eAAe,UAAU,QAAQ,CAAC,eACrD,UAAU,QAAQ,CAAC,YAAY,UAAU,QAAQ,CAAC,aAClD,UAAU,QAAQ,CAAC,YAAY,UAAU,QAAQ,CAAC,UAAU;QAC9D,OAAO;IACT;IAEA,6BAA6B;IAC7B,IAAI,UAAU,QAAQ,CAAC,UAAU,UAAU,QAAQ,CAAC,UAChD,UAAU,QAAQ,CAAC,cAAc,UAAU,QAAQ,CAAC,UACpD,UAAU,QAAQ,CAAC,cAAc,UAAU,QAAQ,CAAC,kBAAkB;QACxE,OAAO;IACT;IAEA,uBAAuB;IACvB,IAAI,UAAU,QAAQ,CAAC,YAAY,UAAU,QAAQ,CAAC,eAClD,YAAY,QAAQ,CAAC,UAAU;QACjC,OAAO;IACT;IAEA,+BAA+B;IAC/B,IAAI,UAAU,QAAQ,CAAC,aAAa,UAAU,QAAQ,CAAC,cACnD,UAAU,QAAQ,CAAC,gBAAgB,YAAY,QAAQ,CAAC,WAAW;QACrE,OAAO;IACT;IAEA,2BAA2B;IAC3B,IAAI,UAAU,QAAQ,CAAC,iBAAiB,UAAU,QAAQ,CAAC,gBACvD,UAAU,QAAQ,CAAC,UAAU,UAAU,QAAQ,CAAC,QAAQ;QAC1D,OAAO;IACT;IAEA,OAAO;AACT;AAGO,eAAe;IACpB,IAAI;QACF,MAAM,WAAW,wGAAE,CAAC,QAAQ;QAC5B,QAAQ,GAAG,CAAC,CAAC,mCAAmC,EAAE,UAAU;QAE5D,IAAI,WAAkB,EAAE;QACxB,IAAI,QAAQ;QAEZ,OAAQ;YACN,KAAK;gBACH,IAAI;oBACF,WAAW,MAAM;gBACnB,EAAE,OAAO,GAAQ;oBACf,QAAQ,CAAC,SAAS,EAAE,EAAE,OAAO,EAAE;gBACjC;gBACA;YAEF,KAAK;gBACH,IAAI;oBACF,WAAW,MAAM;gBACnB,EAAE,OAAO,GAAQ;oBACf,QAAQ,CAAC,OAAO,EAAE,EAAE,OAAO,EAAE;gBAC/B;gBACA;YAEF,KAAK;gBACH,IAAI;oBACF,WAAW,MAAM;gBACnB,EAAE,OAAO,GAAQ;oBACf,QAAQ,CAAC,OAAO,EAAE,EAAE,OAAO,EAAE;gBAC/B;gBACA;YAEF;gBACE,QAAQ,CAAC,mCAAmC,EAAE,UAAU;QAC5D;QAEA,+BAA+B;QAC/B,MAAM,WAAW;YACf,SAAS,CAAC,SAAS,SAAS,MAAM,GAAG;YACrC;YACA,UAAU,wGAAE,CAAC,QAAQ;YACrB;YACA,OAAO,SAAS,MAAM;YACtB;YACA,WAAW,IAAI,OAAO,WAAW;YACjC,SAAS,SAAS,MAAM,GAAG,IACvB,GAAG,SAAS,MAAM,CAAC,4BAA4B,CAAC,GAChD,SAAS;QACf;QAEA,gDAAgD;QAChD,IAAI,SAAS,MAAM,GAAG,GAAG;YACvB,MAAM,kBAAkB,SAAS,MAAM,CAAC,CAAA,IAAK,EAAE,IAAI,KAAK;YACxD,IAAI,gBAAgB,MAAM,GAAG,GAAG;gBAC9B,SAAS,OAAO,IAAI,CAAC,EAAE,EAAE,gBAAgB,MAAM,CAAC,YAAY,CAAC;YAC/D;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAE3B,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,sCAAsC;QACpD,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO,MAAM,OAAO,IAAI;YACxB,UAAU,wGAAE,CAAC,QAAQ;YACrB,UAAU,wGAAE,CAAC,QAAQ;YACrB,UAAU,EAAE;YACZ,OAAO;QACT,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF;AAEA,wEAAwE;AACxE,SAAS,oBAAoB,IAAY;IACvC,iEAAiE;IACjE,qEAAqE;IACrE,OAAO,KAAK,OAAO,CAAC,wBAAwB;AAC9C;AAGO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,EAAE,WAAW,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE1C,IAAI,CAAC,aAAa;YAChB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,OAAO;YACT,GAAG;gBAAE,QAAQ;YAAI;QACnB;QAEA,+DAA+D;QAC/D,MAAM,kBAAkB,oBAAoB;QAE5C,IAAI,oBAAoB,aAAa;YACnC,QAAQ,IAAI,CAAC,CAAC,mCAAmC,EAAE,YAAY,MAAM,EAAE,gBAAgB,CAAC,CAAC;QAC3F;QAEA,MAAM,WAAW,wGAAE,CAAC,QAAQ;QAC5B,QAAQ,GAAG,CAAC,CAAC,yBAAyB,EAAE,gBAAgB,KAAK,EAAE,SAAS,GAAG,CAAC;QAE5E,yCAAyC;QACzC,IAAI,UAAU;QAEd,OAAQ;YACN,KAAK;gBACH,+CAA+C;gBAC/C,UAAU,CAAC,wCAAwC,EAAE,gBAAgB,gCAAgC,EAAE,IAAI,OAAO,cAAc,CAAC,SAAS,EAAE,CAAC;gBAC7I;YAEF,KAAK;YACL,KAAK;gBACH,wBAAwB;gBACxB,UAAU,CAAC,sBAAsB,EAAE,IAAI,OAAO,cAAc,CAAC,SAAS,WAAW,EAAE,gBAAgB,CAAC,CAAC;gBACrG;YAEF;gBACE,OAAO,gJAAY,CAAC,IAAI,CAAC;oBACvB,SAAS;oBACT,OAAO,CAAC,uBAAuB,EAAE,UAAU;gBAC7C,GAAG;oBAAE,QAAQ;gBAAI;QACrB;QAEA,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,UAAU;QAE3C,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS,CAAC;YACV,SAAS,SAAS,CAAC,MAAM,EAAE,QAAQ,GAAG;YACtC,aAAa;YACb;YACA,QAAQ,UAAU;QACpB;IAEF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO,MAAM,OAAO,IAAI;QAC1B,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF","debugId":null}}]
}