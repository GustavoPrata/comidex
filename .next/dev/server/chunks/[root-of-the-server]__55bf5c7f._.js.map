{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/prompt-upload-image/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { writeFile, mkdir } from 'fs/promises'\nimport path from 'path'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const formData = await request.formData()\n    const file = formData.get('image') as File\n    const imageId = formData.get('imageId') as string\n    \n    if (!file || !imageId) {\n      return NextResponse.json(\n        { error: 'Arquivo ou ID ausente' },\n        { status: 400 }\n      )\n    }\n    \n    const bytes = await file.arrayBuffer()\n    const buffer = Buffer.from(bytes)\n    \n    // Determinar extensão baseada no tipo MIME\n    const fileExtension = file.type.split('/')[1] || 'jpg'\n    \n    // Criar diretório attachments se não existir (sem public/)\n    const attachmentsDir = path.join(process.cwd(), 'attachments')\n    try {\n      await mkdir(attachmentsDir, { recursive: true })\n    } catch (error) {\n      // Diretório já existe, ignorar erro\n    }\n    \n    // Salvar arquivo\n    const fileName = `${imageId}.${fileExtension}`\n    const filePath = path.join(attachmentsDir, fileName)\n    \n    await writeFile(filePath, buffer)\n    \n    return NextResponse.json({\n      success: true,\n      imageId,\n      fileName,\n      path: `attachments/${fileName}`\n    })\n  } catch (error) {\n    console.error('Erro ao salvar imagem:', error)\n    return NextResponse.json(\n      { error: 'Erro ao processar imagem' },\n      { status: 500 }\n    )\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,WAAW,MAAM,QAAQ,QAAQ;QACvC,MAAM,OAAO,SAAS,GAAG,CAAC;QAC1B,MAAM,UAAU,SAAS,GAAG,CAAC;QAE7B,IAAI,CAAC,QAAQ,CAAC,SAAS;YACrB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAwB,GACjC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,QAAQ,MAAM,KAAK,WAAW;QACpC,MAAM,SAAS,OAAO,IAAI,CAAC;QAE3B,2CAA2C;QAC3C,MAAM,gBAAgB,KAAK,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,IAAI;QAEjD,2DAA2D;QAC3D,MAAM,iBAAiB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;QAChD,IAAI;YACF,MAAM,IAAA,8HAAK,EAAC,gBAAgB;gBAAE,WAAW;YAAK;QAChD,EAAE,OAAO,OAAO;QACd,oCAAoC;QACtC;QAEA,iBAAiB;QACjB,MAAM,WAAW,GAAG,QAAQ,CAAC,EAAE,eAAe;QAC9C,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,gBAAgB;QAE3C,MAAM,IAAA,kIAAS,EAAC,UAAU;QAE1B,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT;YACA;YACA,MAAM,CAAC,YAAY,EAAE,UAAU;QACjC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA2B,GACpC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}